!function($){Function.prototype.ligerExtend=function(a,b){if("function"!=typeof a)return this;this.base=a.prototype,this.base.constructor=a;var c=function(){};c.prototype=a.prototype,this.prototype=new c,this.prototype.constructor=this,b&&$.extend(this.prototype,b)},Function.prototype.ligerDefer=function(a,b,c){var d=this;return setTimeout(function(){d.apply(a,c||[])},b)},window.liger=$.ligerui={version:"V1.1.9",managerCount:0,managers:{},managerIdPrev:"ligerui",error:{managerIsExist:"管理器id已经存在"},getId:function(a){a=a||this.managerIdPrev;var b=a+(1e3+this.managerCount);return this.managerCount++,b},add:function(a){if(2==arguments.length){var b=arguments[1];return b.id=b.id||b.options.id||arguments[0].id,this.addManager(b),void 0}if(a.id||(a.id=this.getId(a.__idPrev())),this.managers[a.id])throw new Error(this.error.managerIsExist);this.managers[a.id]=a},remove:function(a){"string"==typeof a||"number"==typeof a?delete $.ligerui.managers[a]:"object"==typeof a&&a instanceof $.ligerui.core.Component&&delete $.ligerui.managers[a.id]},get:function(a,b){return b=b||"ligeruiid","string"==typeof a||"number"==typeof a?$.ligerui.managers[a]:"object"==typeof a&&a.length?a[0][b]||$(a[0]).attr(b)?$.ligerui.managers[a[0][b]||$(a[0]).attr(b)]:null:null},find:function(a){var b,c,d=[];for(b in this.managers)c=this.managers[b],a instanceof Function?c instanceof a&&d.push(c):a instanceof Array?-1!=$.inArray(c.__getType(),a)&&d.push(c):c.__getType()==a&&d.push(c);return d},run:function(a,b,c){var d,e,f;if(a){if(c=$.extend({defaultsNamespace:"ligerDefaults",methodsNamespace:"ligerMethods",controlNamespace:"controls",idAttrName:"ligeruiid",isStatic:!1,hasElement:!0,propertyToElemnt:null},c||{}),a=a.replace(/^ligerGet/,""),a=a.replace(/^liger/,""),null==this||this==window||c.isStatic)return $.ligerui.plugins[a]||($.ligerui.plugins[a]={fn:$["liger"+a],isStatic:!0}),new $.ligerui[c.controlNamespace][a]($.extend({},$[c.defaultsNamespace][a]||{},$[c.defaultsNamespace][a+"String"]||{},b.length>0?b[0]:{}));if($.ligerui.plugins[a]||($.ligerui.plugins[a]={fn:$.fn["liger"+a],isStatic:!1}),/Manager$/.test(a))return $.ligerui.get(this,c.idAttrName);if(this.each(function(){var d,e,f;return this[c.idAttrName]||$(this).attr(c.idAttrName)?(d=$.ligerui.get(this[c.idAttrName]||$(this).attr(c.idAttrName)),d&&b.length>0&&d.set(b[0]),void 0):(b.length>=1&&"string"==typeof b[0]||(e=b.length>0?b[0]:null,f=$.extend({},$[c.defaultsNamespace][a]||{},$[c.defaultsNamespace][a+"String"]||{},e||{}),c.propertyToElemnt&&(f[c.propertyToElemnt]=this),c.hasElement?new $.ligerui[c.controlNamespace][a](this,f):new $.ligerui[c.controlNamespace][a](f)),void 0)}),0==this.length)return null;if(0==b.length)return $.ligerui.get(this,c.idAttrName);if("object"==typeof b[0])return $.ligerui.get(this,c.idAttrName);if("string"==typeof b[0]){if(d=$.ligerui.get(this,c.idAttrName),null==d)return;if("option"!=b[0]){if(e=b[0],!d[e])return;return f=Array.apply(null,b),f.shift(),d[e].apply(d,f)}if(2==b.length)return d.get(b[1]);if(b.length>=3)return d.set(b[1],b[2])}return null}},defaults:{},methods:{},core:{},controls:{},plugins:{}},$.ligerDefaults={},$.ligerMethos={},$.ligerui.defaults=$.ligerDefaults,$.ligerui.methods=$.ligerMethos,$.fn.liger=function(a){return a?$.ligerui.run.call(this,a,arguments):$.ligerui.get(this)},$.ligerui.core.Component=function(a){this.events=this.events||{},this.options=a||{},this.children={}},$.extend($.ligerui.core.Component.prototype,{__getType:function(){return"$.ligerui.core.Component"},__idPrev:function(){return"ligerui"},set:function(a,b){var c,d,e,f;if(a)if("object"!=typeof a){if(e=a,0==e.indexOf("on"))return"function"==typeof b&&this.bind(e.substr(2),b),void 0;this.trigger("propertychange",a,b),this.options||(this.options={}),this.options[e]=b,f="_set"+e.substr(0,1).toUpperCase()+e.substr(1),this[f]&&this[f].call(this,b),this.trigger("propertychanged",a,b)}else{if(this.options!=a?($.extend(this.options,a),c=a):c=$.extend({},a),void 0==b||1==b)for(d in c)0==d.indexOf("on")&&this.set(d,c[d]);if(void 0==b||0==b)for(d in c)0!=d.indexOf("on")&&this.set(d,c[d])}},get:function(a){var b="_get"+a.substr(0,1).toUpperCase()+a.substr(1);return this[b]?this[b].call(this,a):this.options[a]},hasBind:function(a){var b=a.toLowerCase(),c=this.events[b];return c&&c.length?!0:!1},trigger:function(a,b){var c,d,e=a.toLowerCase(),f=this.events[e];if(f)for(b=b||[],0==b instanceof Array&&(b=[b]),c=0;c<f.length;c++)if(d=f[c],0==d.handler.apply(d.context,b))return!1},bind:function(a,b,c){var d,e,f;if("object"!=typeof a){if("function"!=typeof b)return!1;e=a.toLowerCase(),f=this.events[e]||[],c=c||this,f.push({handler:b,context:c}),this.events[e]=f}else for(d in a)this.bind(d,a[d])},unbind:function(a,b){var c,d,e,f;if(!a)return this.events={},void 0;if(c=a.toLowerCase(),d=this.events[c],d&&d.length)if(b){for(e=0,f=d.length;f>e;e++)if(d[e].handler==b){d.splice(e,1);break}}else delete this.events[c]},destroy:function(){$.ligerui.remove(this)}}),$.ligerui.core.UIComponent=function(a,b){$.ligerui.core.UIComponent.base.constructor.call(this,b);var c=this._extendMethods();c&&$.extend(this,c),this.element=a,this._init(),this._preRender(),this.trigger("render"),this._render(),this.trigger("rendered"),this._rendered()},$.ligerui.core.UIComponent.ligerExtend($.ligerui.core.Component,{__getType:function(){return"$.ligerui.core.UIComponent"},_extendMethods:function(){},_init:function(){var attributes,i,name,p,attroptions;if(this.type=this.__getType(),this.id=this.element?this.options.id||this.element.id||$.ligerui.getId(this.__idPrev()):this.options.id||$.ligerui.getId(this.__idPrev()),$.ligerui.add(this),this.element){if(attributes=this.attr(),attributes&&attributes instanceof Array)for(i=0;i<attributes.length;i++)name=attributes[i],this.options[name]=$(this.element).attr(name);if(p=this.options,$(this.element).attr("ligerui"))try{attroptions=$(this.element).attr("ligerui"),0!=attroptions.indexOf("{")&&(attroptions="{"+attroptions+"}"),eval("attroptions = "+attroptions+";"),attroptions&&$.extend(p,attroptions)}catch(e){}}},_preRender:function(){},_render:function(){},_rendered:function(){this.element&&$(this.element).attr("ligeruiid",this.id)},attr:function(){return[]},destroy:function(){this.element&&$(this.element).remove(),this.options=null,$.ligerui.remove(this)}}),$.ligerui.controls.Input=function(a,b){$.ligerui.controls.Input.base.constructor.call(this,a,b)},$.ligerui.controls.Input.ligerExtend($.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Input"},attr:function(){return["nullText"]},setValue:function(a){return this.set("value",a)},getValue:function(){return this.get("value")},setEnabled:function(){return this.set("disabled",!1)},setDisabled:function(){return this.set("disabled",!0)},updateStyle:function(){}}),$.ligerui.win={top:!1,mask:function(){function a(){if($.ligerui.win.windowMask){var a=$(window).height()+$(window).scrollTop();$.ligerui.win.windowMask.height(a)}}this.windowMask||(this.windowMask=$("<div class='l-window-mask' style='display: block;'></div>").appendTo("body"),$(window).bind("resize.ligeruiwin",a),$(window).bind("scroll",a)),this.windowMask.show(),a(),this.masking=!0},unmask:function(a){var b,c,d,e,f,g=$("body > .l-dialog:visible,body > .l-window:visible");for(b=0,c=g.length;c>b;b++)if(d=g.eq(b).attr("ligeruiid"),(!a||a.id!=d)&&(e=$.ligerui.get(d),e&&(f=e.get("modal"))))return;this.windowMask&&this.windowMask.hide(),this.masking=!1},createTaskbar:function(){return this.taskbar||(this.taskbar=$('<div class="l-taskbar"><div class="l-taskbar-tasks"></div><div class="l-clear"></div></div>').appendTo("body"),this.top&&this.taskbar.addClass("l-taskbar-top"),this.taskbar.tasks=$(".l-taskbar-tasks:first",this.taskbar),this.tasks={}),this.taskbar.show(),this.taskbar.animate({bottom:0}),this.taskbar},removeTaskbar:function(){var a=this;a.taskbar.animate({bottom:-32},function(){a.taskbar.remove(),a.taskbar=null})},activeTask:function(a){var b,c;for(b in this.tasks)c=this.tasks[b],b==a.id?c.addClass("l-taskbar-task-active"):c.removeClass("l-taskbar-task-active")},getTask:function(a){var b=this;return b.taskbar?b.tasks[a.id]?b.tasks[a.id]:null:void 0},addTask:function(a){var b,c,d=this;return d.taskbar||d.createTaskbar(),d.tasks[a.id]?d.tasks[a.id]:(b=a.get("title"),c=d.tasks[a.id]=$('<div class="l-taskbar-task"><div class="l-taskbar-task-icon"></div><div class="l-taskbar-task-content">'+b+"</div></div>"),d.taskbar.tasks.append(c),d.activeTask(a),c.bind("click",function(){d.activeTask(a),a.actived?a.min():a.active()}).hover(function(){$(this).addClass("l-taskbar-task-over")},function(){$(this).removeClass("l-taskbar-task-over")}),c)},hasTask:function(){for(var a in this.tasks)if(this.tasks[a])return!0;return!1},removeTask:function(a){var b=this;b.taskbar&&(b.tasks[a.id]&&(b.tasks[a.id].unbind(),b.tasks[a.id].remove(),delete b.tasks[a.id]),b.hasTask()||b.removeTaskbar())},setFront:function(a){var b,c,d=$.ligerui.find($.ligerui.core.Win);for(b in d)c=d[b],c==a?($(c.element).css("z-index","9200"),this.activeTask(c)):$(c.element).css("z-index","9100")}},$.ligerui.core.Win=function(a,b){$.ligerui.core.Win.base.constructor.call(this,a,b)},$.ligerui.core.Win.ligerExtend($.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Win"},mask:function(){this.options.modal&&$.ligerui.win.mask(this)},unmask:function(){this.options.modal&&$.ligerui.win.unmask(this)},min:function(){},max:function(){},active:function(){}}),$.ligerui.draggable={dragging:!1},$.ligerui.resizable={reszing:!1},$.ligerui.toJSON="object"==typeof JSON&&JSON.stringify?JSON.stringify:function(a){var b,c,d,e,f,g,h,i=function(a){return 10>a?"0"+a:a},j=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k=function(a){return j.lastIndex=0,j.test(a)?'"'+a.replace(j,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'};if(null===a)return"null";if(b=typeof a,"undefined"===b)return void 0;if("string"===b)return k(a);if("number"===b||"boolean"===b)return""+a;if("object"===b){if("function"==typeof a.toJSON)return $.ligerui.toJSON(a.toJSON());if(a.constructor===Date)return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null;if(c=[],a.constructor===Array){for(d=0,e=a.length;e>d;d++)c.push($.ligerui.toJSON(a[d])||"null");return"["+c.join(",")+"]"}for(h in a){if(b=typeof h,"number"===b)f='"'+h+'"';else{if("string"!==b)continue;f=k(h)}b=typeof a[h],"function"!==b&&"undefined"!==b&&(g=$.ligerui.toJSON(a[h]),c.push(f+":"+g))}return"{"+c.join(",")+"}"}}}(jQuery),function(a){a.fn.ligerAccordion=function(){return a.ligerui.run.call(this,"ligerAccordion",arguments)},a.fn.ligerGetAccordionManager=function(){return a.ligerui.get(this)},a.ligerDefaults.Accordion={height:null,speed:"normal",changeHeightOnResize:!1,heightDiff:0},a.ligerMethos.Accordion={},a.ligerui.controls.Accordion=function(b,c){a.ligerui.controls.Accordion.base.constructor.call(this,b,c)},a.ligerui.controls.Accordion.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Accordion"},__idPrev:function(){return"Accordion"},_extendMethods:function(){return a.ligerMethos.Accordion},_render:function(){var b,c=this,d=this.options;c.accordion=a(c.element),c.accordion.hasClass("l-accordion-panel")||c.accordion.addClass("l-accordion-panel"),b=0,a("> div[lselected=true]",c.accordion).length>0&&(b=a("> div",c.accordion).index(a("> div[lselected=true]",c.accordion))),a("> div",c.accordion).each(function(c,d){var e=a('<div class="l-accordion-header"><div class="l-accordion-toggle"></div><div class="l-accordion-header-inner"></div></div>');c==b&&a(".l-accordion-toggle",e).addClass("l-accordion-toggle-open"),a(d).attr("title")&&(a(".l-accordion-header-inner",e).html(a(d).attr("title")),a(d).attr("title","")),a(d).before(e),a(d).hasClass("l-accordion-content")||a(d).addClass("l-accordion-content")}),a(".l-accordion-toggle",c.accordion).each(function(){a(this).hasClass("l-accordion-toggle-open")||a(this).hasClass("l-accordion-toggle-close")||a(this).addClass("l-accordion-toggle-close"),a(this).hasClass("l-accordion-toggle-close")&&a(this).parent().next(".l-accordion-content:visible").hide()}),a(".l-accordion-header",c.accordion).hover(function(){a(this).addClass("l-accordion-header-over")},function(){a(this).removeClass("l-accordion-header-over")}),a(".l-accordion-toggle",c.accordion).hover(function(){a(this).hasClass("l-accordion-toggle-open")?a(this).addClass("l-accordion-toggle-open-over"):a(this).hasClass("l-accordion-toggle-close")&&a(this).addClass("l-accordion-toggle-close-over")},function(){a(this).hasClass("l-accordion-toggle-open")?a(this).removeClass("l-accordion-toggle-open-over"):a(this).hasClass("l-accordion-toggle-close")&&a(this).removeClass("l-accordion-toggle-close-over")}),a(">.l-accordion-header",c.accordion).click(function(){var b=a(".l-accordion-toggle:first",this);b.hasClass("l-accordion-toggle-close")?(b.removeClass("l-accordion-toggle-close").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over"),b.addClass("l-accordion-toggle-open"),a(this).next(".l-accordion-content").show(d.speed).siblings(".l-accordion-content:visible").hide(d.speed),a(this).siblings(".l-accordion-header").find(".l-accordion-toggle").removeClass("l-accordion-toggle-open").addClass("l-accordion-toggle-close")):(b.removeClass("l-accordion-toggle-open").removeClass("l-accordion-toggle-close-over l-accordion-toggle-open-over").addClass("l-accordion-toggle-close"),a(this).next(".l-accordion-content").hide(d.speed))}),c.headerHoldHeight=0,a("> .l-accordion-header",c.accordion).each(function(){c.headerHoldHeight+=a(this).height()}),d.height&&"string"==typeof d.height&&d.height.indexOf("%")>0?(c.onResize(),d.changeHeightOnResize&&a(window).resize(function(){c.onResize()})):d.height?(c.height=d.heightDiff+d.height,c.accordion.height(c.height),c.setHeight(d.height)):c.header=c.accordion.height(),c.set(d)},onResize:function(){var b,c=this,d=this.options;return d.height&&"string"==typeof d.height&&-1!=d.height.indexOf("%")?("body"==c.accordion.parent()[0].tagName.toLowerCase()?(b=a(window).height(),b-=parseInt(c.layout.parent().css("paddingTop")),b-=parseInt(c.layout.parent().css("paddingBottom")),c.height=d.heightDiff+.01*b*parseFloat(c.height)):c.height=d.heightDiff+.01*c.accordion.parent().height()*parseFloat(d.height),c.accordion.height(c.height),c.setContentHeight(c.height-c.headerHoldHeight),void 0):!1},setHeight:function(b){var c=this;this.options,c.accordion.height(b),b-=c.headerHoldHeight,a("> .l-accordion-content",c.accordion).height(b)}})}(jQuery),function(a){a.fn.ligerButton=function(){return a.ligerui.run.call(this,"ligerButton",arguments)},a.fn.ligerGetButtonManager=function(){return a.ligerui.run.call(this,"ligerGetButtonManager",arguments)},a.ligerDefaults.Button={width:100,text:"Button",disabled:!1},a.ligerMethos.Button={},a.ligerui.controls.Button=function(b,c){a.ligerui.controls.Button.base.constructor.call(this,b,c)},a.ligerui.controls.Button.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Button"},__idPrev:function(){return"Button"},_extendMethods:function(){return a.ligerMethos.Button},_render:function(){var b=this,c=this.options;b.button=a(b.element),b.button.addClass("l-btn"),b.button.append('<div class="l-btn-l"></div><div class="l-btn-r"></div><span></span>'),c.click&&b.button.click(function(){c.disabled||c.click()}),b.set(c)},_setEnabled:function(a){a&&this.button.removeClass("l-btn-disabled")},_setDisabled:function(a){a&&(this.button.addClass("l-btn-disabled"),this.options.disabled=!0)},_setWidth:function(a){this.button.width(a)},_setText:function(b){a("span",this.button).html(b)},setValue:function(a){this.set("text",a)},getValue:function(){return this.options.text},setEnabled:function(){this.set("disabled",!1)},setDisabled:function(){this.set("disabled",!0)}})}(jQuery),function(a){a.fn.ligerCheckBox=function(){return a.ligerui.run.call(this,"ligerCheckBox",arguments)},a.fn.ligerGetCheckBoxManager=function(){return a.ligerui.run.call(this,"ligerGetCheckBoxManager",arguments)},a.ligerDefaults.CheckBox={disabled:!1},a.ligerMethos.CheckBox={},a.ligerui.controls.CheckBox=function(b,c){a.ligerui.controls.CheckBox.base.constructor.call(this,b,c)},a.ligerui.controls.CheckBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"CheckBox"},__idPrev:function(){return"CheckBox"},_extendMethods:function(){return a.ligerMethos.CheckBox},_render:function(){var b=this,c=this.options;b.input=a(b.element),b.link=a('<a class="l-checkbox"></a>'),b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-checkbox-wrapper"></div>').parent(),b.wrapper.prepend(b.link),b.link.click(function(){return b.input.attr("disabled")?!1:c.disabled?!1:0==b.trigger("beforeClick",[b.element])?!1:(a(this).hasClass("l-checkbox-checked")?b._setValue(!1):b._setValue(!0),b.input.trigger("change"),void 0)}),b.wrapper.hover(function(){c.disabled||a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),this.set(c),this.updateStyle()},_setCss:function(a){this.wrapper.css(a)},_setValue:function(a){var b=this;this.options,a?(b.input[0].checked=!0,b.link.addClass("l-checkbox-checked")):(b.input[0].checked=!1,b.link.removeClass("l-checkbox-checked"))},_setDisabled:function(a){a?(this.input.attr("disabled",!0),this.wrapper.addClass("l-disabled")):(this.input.attr("disabled",!1),this.wrapper.removeClass("l-disabled"))},_getValue:function(){return this.element.checked},updateStyle:function(){this.input.attr("disabled")&&(this.wrapper.addClass("l-disabled"),this.options.disabled=!0),this.input[0].checked?this.link.addClass("l-checkbox-checked"):this.link.removeClass("l-checkbox-checked")}})}(jQuery),function(a){a.fn.ligerComboBox=function(){return a.ligerui.run.call(this,"ligerComboBox",arguments)},a.fn.ligerGetComboBoxManager=function(){return a.ligerui.run.call(this,"ligerGetComboBoxManager",arguments)},a.ligerDefaults.ComboBox={resize:!0,isMultiSelect:!1,isShowCheckBox:!1,columns:!1,selectBoxWidth:!1,selectBoxHeight:!1,onBeforeSelect:!1,onSelected:null,initValue:null,initText:null,valueField:"id",textField:"text",valueFieldID:null,slide:!0,split:";",data:null,tree:null,treeLeafOnly:!0,grid:null,onStartResize:null,onEndResize:null,hideOnLoseFocus:!0,url:null,onSuccess:null,onError:null,onBeforeOpen:null,render:null,absolute:!0},a.ligerMethos.ComboBox=a.ligerMethos.ComboBox||{},a.ligerui.controls.ComboBox=function(b,c){a.ligerui.controls.ComboBox.base.constructor.call(this,b,c)},a.ligerui.controls.ComboBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"ComboBox"},_extendMethods:function(){return a.ligerMethos.ComboBox},_init:function(){a.ligerui.controls.ComboBox.base._init.call(this);var b=this.options;b.columns&&(b.isShowCheckBox=!0),b.isMultiSelect&&(b.isShowCheckBox=!0)},_render:function(){var b,c=this,d=this.options;if(c.data=d.data,c.inputText=null,c.select=null,c.textFieldID="",c.valueFieldID="",c.valueField=null,"input"==this.element.tagName.toLowerCase())this.element.readOnly=!0,c.inputText=a(this.element),c.textFieldID=this.element.id;else{if("select"!=this.element.tagName.toLowerCase())return;a(this.element).hide(),c.select=a(this.element),d.isMultiSelect=!1,d.isShowCheckBox=!1,c.textFieldID=this.element.id+"_txt",c.inputText=a('<input type="text" readonly="true"/>'),c.inputText.attr("id",c.textFieldID).insertAfter(a(this.element))}void 0==c.inputText[0].name&&(c.inputText[0].name=c.textFieldID),c.valueField=null,d.valueFieldID?(c.valueField=a("#"+d.valueFieldID+":input"),0==c.valueField.length&&(c.valueField=a('<input type="hidden"/>')),c.valueField[0].id=c.valueField[0].name=d.valueFieldID):(c.valueField=a('<input type="hidden"/>'),c.valueField[0].id=c.valueField[0].name=c.textFieldID+"_val"),void 0==c.valueField[0].name&&(c.valueField[0].name=c.valueField[0].id),c.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),c.selectBox=a('<div class="l-box-select"><div class="l-box-select-inner"><table cellpadding="0" cellspacing="0" border="0" class="l-box-select-table"></table></div></div>'),c.selectBox.table=a("table:first",c.selectBox),c.wrapper=c.inputText.wrap('<div class="l-text l-text-combobox"></div>').parent(),c.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),c.wrapper.append(c.link),c.textwrapper=c.wrapper.wrap('<div class="l-text-wrapper"></div>').parent(),d.absolute?c.selectBox.appendTo("body").addClass("l-box-select-absolute"):c.textwrapper.append(c.selectBox),c.textwrapper.append(c.valueField),c.inputText.addClass("l-text-field"),d.isShowCheckBox&&!c.select?a("table",c.selectBox).addClass("l-table-checkbox"):(d.isShowCheckBox=!1,a("table",c.selectBox).addClass("l-table-nocheckbox")),c.link.hover(function(){d.disabled||(this.className="l-trigger-hover")},function(){d.disabled||(this.className="l-trigger")}).mousedown(function(){d.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){d.disabled||(this.className="l-trigger-hover")}).click(function(){return d.disabled?void 0:0==c.trigger("beforeOpen")?!1:(c._toggleSelectBox(c.selectBox.is(":visible")),void 0)}),c.inputText.click(function(){return d.disabled?void 0:0==c.trigger("beforeOpen")?!1:(c._toggleSelectBox(c.selectBox.is(":visible")),void 0)}).blur(function(){d.disabled||c.wrapper.removeClass("l-text-focus")}).focus(function(){d.disabled||c.wrapper.addClass("l-text-focus")}),c.wrapper.hover(function(){d.disabled||c.wrapper.addClass("l-text-over")},function(){d.disabled||c.wrapper.removeClass("l-text-over")}),c.resizing=!1,c.selectBox.hover(null,function(){d.hideOnLoseFocus&&c.selectBox.is(":visible")&&!c.boxToggling&&!c.resizing&&c._toggleSelectBox(!0)}),b=a("tr",c.selectBox.table).length,!d.selectBoxHeight&&8>b&&(d.selectBoxHeight=30*b),d.selectBoxHeight&&c.selectBox.height(d.selectBoxHeight),c.bulidContent(),c.set(d),d.selectBoxWidth?c.selectBox.width(d.selectBoxWidth):c.selectBox.css("width",c.wrapper.css("width"))},destroy:function(){this.wrapper&&this.wrapper.remove(),this.selectBox&&this.selectBox.remove(),this.options=null,a.ligerui.remove(this)},_setDisabled:function(a){a?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},_setLable:function(b){var c=this,d=this.options;b&&(c.labelwrapper?c.labelwrapper.find(".l-text-label:first").html(b+":&nbsp"):(c.labelwrapper=c.textwrapper.wrap('<div class="l-labeltext"></div>').parent(),c.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+b+":&nbsp</div>"),c.textwrapper.css("float","left")),d.labelWidth?a(".l-text-label",c.labelwrapper).outerWidth(d.labelWidth):d.labelWidth=a(".l-text-label",c.labelwrapper).outerWidth(),a(".l-text-label",c.labelwrapper).width(d.labelWidth),a(".l-text-label",c.labelwrapper).height(c.wrapper.height()),c.labelwrapper.append('<br style="clear:both;" />'),d.labelAlign&&a(".l-text-label",c.labelwrapper).css("text-align",d.labelAlign),c.textwrapper.css({display:"inline"}),c.labelwrapper.width(c.wrapper.outerWidth()+d.labelWidth+2))},_setWidth:function(a){var b=this;a>20&&(b.wrapper.css({width:a}),b.inputText.css({width:a-20}),b.textwrapper.css({width:a}))},_setHeight:function(a){var b=this;a>10&&(b.wrapper.height(a),b.inputText.height(a-2),b.link.height(a-4),b.textwrapper.css({width:a}))},_setResize:function(b){if(b&&a.fn.ligerResizable){var c=this;c.selectBox.ligerResizable({handles:"se,s,e",onStartResize:function(){c.resizing=!0,c.trigger("startResize")},onEndResize:function(){return c.resizing=!1,0==c.trigger("endResize")?!1:void 0}}),c.selectBox.append("<div class='l-btn-nw-drop'></div>")}},findTextByValue:function(b){var c,d,e=this,f=this.options;return void 0==b?"":(c="",d=function(a){var c,d=b.toString().split(f.split);for(c=0;c<d.length;c++)if(d[c]==a)return!0;return!1},a(e.data).each(function(a,b){var e=b[f.valueField],g=b[f.textField];d(e)&&(c+=g+f.split)}),c.length>0&&(c=c.substr(0,c.length-1)),c)},findValueByText:function(b){var c,d,e=this,f=this.options;return b||""!=b?(c=function(a){var c,d=b.toString().split(f.split);for(c=0;c<d.length;c++)if(d[c]==a)return!0;return!1},d="",a(e.data).each(function(a,b){var e=b[f.valueField],g=b[f.textField];c(g)&&(d+=e+f.split)}),d.length>0&&(d=d.substr(0,d.length-1)),d):""},removeItem:function(){},insertItem:function(){},addItem:function(){},_setValue:function(b){var c,d,e=this,f=this.options,g=e.findTextByValue(b);if(f.tree)e.selectValueByTree(b);else if(f.isMultiSelect)for(e._changeValue(b,g),c=b.toString().split(f.split),a("table.l-table-checkbox :checkbox",e.selectBox).each(function(){this.checked=!1}),d=0;d<c.length;d++)a("table.l-table-checkbox tr[value="+c[d]+"] :checkbox",e.selectBox).each(function(){this.checked=!0});else e._changeValue(b,g),a("tr[value="+b+"] td",e.selectBox).addClass("l-selected"),a("tr[value!="+b+"] td",e.selectBox).removeClass("l-selected")},selectValue:function(a){this._setValue(a)},bulidContent:function(){var b=this,c=this.options;this.clearContent(),b.select?b.setSelect():b.data?b.setData(b.data):c.tree?b.setTree(c.tree):c.grid?b.setGrid(c.grid):c.url&&a.ajax({type:"post",url:c.url,cache:!1,dataType:"json",success:function(a){b.data=a,b.setData(b.data),b.trigger("success",[b.data])},error:function(a,c){b.trigger("error",[a,c])}})},clearContent:function(){var b=this;this.options,a("table",b.selectBox).html("")},setSelect:function(){var b=this,c=this.options;this.clearContent(),a("option",b.select).each(function(c){var d=a(this).val(),e=a(this).html(),f=a("<tr><td index='"+c+"' value='"+d+"'>"+e+"</td>");a("table.l-table-nocheckbox",b.selectBox).append(f),a("td",f).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})}),a("td:eq("+b.select[0].selectedIndex+")",b.selectBox).each(function(){var d,e,f;return a(this).hasClass("l-selected")?(b.selectBox.hide(),void 0):(a(".l-selected",b.selectBox).removeClass("l-selected"),a(this).addClass("l-selected"),b.select[0].selectedIndex!=a(this).attr("index")&&b.select[0].onchange&&(b.select[0].selectedIndex=a(this).attr("index"),b.select[0].onchange()),d=parseInt(a(this).attr("index")),b.select[0].selectedIndex=d,b.select.trigger("change"),b.selectBox.hide(),e=a(this).attr("value"),f=a(this).html(),c.render?b.inputText.val(c.render(e,f)):b.inputText.val(f),void 0)}),b._addClickEven()},setData:function(b){var c,d,e,f,g,h,i=this,j=this.options;if(this.clearContent(),b&&b.length){if(i.data!=b&&(i.data=b),j.columns)for(i.selectBox.table.headrow=a("<tr class='l-table-headerow'><td width='18px'></td></tr>"),i.selectBox.table.append(i.selectBox.table.headrow),i.selectBox.table.addClass("l-box-select-grid"),c=0;c<j.columns.length;c++)d=a("<td columnindex='"+c+"' columnname='"+j.columns[c].name+"'>"+j.columns[c].header+"</td>"),j.columns[c].width&&d.width(j.columns[c].width),i.selectBox.table.headrow.append(d);for(e=0;e<b.length;e++)f=b[e][j.valueField],g=b[e][j.textField],j.columns?(h=a("<tr value='"+f+"'><td style='width:18px;'  index='"+e+"' value='"+f+"' text='"+g+"' ><input type='checkbox' /></td></tr>"),a("td",i.selectBox.table.headrow).each(function(){var c,d=a(this).attr("columnname");d&&(c=a("<td>"+b[e][d]+"</td>"),h.append(c))}),i.selectBox.table.append(h)):(a("table.l-table-checkbox",i.selectBox).append("<tr value='"+f+"'><td style='width:18px;'  index='"+e+"' value='"+f+"' text='"+g+"' ><input type='checkbox' /></td><td index='"+e+"' value='"+f+"' align='left'>"+g+"</td>"),a("table.l-table-nocheckbox",i.selectBox).append("<tr value='"+f+"'><td index='"+e+"' value='"+f+"' align='left'>"+g+"</td>"));j.isShowCheckBox&&a.fn.ligerCheckBox&&a("table input:checkbox",i.selectBox).ligerCheckBox(),a(".l-table-checkbox input:checkbox",i.selectBox).change(function(){if(this.checked&&i.hasBind("beforeSelect")){var b=null;if(b="div"==a(this).parent().get(0).tagName.toLowerCase()?a(this).parent().parent():a(this).parent(),null!=b&&0==i.trigger("beforeSelect",[b.attr("value"),b.attr("text")]))return i.selectBox.slideToggle("fast"),!1}j.isMultiSelect||this.checked&&(a("input:checked",i.selectBox).not(this).each(function(){this.checked=!1,a(".l-checkbox-checked",a(this).parent()).removeClass("l-checkbox-checked")}),i.selectBox.slideToggle("fast")),i._checkboxUpdateValue()}),a("table.l-table-nocheckbox td",i.selectBox).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),i._addClickEven(),i._dataInit()}},setTree:function(b){var c=this,d=this.options;this.clearContent(),c.selectBox.table.remove(),0!=b.checkbox?b.onCheck=function(){var b=c.treeManager.getChecked(),e=[],f=[];a(b).each(function(a,b){d.treeLeafOnly&&b.data.children||(e.push(b.data[d.valueField]),f.push(b.data[d.textField]))}),c._changeValue(e.join(d.split),f.join(d.split))}:(b.onSelect=function(a){var b,e;d.treeLeafOnly&&a.data.children||(b=a.data[d.valueField],e=a.data[d.textField],c._changeValue(b,e))},b.onCancelSelect=function(){c._changeValue("","")}),b.onAfterAppend=function(){if(c.treeManager){var a=null;d.initValue?a=d.initValue:""!=c.valueField.val()&&(a=c.valueField.val()),c.selectValueByTree(a)}},c.tree=a("<ul></ul>"),a("div:first",c.selectBox).append(c.tree),c.tree.ligerTree(b),c.treeManager=c.tree.ligerGetTreeManager()},selectValueByTree:function(b){var c,d,e=this,f=this.options;null!=b&&(c="",d=b.toString().split(f.split),a(d).each(function(a,b){e.treeManager.selectNode(b.toString()),c+=e.treeManager.getTextByID(b),a<d.length-1&&(c+=f.split)}),e._changeValue(b,c))},setGrid:function(b){var c,d=this,e=this.options;this.clearContent(),d.selectBox.table.remove(),d.grid=a("div:first",d.selectBox),b.columnWidth=b.columnWidth||120,b.width="100%",b.height="100%",b.heightDiff=-2,b.InWindow=!1,d.gridManager=d.grid.ligerGrid(b),e.hideOnLoseFocus=!1,0!=b.checkbox?(c=function(){var b=d.gridManager.getCheckedRows(),c=[],f=[];a(b).each(function(a,b){c.push(b[e.valueField]),f.push(b[e.textField])}),d._changeValue(c.join(e.split),f.join(e.split))},d.gridManager.bind("CheckAllRow",c),d.gridManager.bind("CheckRow",c)):(d.gridManager.bind("SelectRow",function(a){var b=a[e.valueField],c=a[e.textField];d._changeValue(b,c)}),d.gridManager.bind("UnSelectRow",function(){d._changeValue("","")})),d.bind("show",function(){d.gridManager&&d.gridManager._updateFrozenWidth()}),d.bind("endResize",function(){d.gridManager&&(d.gridManager._updateFrozenWidth(),d.gridManager.setHeight(d.selectBox.height()-2))})},_getValue:function(){return a(this.valueField).val()},getValue:function(){return this._getValue()},updateStyle:function(){var a=this;this.options,a._dataInit()},_dataInit:function(){var b,c=this,d=this.options,e=null;null!=d.initValue&&null!=d.initText&&c._changeValue(d.initValue,d.initText),null!=d.initValue?(e=d.initValue,d.tree?e&&c.selectValueByTree(e):(b=c.findTextByValue(e),c._changeValue(e,b))):null!=d.initText?(e=c.findValueByText(d.initText),c._changeValue(e,d.initText)):""!=c.valueField.val()&&(e=c.valueField.val(),d.tree?e&&c.selectValueByTree(e):(b=c.findTextByValue(e),c._changeValue(e,b))),d.isShowCheckBox||null==e||a("table tr",c.selectBox).find("td:first").each(function(){e==a(this).attr("value")&&a(this).addClass("l-selected")}),d.isShowCheckBox&&null!=e&&a(":checkbox",c.selectBox).each(function(){var b,c=null,f=a(this);c="div"==f.parent().get(0).tagName.toLowerCase()?f.parent().parent():f.parent(),null!=c&&(b=e.toString().split(d.split),a(b).each(function(b,d){d==c.attr("value")&&(a(".l-checkbox",c).addClass("l-checkbox-checked"),f[0].checked=!0)}))})},_changeValue:function(a,b){var c=this,d=this.options;c.valueField.val(a),d.render?c.inputText.val(d.render(a,b)):c.inputText.val(b),c.selectedValue=a,c.selectedText=b,c.inputText.trigger("change").focus(),c.trigger("selected",[a,b])},_checkboxUpdateValue:function(){var b=this,c=this.options,d="",e="";a("input:checked",b.selectBox).each(function(){var b=null;
b="div"==a(this).parent().get(0).tagName.toLowerCase()?a(this).parent().parent():a(this).parent(),b&&(d+=b.attr("value")+c.split,e+=b.attr("text")+c.split)}),d.length>0&&(d=d.substr(0,d.length-1)),e.length>0&&(e=e.substr(0,e.length-1)),b._changeValue(d,e)},_addClickEven:function(){var b=this,c=this.options;a(".l-table-nocheckbox td",b.selectBox).click(function(){var d=a(this).attr("value"),e=parseInt(a(this).attr("index")),f=a(this).html();return b.hasBind("beforeSelect")&&0==b.trigger("beforeSelect",[d,f])?(c.slide?b.selectBox.slideToggle("fast"):b.selectBox.hide(),!1):a(this).hasClass("l-selected")?(c.slide?b.selectBox.slideToggle("fast"):b.selectBox.hide(),void 0):(a(".l-selected",b.selectBox).removeClass("l-selected"),a(this).addClass("l-selected"),b.select&&b.select[0].selectedIndex!=e&&(b.select[0].selectedIndex=e,b.select.trigger("change")),c.slide?(b.boxToggling=!0,b.selectBox.hide("fast",function(){b.boxToggling=!1})):b.selectBox.hide(),b._changeValue(d,f),void 0)})},updateSelectBoxPosition:function(){var b,c,d=this,e=this.options;e.absolute?d.selectBox.css({left:d.wrapper.offset().left,top:d.wrapper.offset().top+1+d.wrapper.outerHeight()}):(b=d.wrapper.offset().top-a(window).scrollTop(),c=d.selectBox.height()+textHeight+4,b+c>a(window).height()&&b>c&&d.selectBox.css("marginTop",-1*(d.selectBox.height()+textHeight+5)))},_toggleSelectBox:function(b){var c,d=this,e=this.options;d.wrapper.height(),d.boxToggling=!0,b?e.slide?d.selectBox.slideToggle("fast",function(){d.boxToggling=!1}):(d.selectBox.hide(),d.boxToggling=!1):(d.updateSelectBoxPosition(),e.slide?d.selectBox.slideToggle("fast",function(){if(d.boxToggling=!1,!e.isShowCheckBox&&a("td.l-selected",d.selectBox).length>0){var b=a("td.l-selected",d.selectBox).offset().top-d.selectBox.offset().top;a(".l-box-select-inner",d.selectBox).animate({scrollTop:b})}}):(d.selectBox.show(),d.boxToggling=!1,!d.tree&&!d.grid&&!e.isShowCheckBox&&a("td.l-selected",d.selectBox).length>0&&(c=a("td.l-selected",d.selectBox).offset().top-d.selectBox.offset().top,a(".l-box-select-inner",d.selectBox).animate({scrollTop:c})))),d.isShowed=d.selectBox.is(":visible"),d.trigger("toggle",[b]),d.trigger(b?"hide":"show")}}),a.ligerui.controls.ComboBox.prototype.setValue=a.ligerui.controls.ComboBox.prototype.selectValue,a.ligerui.controls.ComboBox.prototype.setInputValue=a.ligerui.controls.ComboBox.prototype._changeValue}(jQuery),function(a){a.fn.ligerDateEditor=function(){return a.ligerui.run.call(this,"ligerDateEditor",arguments)},a.fn.ligerGetDateEditorManager=function(){return a.ligerui.run.call(this,"ligerGetDateEditorManager",arguments)},a.ligerDefaults.DateEditor={format:"yyyy-MM-dd hh:mm",showTime:!1,onChangeDate:!1,absolute:!0},a.ligerDefaults.DateEditorString={dayMessage:["日","一","二","三","四","五","六"],monthMessage:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],todayMessage:"今天",closeMessage:"关闭"},a.ligerMethos.DateEditor={},a.ligerui.controls.DateEditor=function(b,c){a.ligerui.controls.DateEditor.base.constructor.call(this,b,c)},a.ligerui.controls.DateEditor.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"DateEditor"},__idPrev:function(){return"DateEditor"},_extendMethods:function(){return a.ligerMethos.DateEditor},_render:function(){var b,c,d=this,e=this.options;!e.showTime&&e.format.indexOf(" hh:mm")>-1&&(e.format=e.format.replace(" hh:mm","")),"input"==this.element.tagName.toLowerCase()&&"text"==this.element.type&&(d.inputText=a(this.element),d.inputText.hasClass("l-text-field")||d.inputText.addClass("l-text-field"),d.link=a('<div class="l-trigger"><div class="l-trigger-icon"></div></div>'),d.text=d.inputText.wrap('<div class="l-text l-text-date"></div>').parent(),d.text.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),d.text.append(d.link),d.textwrapper=d.text.wrap('<div class="l-text-wrapper"></div>').parent(),b="",b+="<div class='l-box-dateeditor' style='display:none'>",b+="    <div class='l-box-dateeditor-header'>",b+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevyear'><span></span></div>",b+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-prevmonth'><span></span></div>",b+="        <div class='l-box-dateeditor-header-text'><a class='l-box-dateeditor-header-month'></a> , <a  class='l-box-dateeditor-header-year'></a></div>",b+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextmonth'><span></span></div>",b+="        <div class='l-box-dateeditor-header-btn l-box-dateeditor-header-nextyear'><span></span></div>",b+="    </div>",b+="    <div class='l-box-dateeditor-body'>",b+="        <table cellpadding='0' cellspacing='0' border='0' class='l-box-dateeditor-calendar'>",b+="            <thead>",b+="                <tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>",b+="            </thead>",b+="            <tbody>",b+="                <tr class='l-first'><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr><tr><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td><td align='center'></td></tr>",b+="            </tbody>",b+="        </table>",b+="        <ul class='l-box-dateeditor-monthselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",b+="        <ul class='l-box-dateeditor-yearselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",b+="        <ul class='l-box-dateeditor-hourselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",b+="        <ul class='l-box-dateeditor-minuteselector'><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul>",b+="    </div>",b+="    <div class='l-box-dateeditor-toolbar'>",b+="        <div class='l-box-dateeditor-time'></div>",b+="        <div class='l-button l-button-today'></div>",b+="        <div class='l-button l-button-close'></div>",b+="        <div class='l-clear'></div>",b+="    </div>",b+="</div>",d.dateeditor=a(b),e.absolute?d.dateeditor.appendTo("body").addClass("l-box-dateeditor-absolute"):d.textwrapper.append(d.dateeditor),d.header=a(".l-box-dateeditor-header",d.dateeditor),d.body=a(".l-box-dateeditor-body",d.dateeditor),d.toolbar=a(".l-box-dateeditor-toolbar",d.dateeditor),d.body.thead=a("thead",d.body),d.body.tbody=a("tbody",d.body),d.body.monthselector=a(".l-box-dateeditor-monthselector",d.body),d.body.yearselector=a(".l-box-dateeditor-yearselector",d.body),d.body.hourselector=a(".l-box-dateeditor-hourselector",d.body),d.body.minuteselector=a(".l-box-dateeditor-minuteselector",d.body),d.toolbar.time=a(".l-box-dateeditor-time",d.toolbar),d.toolbar.time.hour=a("<a></a>"),d.toolbar.time.minute=a("<a></a>"),d.buttons={btnPrevYear:a(".l-box-dateeditor-header-prevyear",d.header),btnNextYear:a(".l-box-dateeditor-header-nextyear",d.header),btnPrevMonth:a(".l-box-dateeditor-header-prevmonth",d.header),btnNextMonth:a(".l-box-dateeditor-header-nextmonth",d.header),btnYear:a(".l-box-dateeditor-header-year",d.header),btnMonth:a(".l-box-dateeditor-header-month",d.header),btnToday:a(".l-button-today",d.toolbar),btnClose:a(".l-button-close",d.toolbar)},c=new Date,d.now={year:c.getFullYear(),month:c.getMonth()+1,day:c.getDay(),date:c.getDate(),hour:c.getHours(),minute:c.getMinutes()},d.currentDate={year:c.getFullYear(),month:c.getMonth()+1,day:c.getDay(),date:c.getDate(),hour:c.getHours(),minute:c.getMinutes()},d.selectedDate=null,d.usedDate=null,a("td",d.body.thead).each(function(b,c){a(c).html(e.dayMessage[b])}),a("li",d.body.monthselector).each(function(b,c){a(c).html(e.monthMessage[b])}),d.buttons.btnToday.html(e.todayMessage),d.buttons.btnClose.html(e.closeMessage),e.showTime&&(d.toolbar.time.show(),d.toolbar.time.append(d.toolbar.time.hour).append(":").append(d.toolbar.time.minute),a("li",d.body.hourselector).each(function(b){var c=b;10>b&&(c="0"+b.toString()),a(this).html(c)}),a("li",d.body.minuteselector).each(function(b){var c=b;10>b&&(c="0"+b.toString()),a(this).html(c)})),d.bulidContent(),""!=d.inputText.val()&&d.onTextChange(),d.dateeditor.hover(null,function(){d.dateeditor.is(":visible")&&!d.editorToggling&&d.toggleDateEditor(!0)}),d.link.hover(function(){e.disabled||(this.className="l-trigger-hover")},function(){e.disabled||(this.className="l-trigger")}).mousedown(function(){e.disabled||(this.className="l-trigger-pressed")}).mouseup(function(){e.disabled||(this.className="l-trigger-hover")}).click(function(){e.disabled||(d.bulidContent(),d.toggleDateEditor(d.dateeditor.is(":visible")))}),e.disabled&&(d.inputText.attr("readonly","readonly"),d.text.addClass("l-text-disabled")),e.initValue&&d.inputText.val(e.initValue),d.buttons.btnClose.click(function(){d.toggleDateEditor(!0)}),a("td",d.body.tbody).hover(function(){a(this).hasClass("l-box-dateeditor-today")||a(this).addClass("l-box-dateeditor-over")},function(){a(this).removeClass("l-box-dateeditor-over")}).click(function(){a(".l-box-dateeditor-selected",d.body.tbody).removeClass("l-box-dateeditor-selected"),a(this).hasClass("l-box-dateeditor-today")||a(this).addClass("l-box-dateeditor-selected"),d.currentDate.date=parseInt(a(this).html()),d.currentDate.day=new Date(d.currentDate.year,d.currentDate.month-1,1).getDay(),a(this).hasClass("l-box-dateeditor-out")&&(0==a("tr",d.body.tbody).index(a(this).parent())?0==--d.currentDate.month&&(d.currentDate.month=12,d.currentDate.year--):13==++d.currentDate.month&&(d.currentDate.month=1,d.currentDate.year++)),d.selectedDate={year:d.currentDate.year,month:d.currentDate.month,date:d.currentDate.date},d.showDate(),d.editorToggling=!0,d.dateeditor.slideToggle("fast",function(){d.editorToggling=!1})}),a(".l-box-dateeditor-header-btn",d.header).hover(function(){a(this).addClass("l-box-dateeditor-header-btn-over")},function(){a(this).removeClass("l-box-dateeditor-header-btn-over")}),d.buttons.btnYear.click(function(){d.body.yearselector.is(":visible")||a("li",d.body.yearselector).each(function(b){var c=d.currentDate.year+(b-4);c==d.currentDate.year?a(this).addClass("l-selected"):a(this).removeClass("l-selected"),a(this).html(c)}),d.body.yearselector.slideToggle()}),d.body.yearselector.hover(function(){},function(){a(this).slideUp()}),a("li",d.body.yearselector).click(function(){d.currentDate.year=parseInt(a(this).html()),d.body.yearselector.slideToggle(),d.bulidContent()}),d.buttons.btnMonth.click(function(){a("li",d.body.monthselector).each(function(b){d.currentDate.month==b+1?a(this).addClass("l-selected"):a(this).removeClass("l-selected")}),d.body.monthselector.slideToggle()}),d.body.monthselector.hover(function(){},function(){a(this).slideUp("fast")}),a("li",d.body.monthselector).click(function(){var b=a("li",d.body.monthselector).index(this);d.currentDate.month=b+1,d.body.monthselector.slideToggle(),d.bulidContent()}),d.toolbar.time.hour.click(function(){a("li",d.body.hourselector).each(function(b){d.currentDate.hour==b?a(this).addClass("l-selected"):a(this).removeClass("l-selected")}),d.body.hourselector.slideToggle()}),d.body.hourselector.hover(function(){},function(){a(this).slideUp("fast")}),a("li",d.body.hourselector).click(function(){var b=a("li",d.body.hourselector).index(this);d.currentDate.hour=b,d.body.hourselector.slideToggle(),d.bulidContent()}),d.toolbar.time.minute.click(function(){a("li",d.body.minuteselector).each(function(b){d.currentDate.minute==b?a(this).addClass("l-selected"):a(this).removeClass("l-selected")}),d.body.minuteselector.slideToggle("fast",function(){var b,c=a("li",this).index(a("li.l-selected",this));c>29&&(b=a("li.l-selected",this).offset().top-a(this).offset().top,a(this).animate({scrollTop:b}))})}),d.body.minuteselector.hover(function(){},function(){a(this).slideUp("fast")}),a("li",d.body.minuteselector).click(function(){var b=a("li",d.body.minuteselector).index(this);d.currentDate.minute=b,d.body.minuteselector.slideToggle("fast"),d.bulidContent()}),d.buttons.btnPrevMonth.click(function(){0==--d.currentDate.month&&(d.currentDate.month=12,d.currentDate.year--),d.bulidContent()}),d.buttons.btnNextMonth.click(function(){13==++d.currentDate.month&&(d.currentDate.month=1,d.currentDate.year++),d.bulidContent()}),d.buttons.btnPrevYear.click(function(){d.currentDate.year--,d.bulidContent()}),d.buttons.btnNextYear.click(function(){d.currentDate.year++,d.bulidContent()}),d.buttons.btnToday.click(function(){d.currentDate={year:d.now.year,month:d.now.month,day:d.now.day,date:d.now.date},d.selectedDate={year:d.now.year,month:d.now.month,day:d.now.day,date:d.now.date},d.showDate(),d.dateeditor.slideToggle("fast")}),d.inputText.change(function(){d.onTextChange()}).blur(function(){d.text.removeClass("l-text-focus")}).focus(function(){d.text.addClass("l-text-focus")}),d.text.hover(function(){d.text.addClass("l-text-over")},function(){d.text.removeClass("l-text-over")}),e.label&&(d.labelwrapper=d.textwrapper.wrap('<div class="l-labeltext"></div>').parent(),d.labelwrapper.prepend('<div class="l-text-label" style="float:left;display:inline;">'+e.label+":&nbsp</div>"),d.textwrapper.css("float","left"),e.labelWidth?a(".l-text-label",d.labelwrapper).outerWidth(e.labelWidth):e.labelWidth=a(".l-text-label",d.labelwrapper).outerWidth(),a(".l-text-label",d.labelwrapper).width(e.labelWidth),a(".l-text-label",d.labelwrapper).height(d.text.height()),d.labelwrapper.append('<br style="clear:both;" />'),e.labelAlign&&a(".l-text-label",d.labelwrapper).css("text-align",e.labelAlign),d.textwrapper.css({display:"inline"}),d.labelwrapper.width(d.text.outerWidth()+e.labelWidth+2)),d.set(e))},destroy:function(){this.textwrapper&&this.textwrapper.remove(),this.dateeditor&&this.dateeditor.remove(),this.options=null,a.ligerui.remove(this)},bulidContent:function(){var b,c,d=this,e=this.options,f=new Date(d.currentDate.year,d.currentDate.month-1,1).getDay(),g=d.currentDate.month,h=d.currentDate.year;13==++g&&(g=1,h++),b=new Date(h,g-1,0).getDate(),c=new Date(d.currentDate.year,d.currentDate.month-1,0).getDate(),d.buttons.btnMonth.html(e.monthMessage[d.currentDate.month-1]),d.buttons.btnYear.html(d.currentDate.year),d.toolbar.time.hour.html(d.currentDate.hour),d.toolbar.time.minute.html(d.currentDate.minute),1==d.toolbar.time.hour.html().length&&d.toolbar.time.hour.html("0"+d.toolbar.time.hour.html()),1==d.toolbar.time.minute.html().length&&d.toolbar.time.minute.html("0"+d.toolbar.time.minute.html()),a("td",this.body.tbody).each(function(){this.className=""}),a("tr",this.body.tbody).each(function(e,g){a("td",g).each(function(g,h){var i=7*e+(g-f),j=i+1;d.selectedDate&&d.currentDate.year==d.selectedDate.year&&d.currentDate.month==d.selectedDate.month&&i+1==d.selectedDate.date?((0==g||6==g)&&a(h).addClass("l-box-dateeditor-holiday"),a(h).addClass("l-box-dateeditor-selected"),a(h).siblings().removeClass("l-box-dateeditor-selected")):d.currentDate.year==d.now.year&&d.currentDate.month==d.now.month&&i+1==d.now.date?((0==g||6==g)&&a(h).addClass("l-box-dateeditor-holiday"),a(h).addClass("l-box-dateeditor-today")):0>i?(j=c+j,a(h).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):i>b-1?(j-=b,a(h).addClass("l-box-dateeditor-out").removeClass("l-box-dateeditor-selected")):0==g||6==g?a(h).addClass("l-box-dateeditor-holiday").removeClass("l-box-dateeditor-selected"):h.className="",a(h).html(j)})})},updateSelectBoxPosition:function(){var b=this,c=this.options;c.absolute?b.dateeditor.css({left:b.text.offset().left,top:b.text.offset().top+1+b.text.outerHeight()}):b.text.offset().top+4>b.dateeditor.height()&&b.text.offset().top+b.dateeditor.height()+textHeight+4-a(window).scrollTop()>a(window).height()?(b.dateeditor.css("marginTop",-1*(b.dateeditor.height()+textHeight+5)),b.showOnTop=!0):b.showOnTop=!1},toggleDateEditor:function(a){var b=this;this.options,b.text.height(),b.editorToggling=!0,a?b.dateeditor.hide("fast",function(){b.editorToggling=!1}):(b.updateSelectBoxPosition(),b.dateeditor.slideDown("fast",function(){b.editorToggling=!1}))},showDate:function(){var a,b=this,c=this.options;this.selectedDate&&(a=b.selectedDate.year+"/"+b.selectedDate.month+"/"+b.selectedDate.date,this.currentDate.hour=parseInt(b.toolbar.time.hour.html(),10),this.currentDate.minute=parseInt(b.toolbar.time.minute.html(),10),c.showTime&&(a+=" "+this.currentDate.hour+":"+this.currentDate.minute),this.inputText.val(a),this.inputText.trigger("change").focus())},isDateTime:function(a){var b,c;return this.options,b=a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/),null==b?!1:(c=new Date(b[1],b[3]-1,b[4]),"NaN"==c?!1:c.getFullYear()==b[1]&&c.getMonth()+1==b[3]&&c.getDate()==b[4])},isLongDateTime:function(a){var b,c,d;return this.options,b=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/,c=a.match(b),null==c?!1:(d=new Date(c[1],c[3]-1,c[4],c[5],c[6]),"NaN"==d?!1:d.getFullYear()==c[1]&&d.getMonth()+1==c[3]&&d.getDate()==c[4]&&d.getHours()==c[5]&&d.getMinutes()==c[6])},getFormatDate:function(a){var b,c,d,e=this.options;if("NaN"==a)return null;b=e.format,c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()},/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},onTextChange:function(){var b,c=this,d=this.options,e=c.inputText.val();return""==e?(c.selectedDate=null,!0):(d.showTime||c.isDateTime(e)?d.showTime&&!c.isLongDateTime(e)?c.usedDate?c.inputText.val(c.getFormatDate(c.usedDate)):c.inputText.val(""):(e=e.replace(/-/g,"/"),b=c.getFormatDate(new Date(e)),null==b&&(c.usedDate?c.inputText.val(c.getFormatDate(c.usedDate)):c.inputText.val("")),c.usedDate=new Date(e),c.selectedDate={year:c.usedDate.getFullYear(),month:c.usedDate.getMonth()+1,day:c.usedDate.getDay(),date:c.usedDate.getDate(),hour:c.usedDate.getHours(),minute:c.usedDate.getMinutes()},c.currentDate={year:c.usedDate.getFullYear(),month:c.usedDate.getMonth()+1,day:c.usedDate.getDay(),date:c.usedDate.getDate(),hour:c.usedDate.getHours(),minute:c.usedDate.getMinutes()},c.inputText.val(b),c.trigger("changeDate",[b]),a(c.dateeditor).is(":visible")&&c.bulidContent()):c.usedDate?c.inputText.val(c.getFormatDate(c.usedDate)):c.inputText.val(""),void 0)},_setHeight:function(a){var b=this;a>4&&(b.text.css({height:a}),b.inputText.css({height:a}),b.textwrapper.css({height:a}))},_setWidth:function(a){var b=this;a>20&&(b.text.css({width:a}),b.inputText.css({width:a-20}),b.textwrapper.css({width:a}))},_setValue:function(a){var b=this;a||b.inputText.val(""),"string"==typeof a?b.inputText.val(a):"object"==typeof a&&a instanceof Date&&(b.inputText.val(b.getFormatDate(a)),b.onTextChange())},_getValue:function(){return this.usedDate},setEnabled:function(){var a=this.options;this.inputText.removeAttr("readonly"),this.text.removeClass("l-text-disabled"),a.disabled=!1},setDisabled:function(){var a=this.options;this.inputText.attr("readonly","readonly"),this.text.addClass("l-text-disabled"),a.disabled=!0}})}(jQuery),function(a){var b=a.ligerui;a(".l-dialog-btn").live("mouseover",function(){a(this).addClass("l-dialog-btn-over")}).live("mouseout",function(){a(this).removeClass("l-dialog-btn-over")}),a(".l-dialog-tc .l-dialog-close").live("mouseover",function(){a(this).addClass("l-dialog-close-over")}).live("mouseout",function(){a(this).removeClass("l-dialog-close-over")}),a.ligerDialog=function(){return b.run.call(null,"ligerDialog",arguments,{isStatic:!0})},a.ligerui.DialogImagePath="../../lib/ligerUI/skins/Aqua/images/win/",a.ligerDefaults.Dialog={cls:null,id:null,buttons:null,isDrag:!0,width:280,height:null,content:"",target:null,url:null,load:!1,onLoaded:null,type:"none",left:null,top:null,modal:!0,name:null,isResize:!1,allowClose:!0,opener:null,timeParmName:null,closeWhenEnter:null,isHidden:!0,show:!0,title:"提示",showMax:!1,showToggle:!1,showMin:!1,slide:a.browser.msie?!1:!0,fixedType:null,showType:null},a.ligerDefaults.DialogString={titleMessage:"提示",ok:"确定",yes:"是",no:"否",cancel:"取消",waittingMessage:"正在等待中,请稍候..."},a.ligerMethos.Dialog=a.ligerMethos.Dialog||{},b.controls.Dialog=function(a){b.controls.Dialog.base.constructor.call(this,null,a)},b.controls.Dialog.ligerExtend(b.core.Win,{__getType:function(){return"Dialog"},__idPrev:function(){return"Dialog"},_extendMethods:function(){return a.ligerMethos.Dialog},_render:function(){var c,d,e,f,g,h=this,i=this.options;h.set(i,!0),c=a('<div class="l-dialog"><table class="l-dialog-table" cellpadding="0" cellspacing="0" border="0"><tbody><tr><td class="l-dialog-tl"></td><td class="l-dialog-tc"><div class="l-dialog-tc-inner"><div class="l-dialog-icon"></div><div class="l-dialog-title"></div><div class="l-dialog-winbtns"><div class="l-dialog-winbtn l-dialog-close"></div></div></div></td><td class="l-dialog-tr"></td></tr><tr><td class="l-dialog-cl"></td><td class="l-dialog-cc"><div class="l-dialog-body"><div class="l-dialog-image"></div> <div class="l-dialog-content"></div><div class="l-dialog-buttons"><div class="l-dialog-buttons-inner"></div></td><td class="l-dialog-cr"></td></tr><tr><td class="l-dialog-bl"></td><td class="l-dialog-bc"></td><td class="l-dialog-br"></td></tr></tbody></table></div>'),a("body").append(c),h.dialog=c,h.element=c[0],h.dialog.body=a(".l-dialog-body:first",h.dialog),h.dialog.header=a(".l-dialog-tc-inner:first",h.dialog),h.dialog.winbtns=a(".l-dialog-winbtns:first",h.dialog.header),h.dialog.buttons=a(".l-dialog-buttons:first",h.dialog),h.dialog.content=a(".l-dialog-content:first",h.dialog),h.set(i,!1),0==i.allowClose&&a(".l-dialog-close",h.dialog).remove(),(i.target||i.url||"none"==i.type)&&(i.type=null,h.dialog.addClass("l-dialog-win")),i.cls&&h.dialog.addClass(i.cls),i.id&&h.dialog.attr("id",i.id),h.mask(),i.isDrag&&h._applyDrag(),i.isResize&&h._applyResize(),i.type?h._setImage():(a(".l-dialog-image",h.dialog).remove(),h.dialog.content.addClass("l-dialog-content-noimage")),i.show||(h.unmask(),h.dialog.hide()),i.target?(h.dialog.content.prepend(i.target),a(i.target).show()):i.url&&(i.timeParmName&&(i.url+=-1==i.url.indexOf("?")?"?":"&",i.url+=i.timeParmName+"="+(new Date).getTime()),i.load?h.dialog.body.load(i.url,function(){h._saveStatus(),h.trigger("loaded")}):(h.jiframe=a("<iframe frameborder='0'></iframe>"),d=i.name?i.name:"ligerwindow"+(new Date).getTime(),h.jiframe.attr("name",d),h.jiframe.attr("id",d),h.dialog.content.prepend(h.jiframe),h.dialog.content.addClass("l-dialog-content-nopadding"),setTimeout(function(){h.jiframe.attr("src",i.url),h.frame=window.frames[h.jiframe.attr("name")]},0))),i.opener&&(h.dialog.opener=i.opener),i.buttons?a(i.buttons).each(function(b,c){var d=a('<div class="l-dialog-btn"><div class="l-dialog-btn-l"></div><div class="l-dialog-btn-r"></div><div class="l-dialog-btn-inner"></div></div>');a(".l-dialog-btn-inner",d).html(c.text),a(".l-dialog-buttons-inner",h.dialog.buttons).prepend(d),c.width&&d.width(c.width),c.onclick&&d.click(function(){c.onclick(c,h,b)})}):h.dialog.buttons.remove(),a(".l-dialog-buttons-inner",h.dialog.buttons).append("<div class='l-clear'></div>"),a(".l-dialog-title",h.dialog).bind("selectstart",function(){return!1}),h.dialog.click(function(){b.win.setFront(h)}),a(".l-dialog-tc .l-dialog-close",h.dialog).click(function(){i.isHidden?h.hide():h.close()}),i.fixedType||(e=0,f=0,g=i.width||h.dialog.width(),1==i.slide&&(i.slide="fast"),null!=i.left?e=i.left:i.left=e=.5*(a(window).width()-g),null!=i.top?f=i.top:i.top=f=.5*(a(window).height()-h.dialog.height())+a(window).scrollTop()-10,0>e&&(i.left=e=0),0>f&&(i.top=f=0),h.dialog.css({left:e,top:f})),h.show(),a("body").bind("keydown.dialog",function(a){var b=a.which;13==b?h.enter():27==b&&h.esc()}),h._updateBtnsWidth(),h._saveStatus(),h._onReisze()},_borderX:12,_borderY:32,doMax:function(c){var d=this,e=this.options,f=a(window).width(),g=a(window).height(),h=0,i=0;b.win.taskbar&&(g-=b.win.taskbar.outerHeight(),b.win.top&&(i+=b.win.taskbar.outerHeight())),c?(d.dialog.body.animate({width:f-d._borderX},e.slide),d.dialog.animate({left:h,top:i},e.slide),d.dialog.content.animate({height:g-d._borderY-d.dialog.buttons.outerHeight()},e.slide,function(){d._onReisze()})):(d.set({width:f,height:g,left:h,top:i}),d._onReisze())},max:function(){var b=this,c=this.options;b.winmax&&(b.winmax.addClass("l-dialog-recover"),b.doMax(c.slide),b.wintoggle&&(b.wintoggle.hasClass("l-dialog-extend")?b.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-extend-disabled"):b.wintoggle.addClass("l-dialog-toggle-disabled l-dialog-collapse-disabled")),b.resizable&&b.resizable.set({disabled:!0}),b.draggable&&b.draggable.set({disabled:!0}),b.maximum=!0,a(window).bind("resize.dialogmax",function(){b.doMax(!1)}))},recover:function(){var b=this,c=this.options;b.winmax&&(b.winmax.removeClass("l-dialog-recover"),c.slide?(b.dialog.body.animate({width:b._width-b._borderX},c.slide),b.dialog.animate({left:b._left,top:b._top},c.slide),b.dialog.content.animate({height:b._height-b._borderY-b.dialog.buttons.outerHeight()},c.slide,function(){b._onReisze()})):(b.set({width:b._width,height:b._height,left:b._left,top:b._top}),b._onReisze()),b.wintoggle&&b.wintoggle.removeClass("l-dialog-toggle-disabled l-dialog-extend-disabled l-dialog-collapse-disabled"),a(window).unbind("resize.dialogmax")),this.resizable&&this.resizable.set({disabled:!1}),b.draggable&&b.draggable.set({disabled:!1}),b.maximum=!1},min:function(){var a=this,c=this.options,d=b.win.getTask(this);c.slide?(a.dialog.body.animate({width:1},c.slide),d.y=d.offset().top+d.height(),d.x=d.offset().left+d.width()/2,a.dialog.animate({left:d.x,top:d.y},c.slide,function(){a.dialog.hide()})):a.dialog.hide(),a.unmask(),a.minimize=!0,a.actived=!1},active:function(){var c,d,e,f,g=this,h=this.options;g.minimize&&(c=g._width,d=g._height,e=g._left,f=g._top,g.maximum&&(c=a(window).width(),d=a(window).height(),e=f=0,b.win.taskbar&&(d-=b.win.taskbar.outerHeight(),b.win.top&&(f+=b.win.taskbar.outerHeight()))),h.slide?(g.dialog.body.animate({width:c-g._borderX},h.slide),g.dialog.animate({left:e,top:f},h.slide)):g.set({width:c,height:d,left:e,top:f})),g.actived=!0,g.minimize=!1,b.win.setFront(g),g.show()},toggle:function(){var a=this;this.options,a.wintoggle&&(a.wintoggle.hasClass("l-dialog-extend")?a.extend():a.collapse())},collapse:function(){var a=this,b=this.options;a.wintoggle&&(b.slide?a.dialog.content.animate({height:1},b.slide):a.dialog.content.height(1),this.resizable&&this.resizable.set({disabled:!0}))},extend:function(){var a,b=this,c=this.options;b.wintoggle&&(a=b._height-b._borderY-b.dialog.buttons.outerHeight(),c.slide?b.dialog.content.animate({height:a},c.slide):b.dialog.content.height(a),this.resizable&&this.resizable.set({disabled:!1}))},_updateBtnsWidth:function(){var b=this,c=a(">div",b.dialog.winbtns).length;b.dialog.winbtns.width(22*c)},_setLeft:function(a){this.dialog&&null!=a&&this.dialog.css({left:a})},_setTop:function(a){this.dialog&&null!=a&&this.dialog.css({top:a})},_setWidth:function(a){this.dialog&&a>=this._borderX&&this.dialog.body.width(a-this._borderX)},_setHeight:function(a){var b,c=this;this.options,this.dialog&&a>=this._borderY&&(b=a-this._borderY-c.dialog.buttons.outerHeight(),c.dialog.content.height(b))},_setShowMax:function(b){var c=this;this.options,b?c.winmax||(c.winmax=a('<div class="l-dialog-winbtn l-dialog-max"></div>').appendTo(c.dialog.winbtns).hover(function(){a(this).hasClass("l-dialog-recover")?a(this).addClass("l-dialog-recover-over"):a(this).addClass("l-dialog-max-over")},function(){a(this).removeClass("l-dialog-max-over l-dialog-recover-over")}).click(function(){a(this).hasClass("l-dialog-recover")?c.recover():c.max()})):c.winmax&&(c.winmax.remove(),c.winmax=null),c._updateBtnsWidth()},_setShowMin:function(c){var d=this;this.options,c?d.winmin||(d.winmin=a('<div class="l-dialog-winbtn l-dialog-min"></div>').appendTo(d.dialog.winbtns).hover(function(){a(this).addClass("l-dialog-min-over")},function(){a(this).removeClass("l-dialog-min-over")}).click(function(){d.min()}),b.win.addTask(d)):d.winmin&&(d.winmin.remove(),d.winmin=null),d._updateBtnsWidth()},_setShowToggle:function(b){var c=this;this.options,b?c.wintoggle||(c.wintoggle=a('<div class="l-dialog-winbtn l-dialog-collapse"></div>').appendTo(c.dialog.winbtns).hover(function(){a(this).hasClass("l-dialog-toggle-disabled")||(a(this).hasClass("l-dialog-extend")?a(this).addClass("l-dialog-extend-over"):a(this).addClass("l-dialog-collapse-over"))},function(){a(this).removeClass("l-dialog-extend-over l-dialog-collapse-over")}).click(function(){if(!a(this).hasClass("l-dialog-toggle-disabled"))if(c.wintoggle.hasClass("l-dialog-extend")){if(0==c.trigger("extend"))return;c.wintoggle.removeClass("l-dialog-extend"),c.extend(),c.trigger("extended")}else{if(0==c.trigger("collapse"))return;c.wintoggle.addClass("l-dialog-extend"),c.collapse(),c.trigger("collapseed")}})):c.wintoggle&&(c.wintoggle.remove(),c.wintoggle=null)},enter:function(){var a,b=this,c=this.options;void 0!=c.closeWhenEnter?a=c.closeWhenEnter:("warn"==c.type||"error"==c.type||"success"==c.type||"question"==c.type)&&(a=!0),a&&b.close()},esc:function(){},_removeDialog:function(){var a=this,b=this.options;b.showType&&b.fixedType?a.dialog.animate({bottom:-1*b.height},function(){a.dialog.remove()}):a.dialog.remove()},close:function(){var c=this;this.options,b.win.removeTask(this),c.unmask(),c._removeDialog(),a("body").unbind("keydown.dialog")},_getVisible:function(){return this.dialog.is(":visible")},_setUrl:function(a){var b=this,c=this.options;c.url=a,c.load?b.dialog.body.html("").load(c.url,function(){b.trigger("loaded")}):b.jiframe&&b.jiframe.attr("src",c.url)},_setContent:function(a){this.dialog.content.html(a)},_setTitle:function(b){var c=this;this.options,b&&a(".l-dialog-title",c.dialog).html(b)},_hideDialog:function(){var a=this,b=this.options;b.showType&&b.fixedType?a.dialog.animate({bottom:-1*b.height},function(){a.dialog.hide()}):a.dialog.hide()},hidden:function(){var a=this;b.win.removeTask(a),a.dialog.hide(),a.unmask()},show:function(){var b=this,c=this.options;b.mask(),c.fixedType?c.showType?(b.dialog.css({bottom:-1*c.height}).addClass("l-dialog-fixed"),b.dialog.show().animate({bottom:0})):b.dialog.show().css({bottom:0}):b.dialog.show(),a.ligerui.win.setFront.ligerDefer(a.ligerui.win,100,[b])},setUrl:function(a){this._setUrl(a)},_saveStatus:function(){var a,b,c=this;
c._width=c.dialog.body.width(),c._height=c.dialog.body.height(),a=0,b=0,isNaN(parseInt(c.dialog.css("top")))||(a=parseInt(c.dialog.css("top"))),isNaN(parseInt(c.dialog.css("left")))||(b=parseInt(c.dialog.css("left"))),c._top=a,c._left=b},_applyDrag:function(){var c=this,d=this.options;a.fn.ligerDrag&&(c.draggable=c.dialog.ligerDrag({handler:".l-dialog-title",animate:!1,onStartDrag:function(){b.win.setFront(c)},onStopDrag:function(){var e,f;d.target&&(e=b.find(a.ligerui.controls.DateEditor),f=b.find(a.ligerui.controls.ComboBox),a(a.merge(e,f)).each(function(){this.updateSelectBoxPosition&&this.updateSelectBoxPosition()})),c._saveStatus()}}))},_onReisze:function(){var b,c,d,e=this,f=this.options;if(f.target){if(b=a(f.target).liger(),b||(b=a(f.target).find(":first").liger()),!b)return;c=e.dialog.content.height(),d=e.dialog.content.width(),b.trigger("resize",[{width:d,height:c}])}},_applyResize:function(){var b=this;this.options,a.fn.ligerResizable&&(b.resizable=b.dialog.ligerResizable({onStopResize:function(a){var c=0,d=0;return isNaN(parseInt(b.dialog.css("top")))||(c=parseInt(b.dialog.css("top"))),isNaN(parseInt(b.dialog.css("left")))||(d=parseInt(b.dialog.css("left"))),a.diffLeft&&b.set({left:d+a.diffLeft}),a.diffTop&&b.set({top:c+a.diffTop}),a.newWidth&&(b.set({width:a.newWidth}),b.dialog.body.css({width:a.newWidth-b._borderX})),a.newHeight&&b.set({height:a.newHeight}),b._onReisze(),b._saveStatus(),!1},animate:!1}))},_setImage:function(){var b=this,c=this.options;c.type&&("success"==c.type||"donne"==c.type||"ok"==c.type?(a(".l-dialog-image",b.dialog).addClass("l-dialog-image-donne").show(),b.dialog.content.css({paddingLeft:64,paddingBottom:30})):"error"==c.type?(a(".l-dialog-image",b.dialog).addClass("l-dialog-image-error").show(),b.dialog.content.css({paddingLeft:64,paddingBottom:30})):"warn"==c.type?(a(".l-dialog-image",b.dialog).addClass("l-dialog-image-warn").show(),b.dialog.content.css({paddingLeft:64,paddingBottom:30})):"question"==c.type&&(a(".l-dialog-image",b.dialog).addClass("l-dialog-image-question").show(),b.dialog.content.css({paddingLeft:64,paddingBottom:40})))}}),b.controls.Dialog.prototype.hide=b.controls.Dialog.prototype.hidden,a.ligerDialog.open=function(b){return a.ligerDialog(b)},a.ligerDialog.close=function(){var a,c,d=b.find(b.controls.Dialog.prototype.__getType());for(a in d)c=d[a],c.destroy.ligerDefer(c,5);b.win.unmask()},a.ligerDialog.show=function(c){var d,e=b.find(b.controls.Dialog.prototype.__getType());if(e.length)for(d in e)return e[d].show(),void 0;return a.ligerDialog(c)},a.ligerDialog.hide=function(){var a,c,d=b.find(b.controls.Dialog.prototype.__getType());for(a in d)c=d[a],c.hide()},a.ligerDialog.tip=function(b){return b=a.extend({showType:"slide",width:240,modal:!1,height:100},b||{}),a.extend(b,{fixedType:"se",type:"none",isDrag:!1,isResize:!1,showMax:!1,showToggle:!1,showMin:!1}),a.ligerDialog.open(b)},a.ligerDialog.alert=function(b,c,d,e){b=b||"","function"==typeof c?(e=c,d=null):"function"==typeof d&&(e=d);var f=function(a,b,c){b.close(),e&&e(a,b,c)};return p={content:b,buttons:[{text:a.ligerDefaults.DialogString.ok,onclick:f}]},"string"==typeof c&&""!=c&&(p.title=c),"string"==typeof d&&""!=d&&(p.type=d),a.extend(p,{showMax:!1,showToggle:!1,showMin:!1}),a.ligerDialog(p)},a.ligerDialog.confirm=function(b,c,d){"function"==typeof c&&(d=c,type=null);var e=function(a,b){b.close(),d&&d("ok"==a.type)};return p={type:"question",content:b,buttons:[{text:a.ligerDefaults.DialogString.yes,onclick:e,type:"ok"},{text:a.ligerDefaults.DialogString.no,onclick:e,type:"no"}]},"string"==typeof c&&""!=c&&(p.title=c),a.extend(p,{showMax:!1,showToggle:!1,showMin:!1}),a.ligerDialog(p)},a.ligerDialog.warning=function(b,c,d){"function"==typeof c&&(d=c,type=null);var e=function(a,b){b.close(),d&&d(a.type)};return p={type:"question",content:b,buttons:[{text:a.ligerDefaults.DialogString.yes,onclick:e,type:"yes"},{text:a.ligerDefaults.DialogString.no,onclick:e,type:"no"},{text:a.ligerDefaults.DialogString.cancel,onclick:e,type:"cancel"}]},"string"==typeof c&&""!=c&&(p.title=c),a.extend(p,{showMax:!1,showToggle:!1,showMin:!1}),a.ligerDialog(p)},a.ligerDialog.waitting=function(b){return b=b||a.ligerDefaults.Dialog.waittingMessage,a.ligerDialog.open({cls:"l-dialog-waittingdialog",type:"none",content:'<div style="padding:4px">'+b+"</div>",allowClose:!1})},a.ligerDialog.closeWaitting=function(){var a,c,d=b.find(b.controls.Dialog);for(a in d)c=d[a],c.dialog.hasClass("l-dialog-waittingdialog")&&c.close()},a.ligerDialog.success=function(b,c,d){return a.ligerDialog.alert(b,c,"success",d)},a.ligerDialog.error=function(b,c,d){return a.ligerDialog.alert(b,c,"error",d)},a.ligerDialog.warn=function(b,c,d){return a.ligerDialog.alert(b,c,"warn",d)},a.ligerDialog.question=function(b,c){return a.ligerDialog.alert(b,c,"question")},a.ligerDialog.prompt=function(b,c,d,e){var f,g=a('<input type="text" class="l-dialog-inputtext"/>');return"function"==typeof d&&(e=d),"function"==typeof c?e=c:"boolean"==typeof c&&(d=c),"boolean"==typeof d&&d&&(g=a('<textarea class="l-dialog-textarea"></textarea>')),("string"==typeof c||"int"==typeof c)&&g.val(c),f=function(a,b){b.close(),e&&e("yes"==a.type,g.val())},p={title:b,target:g,width:320,buttons:[{text:a.ligerDefaults.DialogString.ok,onclick:f,type:"yes"},{text:a.ligerDefaults.DialogString.cancel,onclick:f,type:"cancel"}]},a.ligerDialog(p)}}(jQuery),function(a){var b=a.ligerui;a.fn.ligerDrag=function(){return b.run.call(this,"ligerDrag",arguments,{idAttrName:"ligeruidragid",hasElement:!1,propertyToElemnt:"target"})},a.fn.ligerGetDragManager=function(){return b.run.call(this,"ligerGetDragManager",arguments,{idAttrName:"ligeruidragid",hasElement:!1,propertyToElemnt:"target"})},a.ligerDefaults.Drag={onStartDrag:!1,onDrag:!1,onStopDrag:!1,handler:null,proxy:!0,revert:!1,animate:!0,onRevert:null,onEndRevert:null,receive:null,onDragEnter:null,onDragOver:null,onDragLeave:null,onDrop:null,disabled:!1,proxyX:null,proxyY:null},b.controls.Drag=function(a){b.controls.Drag.base.constructor.call(this,null,a)},b.controls.Drag.ligerExtend(b.core.UIComponent,{__getType:function(){return"Drag"},__idPrev:function(){return"Drag"},_render:function(){var a=this,b=this.options;this.set(b),a.cursor="move",a.handler.css("cursor",a.cursor),a.handler.bind("mousedown.drag",function(c){b.disabled||2!=c.button&&a._start.call(a,c)}).bind("mousemove.drag",function(){b.disabled||a.handler.css("cursor",a.cursor)})},_rendered:function(){this.options.target.ligeruidragid=this.id},_start:function(c){var d=this,e=this.options;if(!d.reverting&&!e.disabled){if(d.current={target:d.target,left:d.target.offset().left,top:d.target.offset().top,startX:c.pageX||c.screenX,startY:c.pageY||c.clientY},0==d.trigger("startDrag",[d.current,c]))return!1;if(d.cursor="move",d._createProxy(e.proxy,c),e.proxy&&!d.proxy)return!1;(d.proxy||d.handler).css("cursor",d.cursor),a(document).bind("selectstart.drag",function(){return!1}),a(document).bind("mousemove.drag",function(){d._drag.apply(d,arguments)}),b.draggable.dragging=!0,a(document).bind("mouseup.drag",function(){b.draggable.dragging=!1,d._stop.apply(d,arguments)})}},_drag:function(b){var c,d,e=this;this.options,e.current&&(c=b.pageX||b.screenX,d=b.pageY||b.screenY,e.current.diffX=c-e.current.startX,e.current.diffY=d-e.current.startY,(e.proxy||e.handler).css("cursor",e.cursor),e.receive&&e.receive.each(function(f,g){var h=a(g),i=h.offset();c>i.left&&c<i.left+h.width()&&d>i.top&&d<i.top+h.height()?e.receiveEntered[f]?e.trigger("dragOver",[g,e.proxy||e.target,b]):(e.receiveEntered[f]=!0,e.trigger("dragEnter",[g,e.proxy||e.target,b])):e.receiveEntered[f]&&(e.receiveEntered[f]=!1,e.trigger("dragLeave",[g,e.proxy||e.target,b]))}),e.hasBind("drag")?0!=e.trigger("drag",[e.current,b])?e._applyDrag():e._removeProxy():e._applyDrag())},_stop:function(b){var c=this,d=this.options;a(document).unbind("mousemove.drag"),a(document).unbind("mouseup.drag"),a(document).unbind("selectstart.drag"),c.receive&&c.receive.each(function(a,d){c.receiveEntered[a]&&c.trigger("drop",[d,c.proxy||c.target,b])}),c.proxy&&(d.revert?c.hasBind("revert")?0!=c.trigger("revert",[c.current,b])?c._revert(b):c._removeProxy():c._revert(b):(c._applyDrag(c.target),c._removeProxy())),c.cursor="move",c.trigger("stopDrag",[c.current,b]),c.current=null,c.handler.css("cursor",c.cursor)},_revert:function(a){var b=this;b.reverting=!0,b.proxy.animate({left:b.current.left,top:b.current.top},function(){b.reverting=!1,b._removeProxy(),b.trigger("endRevert",[b.current,a]),b.current=null})},_applyDrag:function(a){var b,c,d,e=this,f=this.options;a=a||e.proxy||e.target,b={},c=!1,d=a==e.target,e.current.diffX&&(b.left=d||null==f.proxyX?e.current.left+e.current.diffX:e.current.startX+f.proxyX+e.current.diffX,c=!0),e.current.diffY&&(b.top=d||null==f.proxyY?e.current.top+e.current.diffY:e.current.startY+f.proxyY+e.current.diffY,c=!0),a==e.target&&e.proxy&&f.animate?(e.reverting=!0,a.animate(b,function(){e.reverting=!1})):a.css(b)},_setReceive:function(b){this.receiveEntered={},b&&(this.receive="string"==typeof b?a(b):b)},_setHandler:function(b){var c=this,d=this.options;c.handler=b?"string"==typeof b?a(b,d.target):b:a(d.target)},_setTarget:function(b){this.target=a(b)},_setCursor:function(a){this.cursor=a,(this.proxy||this.handler).css("cursor",a)},_createProxy:function(b,c){if(b){var d=this,e=this.options;"function"==typeof b?d.proxy=b.call(this.options.target,d,c):"clone"==b?(d.proxy=d.target.clone().css("position","absolute"),d.proxy.appendTo("body")):(d.proxy=a("<div class='l-draggable'></div>"),d.proxy.width(d.target.width()).height(d.target.height()),d.proxy.attr("dragid",d.id).appendTo("body")),d.proxy.css({left:null==e.proxyX?d.current.left:d.current.startX+e.proxyX,top:null==e.proxyY?d.current.top:d.current.startY+e.proxyY}).show()}},_removeProxy:function(){var a=this;a.proxy&&(a.proxy.remove(),a.proxy=null)}})}(jQuery),function(a){a.fn.ligerEasyTab=function(){return a.ligerui.run.call(this,"ligerEasyTab",arguments)},a.fn.ligerGetEasyTabManager=function(){return a.ligerui.run.call(this,"ligerGetEasyTabManager",arguments)},a.ligerDefaults.EasyTab={},a.ligerMethos.EasyTab={},a.ligerui.controls.EasyTab=function(b,c){a.ligerui.controls.EasyTab.base.constructor.call(this,b,c)},a.ligerui.controls.EasyTab.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"EasyTab"},__idPrev:function(){return"EasyTab"},_extendMethods:function(){return a.ligerMethos.EasyTab},_render:function(){var b,c=this,d=this.options;c.tabs=a(this.element),c.tabs.addClass("l-easytab"),b=0,a("> div[lselected=true]",c.tabs).length>0&&(b=a("> div",c.tabs).index(a("> div[lselected=true]",c.tabs))),c.tabs.ul=a('<ul class="l-easytab-header"></ul>'),a("> div",c.tabs).each(function(d,e){var f=a("<li><span></span></li>");d==b&&a("span",f).addClass("l-selected"),a(e).attr("title")&&a("span",f).html(a(e).attr("title")),c.tabs.ul.append(f),a(e).hasClass("l-easytab-panelbox")||a(e).addClass("l-easytab-panelbox")}),c.tabs.ul.prependTo(c.tabs),a(".l-easytab-panelbox:eq("+b+")",c.tabs).show().siblings(".l-easytab-panelbox").hide(),a("> ul:first span",c.tabs).click(function(){if(!a(this).hasClass("l-selected")){var b=a("> ul:first span",c.tabs).index(this);a(this).addClass("l-selected").parent().siblings().find("span.l-selected").removeClass("l-selected"),a(".l-easytab-panelbox:eq("+b+")",c.tabs).show().siblings(".l-easytab-panelbox").hide()}}).not("l-selected").hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),c.set(d)}})}(jQuery),function(a){a.fn.ligerFilter=function(){return a.ligerui.run.call(this,"ligerFilter",arguments)},a.fn.ligerGetFilterManager=function(){return a.ligerui.run.call(this,"ligerGetFilterManager",arguments)},a.ligerDefaults.Filter={fields:[],operators:{},editors:{}},a.ligerDefaults.FilterString={strings:{and:"并且",or:"或者",equal:"相等",notequal:"不相等",startwith:"以..开始",endwith:"以..结束",like:"相似",greater:"大于",greaterorequal:"大于或等于",less:"小于",lessorequal:"小于或等于","in":"包括在...",notin:"不包括...",addgroup:"增加分组",addrule:"增加条件",deletegroup:"删除分组"}},a.ligerDefaults.Filter.operators.string=a.ligerDefaults.Filter.operators.text=["equal","notequal","startwith","endwith","like","greater","greaterorequal","less","lessorequal","in","notin"],a.ligerDefaults.Filter.operators.number=a.ligerDefaults.Filter.operators["int"]=a.ligerDefaults.Filter.operators["float"]=a.ligerDefaults.Filter.operators.date=["equal","notequal","greater","greaterorequal","less","lessorequal","in","notin"],a.ligerDefaults.Filter.editors.string={create:function(b,c){var d=a("<input type='text'/>");return b.append(d),d.ligerTextBox(c.editor.options||{}),d},setValue:function(a,b){a.val(b)},getValue:function(a){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}},a.ligerDefaults.Filter.editors.date={create:function(b,c){var d=a("<input type='text'/>");return b.append(d),d.ligerDateEditor(c.editor.options||{}),d},setValue:function(a,b){a.liger("option","value",b)},getValue:function(a){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}},a.ligerDefaults.Filter.editors.number={create:function(b,c){var d,e=a("<input type='text'/>");return b.append(e),d={minValue:c.editor.minValue,maxValue:c.editor.maxValue},e.ligerSpinner(a.extend(d,c.editor.options||{})),e},setValue:function(a,b){a.val(b)},getValue:function(a,b){var c="int"==b.editor.type;return c?parseInt(a.val(),10):parseFloat(a.val())},destroy:function(a){a.liger("destroy")}},a.ligerDefaults.Filter.editors.combobox={create:function(b,c){var d,e=a("<input type='text'/>");return b.append(e),d={data:c.data,slide:!1,valueField:c.editor.valueField||c.editor.valueColumnName,textField:c.editor.textField||c.editor.displayColumnName},a.extend(d,c.editor.options||{}),e.ligerComboBox(d),e},setValue:function(a,b){a.liger("option","value",b)},getValue:function(a){return a.liger("option","value")},destroy:function(a){a.liger("destroy")}},a.ligerui.controls.Filter=function(b,c){a.ligerui.controls.Filter.base.constructor.call(this,b,c)},a.ligerui.controls.Filter.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Filter"},__idPrev:function(){return"Filter"},_init:function(){a.ligerui.controls.Filter.base._init.call(this)},_render:function(){var b=this,c=this.options;b.set(c),a("#"+b.id+" .addgroup").live("click",function(){var c=a(this).parent().parent().parent().parent();b.addGroup(c)}),a("#"+b.id+" .deletegroup").live("click",function(){var c=a(this).parent().parent().parent().parent();b.deleteGroup(c)}),a("#"+b.id+" .addrule").live("click",function(){var c=a(this).parent().parent().parent().parent();b.addRule(c)}),a("#"+b.id+" .deleterole").live("click",function(){var c=a(this).parent().parent();b.deleteRule(c)})},_setFields:function(){var b=this;this.options,b.group&&b.group.remove(),b.group=a(b._bulidGroupTableHtml()).appendTo(b.element)},editors:{},editorCounter:0,addGroup:function(b){var c,d,e,f,g=this;return this.options,b=a(b||g.group),c=a(">tbody:first > tr:last",b),d=[],d.push('<tr class="l-filter-rowgroup"><td class="l-filter-cellgroup" colSpan="4">'),e=!b.hasClass("l-filter-group-alt"),d.push(g._bulidGroupTableHtml(e,!0)),d.push("</td></tr>"),f=a(d.join("")),c.before(f),f.find("table:first")},deleteGroup:function(b){var c=this;this.options,a("td.l-filter-value",b).each(function(){var b=a(this).parent();a("select.fieldsel",b).unbind(),c.removeEditor(b)}),a(b).parent().parent().remove()},removeEditor:function(b){var c=this,d=this.options,e=a(b).attr("editortype"),f=a(b).attr("editorid"),g=c.editors[f];g&&d.editors[e].destroy(g),a("td.l-filter-value:first",b).html("")},setData:function(b,c){var d,e=this,f=this.options;c=c||e.group,d=a(">tbody:first > tr:last",c),c.find(">tbody:first > tr").not(d).remove(),a("select:first",d).val(b.op),b.rules&&a(b.rules).each(function(){var b,d,g=e.addRule(c);g.attr("fieldtype",this.type||"string"),a("select.opsel",g).val(this.op),a("select.fieldsel",g).val(this.field).trigger("change"),b=g.attr("editorid"),b&&e.editors[b]?(d=e.getField(this.field),f.editors[d.editor.type].setValue(e.editors[b],this.value,d)):a(":text",g).val(this.value)}),b.groups&&a(b.groups).each(function(){var a=e.addGroup(c);e.setData(this,a)})},addRule:function(b){var c,d,e=this,f=this.options;return b=b||e.group,c=a(">tbody:first > tr:last",b),d=a(e._bulidRuleRowHtml()),c.before(d),f.fields.length&&e.appendEditor(d,f.fields[0]),a("select.fieldsel",d).bind("change",function(){var b,c,f=a(this).parent().next().find("select:first"),g=a(this).val(),h=e.getField(g),i=h.type||"string",j=d.attr("fieldtype");i!=j&&(f.html(e._bulidOpSelectOptionsHtml(i)),d.attr("fieldtype",i)),b=null,c=d.attr("editortype"),e.enabledEditor(h)&&(b=h.editor.type),c&&e.removeEditor(d),b?e.appendEditor(d,h):(d.removeAttr("editortype").removeAttr("editorid"),a("td.l-filter-value:first",d).html('<input type="text" class="valtxt" />'))}),d},deleteRule:function(b){a("select.fieldsel",b).unbind(),this.removeEditor(b),a(b).remove()},appendEditor:function(b,c){var d,e,f=this,g=this.options;f.enabledEditor(c)&&(d=a("td.l-filter-value:first",b).html(""),e=g.editors[c.editor.type],f.editors[++f.editorCounter]=e.create(d,c),b.attr("editortype",c.editor.type).attr("editorid",f.editorCounter))},getData:function(b){var c,d=this;return this.options,b=b||d.group,c={},a("> tbody > tr",b).each(function(b,e){var f,g,h,i,j,k,l=a(e).hasClass("l-filter-rowlast"),m=a(e).hasClass("l-filter-rowgroup");m?(f=a("> td:first > table:first",e),f.length&&(c.groups||(c.groups=[]),c.groups.push(d.getData(f)))):l?c.op=a(".groupopsel:first",e).val():(g=a("select.fieldsel:first",e).val(),h=d.getField(g),i=a(".opsel:first",e).val(),j=d._getRuleValue(e,h),k=a(e).attr("fieldtype")||"string",c.rules||(c.rules=[]),c.rules.push({field:g,op:i,value:j,type:k}))}),c},_getRuleValue:function(b,c){var d=this,e=this.options,f=a(b).attr("editorid"),g=a(b).attr("editortype"),h=d.editors[f];return h?e.editors[g].getValue(h,c):a(".valtxt:first",b).val()},enabledEditor:function(a){var b=this.options;return a.editor&&a.editor.type?a.editor.type in b.editors:!1},getField:function(a){var b,c,d,e=this.options;for(b=0,c=e.fields.length;c>b;b++)if(d=e.fields[b],d.name==a)return d;return null},_bulidGroupTableHtml:function(a,b){var c=this.options,d=[];return d.push('<table cellpadding="0" cellspacing="0" border="0" class="l-filter-group'),a&&d.push(" l-filter-group-alt"),d.push('"><tbody>'),d.push('<tr class="l-filter-rowlast"><td class="l-filter-rowlastcell" align="right" colSpan="4">'),d.push('<select class="groupopsel">'),d.push('<option value="and">'+c.strings.and+"</option>"),d.push('<option value="or">'+c.strings.or+"</option>"),d.push("</select>"),d.push('<input type="button" value="'+c.strings.addgroup+'" class="addgroup">'),d.push('<input type="button" value="'+c.strings.addrule+'" class="addrule">'),b&&d.push('<input type="button" value="'+c.strings.deletegroup+'" class="deletegroup">'),d.push("</td></tr>"),d.push("</tbody></table>"),d.join("")},_bulidRuleRowHtml:function(a){var b,c,d,e,f,g=this,h=this.options;for(a=a||h.fields,b=[],c=a[0].type||"string",b.push('<tr fieldtype="'+c+'"><td class="l-filter-column">'),b.push('<select class="fieldsel">'),d=0,e=a.length;e>d;d++)f=a[d],b.push('<option value="'+f.name+'"'),0==d&&b.push(" selected "),b.push(">"),b.push(f.display),b.push("</option>");return b.push("</select>"),b.push("</td>"),b.push('<td class="l-filter-op">'),b.push('<select class="opsel">'),b.push(g._bulidOpSelectOptionsHtml(c)),b.push("</select>"),b.push("</td>"),b.push('<td class="l-filter-value">'),b.push('<input type="text" class="valtxt" />'),b.push("</td>"),b.push("<td>"),b.push('<div class="l-icon-cross deleterole"></div>'),b.push("</td>"),b.push("</tr>"),b.join("")},_bulidOpSelectOptionsHtml:function(a){var b,c,d,e=this.options,f=e.operators[a],g=[];for(b=0,c=f.length;c>b;b++)d=f[b],g[g.length]='<option value="'+d+'">',g[g.length]=e.strings[d],g[g.length]="</option>";return g.join("")}})}(jQuery),function(a){a.fn.ligerForm=function(){return a.ligerui.run.call(this,"ligerForm",arguments)},a.ligerDefaults=a.ligerDefaults||{},a.ligerDefaults.Form={inputWidth:180,labelWidth:90,space:40,rightToken:"：",labelAlign:"left",align:"left",fields:[],appendID:!0,prefixID:"",toJSON:a.ligerui.toJSON},a.ligerDefaults.Form.editorBulider=function(a){var b,c=this.options,d={};if(c.inputWidth&&(d.width=c.inputWidth),a.is("select"))a.ligerComboBox(d);else if(a.is(":text")||a.is(":password"))switch(b=a.attr("ltype")){case"select":case"combobox":a.ligerComboBox(d);break;case"spinner":a.ligerSpinner(d);break;case"date":a.ligerDateEditor(d);break;case"float":case"number":d.number=!0,a.ligerTextBox(d);break;case"int":case"digits":d.digits=!0;default:a.ligerTextBox(d)}else a.is(":radio")?a.ligerRadio(d):a.is(":checkbox")?a.ligerCheckBox(d):a.is("textarea")&&a.addClass("l-textarea")},a.ligerui.controls.Form=function(b,c){a.ligerui.controls.Form.base.constructor.call(this,b,c)},a.ligerui.controls.Form.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Form"},__idPrev:function(){return"Form"},_init:function(){a.ligerui.controls.Form.base._init.call(this)},_render:function(){var b,c,d=this,e=this.options,f=a(this.element);e.fields&&e.fields.length&&(f.hasClass("l-form")||f.addClass("l-form"),b=[],c=!1,a(e.fields).each(function(a,e){var f,g=e.name||e.id;if(g){if("hidden"==e.type)return b.push('<input type="hidden" id="'+g+'" name="'+g+'" />'),void 0;f=e.renderToNewLine||e.newline,null==f&&(f=!0),e.merge&&(f=!1),e.group&&(f=!0),f&&(c&&(b.push("</ul>"),c=!1),e.group&&(b.push('<div class="l-group'),e.groupicon&&b.push(" l-group-hasicon"),b.push('">'),e.groupicon&&b.push('<img src="'+e.groupicon+'" />'),b.push("<span>"+e.group+"</span></div>")),b.push("<ul>"),c=!0),b.push(d._buliderLabelContainer(e)),b.push(d._buliderControlContainer(e)),b.push(d._buliderSpaceContainer(e))}}),c&&(b.push("</ul>"),c=!1),f.append(b.join(""))),a("input,select,textarea",f).each(function(){e.editorBulider.call(d,a(this))})},_buliderLabelContainer:function(a){var b,c=this.options,d=a.label||a.display,e=a.labelWidth||a.labelwidth||c.labelWidth,f=a.labelAlign||c.labelAlign;return d&&(d+=c.rightToken),b=[],b.push('<li style="'),e&&b.push("width:"+e+"px;"),f&&b.push("text-align:"+f+";"),b.push('">'),d&&b.push(d),b.push("</li>"),b.join("")},_buliderControlContainer:function(a){var b=this,c=this.options,d=a.width||c.inputWidth,e=a.align||a.textAlign||a.textalign||c.align,f=[];return f.push('<li style="'),d&&f.push("width:"+d+"px;"),e&&f.push("text-align:"+e+";"),f.push('">'),f.push(b._buliderControl(a)),f.push("</li>"),f.join("")},_buliderSpaceContainer:function(a){var b=this.options,c=a.space||a.spaceWidth||b.space,d=[];return d.push('<li style="'),c&&d.push("width:"+c+"px;"),d.push('">'),d.push("</li>"),d.join("")},_buliderControl:function(b){var c,d,e=this.options,f=b.width||e.inputWidth,g=b.name||b.id,h=[];if(b.comboboxName&&"select"==b.type&&h.push('<input type="hidden" id="'+e.prefixID+g+'" name="'+g+'" />'),b.textarea||"textarea"==b.type?h.push("<textarea "):"checkbox"==b.type?h.push('<input type="checkbox" '):"radio"==b.type?h.push('<input type="radio" '):"password"==b.type?h.push('<input type="password" '):h.push('<input type="text" '),b.cssClass&&h.push('class="'+b.cssClass+'" '),b.type&&h.push('ltype="'+b.type+'" '),b.attr)for(c in b.attr)h.push(c+'="'+b.attr[c]+'" ');return b.comboboxName&&"select"==b.type?(h.push('name="'+b.comboboxName+'"'),e.appendID&&h.push(' id="'+e.prefixID+b.comboboxName+'" ')):(h.push('name="'+g+'"'),e.appendID&&h.push(' id="'+g+'" ')),d=a.extend({width:f-2},b.options||{}),h.push(" ligerui='"+e.toJSON(d)+"' "),b.validate&&h.push(" validate='"+e.toJSON(b.validate)+"' "),h.push(" />"),h.join("")}})}(jQuery),function($){var l=$.ligerui;$.fn.ligerGrid=function(){return $.ligerui.run.call(this,"ligerGrid",arguments)},$.fn.ligerGetGridManager=function(){return $.ligerui.run.call(this,"ligerGetGridManager",arguments)},$.ligerDefaults.Grid={title:null,width:"auto",height:"auto",columnWidth:null,resizable:!0,url:!1,usePager:!0,page:1,pageSize:10,pageSizeOptions:[10,20,30,40,50],parms:[],columns:[],minColToggle:1,dataType:"server",dataAction:"server",showTableToggleBtn:!1,switchPageSizeApplyComboBox:!1,allowAdjustColWidth:!0,checkbox:!1,allowHideColumn:!0,enabledEdit:!1,isScroll:!0,onDragCol:null,onToggleCol:null,onChangeSort:null,onSuccess:null,onDblClickRow:null,onSelectRow:null,onUnSelectRow:null,onBeforeCheckRow:null,onCheckRow:null,onBeforeCheckAllRow:null,onCheckAllRow:null,onBeforeShowData:null,onAfterShowData:null,onError:null,onSubmit:null,dateFormat:"yyyy-MM-dd",InWindow:!0,statusName:"__status",method:"post",async:!0,fixedCellHeight:!0,heightDiff:0,cssClass:null,root:"Rows",record:"Total",pageParmName:"page",pagesizeParmName:"pagesize",sortnameParmName:"sortname",sortorderParmName:"sortorder",onReload:null,onToFirst:null,onToPrev:null,onToNext:null,onToLast:null,allowUnSelectRow:!1,alternatingRow:!0,mouseoverRowCssClass:"l-grid-row-over",enabledSort:!0,rowAttrRender:null,groupColumnName:null,groupColumnDisplay:"分组",groupRender:null,totalRender:null,delayLoad:!1,where:null,selectRowButtonOnly:!1,onAfterAddRow:null,onBeforeEdit:null,onBeforeSubmitEdit:null,onAfterEdit:null,onLoading:null,onLoaded:null,onContextmenu:null,whenRClickToSelect:!1,contentType:null,checkboxColWidth:27,detailColWidth:29,clickToEdit:!0,detailToEdit:!1,onEndEdit:null,minColumnWidth:80,tree:null,isChecked:null,frozen:!0,frozenDetail:!1,frozenCheckbox:!0,detailHeight:260,rownumbers:!1,frozenRownumbers:!0,rownumbersColWidth:26,colDraggable:!1,rowDraggable:!1,rowDraggingRender:null,autoCheckChildren:!0,onRowDragDrop:null,rowHeight:22,headerRowHeight:23,toolbar:null,headerImg:null},$.ligerDefaults.GridString={errorMessage:"发生错误",pageStatMessage:"显示从{from}到{to}，总 {total} 条 。每页显示：{pagesize}",pageTextMessage:"Page",loadingMessage:"加载中...",findTextMessage:"查找",noRecordMessage:"没有符合条件的记录存在",isContinueByDataChanged:"数据已经改变,如果继续将丢失数据,是否继续?",cancelMessage:"取消",saveMessage:"保存",applyMessage:"应用",draggingMessage:"{count}行"},$.ligerMethos.Grid=$.ligerMethos.Grid||{},$.ligerDefaults.Grid.sorters=$.ligerDefaults.Grid.sorters||{},$.ligerDefaults.Grid.formatters=$.ligerDefaults.Grid.formatters||{},$.ligerDefaults.Grid.editors=$.ligerDefaults.Grid.editors||{},$.ligerDefaults.Grid.sorters.date=function(a,b){return b>a?-1:a>b?1:0},$.ligerDefaults.Grid.sorters["int"]=function(a,b){return parseInt(a)<parseInt(b)?-1:parseInt(a)>parseInt(b)?1:0},$.ligerDefaults.Grid.sorters["float"]=function(a,b){return parseFloat(a)<parseFloat(b)?-1:parseFloat(a)>parseFloat(b)?1:0},$.ligerDefaults.Grid.sorters.string=function(a,b){return a.localeCompare(b)},$.ligerDefaults.Grid.formatters.date=function(value,column){function getFormatDate(a,b){var c,d,e;if(this.options,isNaN(a))return null;c=b,d={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()},/(y+)/.test(c)&&(c=c.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(e in d)new RegExp("("+e+")").test(c)&&(c=c.replace(RegExp.$1,1==RegExp.$1.length?d[e]:("00"+d[e]).substr((""+d[e]).length)));return c}if(!value)return"";if("string"==typeof value&&/^\/Date/.test(value)&&(value=value.replace(/^\//,"new ").replace(/\/$/,""),eval("value = "+value)),value instanceof Date){var format=column.format||this.options.dateFormat||"yyyy-MM-dd";return getFormatDate(value,format)}return value.toString()},$.ligerDefaults.Grid.editors.date={create:function(a,b){var c,d,e,f=b.column,g=$("<input type='text'/>");return a.append(g),c={},d=f.editor.p||f.editor.ext,d&&(e="function"==typeof d?d(b.record,b.rowindex,b.value,f):d,$.extend(c,e)),g.ligerDateEditor(c),g},getValue:function(a){return a.liger("option","value")},setValue:function(a,b){a.liger("option","value",b)},resize:function(a,b,c){a.liger("option","width",b),a.liger("option","height",c)},destroy:function(a){a.liger("destroy")}},$.ligerDefaults.Grid.editors.select=$.ligerDefaults.Grid.editors.combobox={create:function(a,b){var c,d,e,f=b.column,g=$("<input type='text'/>");return a.append(g),c={data:f.editor.data,slide:!1,valueField:f.editor.valueField||f.editor.valueColumnName,textField:f.editor.textField||f.editor.displayColumnName},d=f.editor.p||f.editor.ext,d&&(e="function"==typeof d?d(b.record,b.rowindex,b.value,f):d,$.extend(c,e)),g.ligerComboBox(c),g},getValue:function(a){return a.liger("option","value")},setValue:function(a,b){a.liger("option","value",b)},resize:function(a,b,c){a.liger("option","width",b),a.liger("option","height",c)},destroy:function(a){a.liger("destroy")}},$.ligerDefaults.Grid.editors["int"]=$.ligerDefaults.Grid.editors["float"]=$.ligerDefaults.Grid.editors.spinner={create:function(a,b){var c,d=b.column,e=$("<input type='text'/>");return a.append(e),e.css({border:"#6E90BE"}),c={type:"float"==d.editor.type?"float":"int"},void 0!=d.editor.minValue&&(c.minValue=d.editor.minValue),void 0!=d.editor.maxValue&&(c.maxValue=d.editor.maxValue),e.ligerSpinner(c),e},getValue:function(a,b){var c=b.column,d="int"==c.editor.type;return d?parseInt(a.val(),10):parseFloat(a.val())},setValue:function(a,b){a.val(b)},resize:function(a,b,c){a.liger("option","width",b),a.liger("option","height",c)},destroy:function(a){a.liger("destroy")}},$.ligerDefaults.Grid.editors.string=$.ligerDefaults.Grid.editors.text={create:function(a){var b=$("<input type='text' class='l-text-editing'/>");return a.append(b),b.ligerTextBox(),b},getValue:function(a){return a.val()},setValue:function(a,b){a.val(b)},resize:function(a,b,c){a.liger("option","width",b),a.liger("option","height",c)},destroy:function(a){a.liger("destroy")}},$.ligerDefaults.Grid.editors.chk=$.ligerDefaults.Grid.editors.checkbox={create:function(a){var b=$("<input type='checkbox' />");return a.append(b),b.ligerCheckBox(),b},getValue:function(a){return a[0].checked?1:0},setValue:function(a,b){a.val(b?!0:!1)},resize:function(a,b,c){a.liger("option","width",b),a.liger("option","height",c)},destroy:function(a){a.liger("destroy")}},$.ligerui.controls.Grid=function(a,b){$.ligerui.controls.Grid.base.constructor.call(this,a,b)},$.ligerui.controls.Grid.ligerExtend($.ligerui.core.UIComponent,{__getType:function(){return"$.ligerui.controls.Grid"},__idPrev:function(){return"grid"},_extendMethods:function(){return $.ligerMethos.Grid},_init:function(){$.ligerui.controls.Grid.base._init.call(this);var a=this,b=this.options;b.dataType=b.url?"server":"local","local"==b.dataType&&(b.data=b.data||[],b.dataAction="local"),0==b.isScroll&&(b.height="auto"),b.frozen||(b.frozenCheckbox=!1,b.frozenDetail=!1,b.frozenRownumbers=!1),b.detailToEdit&&(b.enabledEdit=!0,b.clickToEdit=!1,b.detail={height:"auto",onShowDetail:function(c,d){function e(){$(d).parent().parent().remove(),a.collapseDetail(c)}$(d).addClass("l-grid-detailpanel-edit"),a.beginEdit(c,function(){var a=$("<div class='l-editbox'></div>");return a.width(120).height(b.rowHeight+1),a.appendTo(d),a}),$("<div class='l-clear'></div>").appendTo(d),$("<div class='l-button'>"+b.saveMessage+"</div>").appendTo(d).click(function(){a.endEdit(c),e()}),$("<div class='l-button'>"+b.applyMessage+"</div>").appendTo(d).click(function(){a.submitEdit(c)}),$("<div class='l-button'>"+b.cancelMessage+"</div>").appendTo(d).click(function(){a.cancelEdit(c),e()})}}),b.tree&&(b.tree.childrenName=b.tree.childrenName||"children",b.tree.isParent=b.tree.isParent||function(a){var c=b.tree.childrenName in a;return c},b.tree.isExtend=b.tree.isExtend||function(a){return"isextend"in a&&0==a.isextend?!1:!0})},_render:function(){var a,b,c=this,d=this.options;c.grid=$(c.element),c.grid.addClass("l-panel"),a=[],a.push("        <div class='l-panel-header'><span class='l-panel-header-text'></span></div>"),a.push("                    <div class='l-grid-loading'></div>"),a.push("        <div class='l-panel-topbar'></div>"),a.push("        <div class='l-panel-bwarp'>"),a.push("            <div class='l-panel-body'>"),a.push("                <div class='l-grid'>"),a.push("                    <div class='l-grid-dragging-line'></div>"),a.push("                    <div class='l-grid-popup'><table cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),a.push("                  <div class='l-grid1'>"),a.push("                      <div class='l-grid-header l-grid-header1'>"),a.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),a.push("                      </div>"),a.push("                      <div class='l-grid-body l-grid-body1'>"),a.push("                      </div>"),a.push("                  </div>"),a.push("                  <div class='l-grid2'>"),a.push("                      <div class='l-grid-header l-grid-header2'>"),a.push("                          <div class='l-grid-header-inner'><table class='l-grid-header-table' cellpadding='0' cellspacing='0'><tbody></tbody></table></div>"),a.push("                      </div>"),a.push("                      <div class='l-grid-body l-grid-body2 l-scroll'>"),a.push("                      </div>"),a.push("                  </div>"),a.push("                 </div>"),a.push("              </div>"),a.push("         </div>"),a.push("         <div class='l-panel-bar'>"),a.push("            <div class='l-panel-bbar-inner'>"),a.push("                <div class='l-bar-group  l-bar-message'><span class='l-bar-text'></span></div>"),a.push("            <div class='l-bar-group l-bar-selectpagesize'></div>"),a.push("                <div class='l-bar-separator'></div>"),a.push("                <div class='l-bar-group'>"),a.push("                    <div class='l-bar-button l-bar-btnfirst'><span></span></div>"),a.push("                    <div class='l-bar-button l-bar-btnprev'><span></span></div>"),a.push("                </div>"),a.push("                <div class='l-bar-separator'></div>"),a.push("                <div class='l-bar-group'><span class='pcontrol'> <input type='text' size='4' value='1' style='width:20px' maxlength='3' /> / <span></span></span></div>"),a.push("                <div class='l-bar-separator'></div>"),a.push("                <div class='l-bar-group'>"),a.push("                     <div class='l-bar-button l-bar-btnnext'><span></span></div>"),a.push("                    <div class='l-bar-button l-bar-btnlast'><span></span></div>"),a.push("                </div>"),a.push("                <div class='l-bar-separator'></div>"),a.push("                <div class='l-bar-group'>"),a.push("                     <div class='l-bar-button l-bar-btnload'><span></span></div>"),a.push("                </div>"),a.push("                <div class='l-bar-separator'></div>"),a.push("                <div class='l-clear'></div>"),a.push("            </div>"),a.push("         </div>"),c.grid.html(a.join("")),c.header=$(".l-panel-header:first",c.grid),c.body=$(".l-panel-body:first",c.grid),c.toolbar=$(".l-panel-bar:first",c.grid),c.popup=$(".l-grid-popup:first",c.grid),c.gridloading=$(".l-grid-loading:first",c.grid),c.draggingline=$(".l-grid-dragging-line",c.grid),c.topbar=$(".l-panel-topbar:first",c.grid),c.gridview=$(".l-grid:first",c.grid),c.gridview.attr("id",c.id+"grid"),c.gridview1=$(".l-grid1:first",c.gridview),c.gridview2=$(".l-grid2:first",c.gridview),c.gridheader=$(".l-grid-header:first",c.gridview2),c.gridbody=$(".l-grid-body:first",c.gridview2),c.f={},c.f.gridheader=$(".l-grid-header:first",c.gridview1),c.f.gridbody=$(".l-grid-body:first",c.gridview1),c.currentData=null,c.changedCells={},c.editors={},c.editor={editing:!1},"auto"==d.height&&c.bind("SysGridHeightChanged",function(){c.enabledFrozen()&&c.gridview.height(Math.max(c.gridview1.height(),c.gridview2.height()))
}),b=$.extend({},d),this._bulid(),this._setColumns(d.columns),delete b.columns,delete b.data,delete b.url,c.set(b),d.delayLoad||(d.url?c.set({url:d.url}):d.data&&c.set({data:d.data}))},_setFrozen:function(a){a?this.grid.addClass("l-frozen"):this.grid.removeClass("l-frozen")},_setCssClass:function(a){this.grid.addClass(a)},_setLoadingMessage:function(a){this.gridloading.html(a)},_setHeight:function(a){var b,c=this,d=this.options;return c.unbind("SysGridHeightChanged"),"auto"==a?(c.bind("SysGridHeightChanged",function(){c.enabledFrozen()&&c.gridview.height(Math.max(c.gridview1.height(),c.gridview2.height()))}),void 0):("string"==typeof a&&a.indexOf("%")>0&&(a=d.inWindow?.01*$(window).height()*parseFloat(a):.01*c.grid.parent().height()*parseFloat(a)),d.title&&(a-=24),d.usePager&&(a-=32),d.totalRender&&(a-=25),d.toolbar&&(a-=c.topbar.outerHeight()),b=d.headerRowHeight*(c._columnMaxLevel-1)+d.headerRowHeight-1,a-=b,a>0&&(c.gridbody.height(a),a>18&&c.f.gridbody.height(a-18),c.gridview.height(a+b)),void 0)},_updateFrozenWidth:function(){var a,b=this;this.options,b.enabledFrozen()&&(b.gridview1.width(b.f.gridtablewidth),a=b.gridview.width()-b.f.gridtablewidth,b.gridview2.css({left:b.f.gridtablewidth}),a>0&&b.gridview2.css({width:a}))},_setWidth:function(){var a=this;this.options,a.enabledFrozen()&&a._onResize()},_setUrl:function(a){this.options.url=a,a?(this.options.dataType="server",this.loadData(!0)):this.options.dataType="local"},_setData:function(){this.loadData(this.options.data)},loadData:function(a){var b,c,d,e,f=this,g=this.options;if(f.loading=!0,b=null,c=!0,"function"==typeof a?(b=a,c=!1):"boolean"==typeof a?c=a:"object"==typeof a&&a&&(c=!1,g.dataType="local",g.data=a),g.newPage||(g.newPage=1),"server"==g.dataAction&&(g.sortOrder||(g.sortOrder="asc")),d=[],g.parms)if(g.parms.length)$(g.parms).each(function(){d.push({name:this.name,value:this.value})});else if("object"==typeof g.parms)for(e in g.parms)d.push({name:e,value:g.parms[e]});"server"==g.dataAction&&(g.usePager&&(d.push({name:g.pageParmName,value:g.newPage}),d.push({name:g.pagesizeParmName,value:g.pageSize})),g.sortName&&(d.push({name:g.sortnameParmName,value:g.sortName}),d.push({name:g.sortorderParmName,value:g.sortOrder}))),$(".l-bar-btnload span",f.toolbar).addClass("l-disabled"),"local"==g.dataType?(f.filteredData=f.data=g.data,b&&(f.filteredData[g.root]=f._searchData(f.filteredData[g.root],b)),f.currentData=g.usePager?f._getCurrentPageData(f.filteredData):f.filteredData,f._showData()):"local"!=g.dataAction||c?f.loadServerData(d,b):f.data&&f.data[g.root]&&(f.filteredData=f.data,b&&(f.filteredData[g.root]=f._searchData(f.filteredData[g.root],b)),f.currentData=f._getCurrentPageData(f.filteredData),f._showData()),f.loading=!1},loadServerData:function(a,b){var c=this,d=this.options,e={type:d.method,url:d.url,data:a,async:d.async,dataType:"json",beforeSend:function(){c.hasBind("loading")?c.trigger("loading"):c.toggleLoading(!0)},success:function(a){return c.trigger("success",[a,c]),a&&a[d.root]&&a[d.root].length?(c.data=a,"server"==d.dataAction?c.currentData=c.data:(c.filteredData=c.data,b&&(c.filteredData[d.root]=c._searchData(c.filteredData[d.root],b)),c.currentData=d.usePager?c._getCurrentPageData(c.filteredData):c.filteredData),c._showData.ligerDefer(c,10,[c.currentData]),void 0):(c.currentData=c.data={},c.currentData[d.root]=c.data[d.root]=[],c.currentData[d.record]=c.data[d.record]=0,c._showData(),void 0)},complete:function(){c.trigger("complete",[c]),c.hasBind("loaded")?c.trigger("loaded",[c]):c.toggleLoading.ligerDefer(c,10,[!1])},error:function(a,b,e){c.currentData=c.data={},c.currentData[d.root]=c.data[d.root]=[],c.currentData[d.record]=c.data[d.record]=0,c.toggleLoading.ligerDefer(c,10,[!1]),$(".l-bar-btnload span",c.toolbar).removeClass("l-disabled"),c.trigger("error",[a,b,e])}};d.contentType&&(e.contentType=d.contentType),$.ajax(e)},toggleLoading:function(a){this.gridloading[a?"show":"hide"]()},_createEditor:function(a,b,c,d,e){var f=a.create(b,c);return a.setValue&&a.setValue(f,c.value,c),a.resize&&a.resize(f,d,e,c),f},beginEdit:function(a,b){var c,d,e,f,g,h,i,j,k,l,m=this,n=this.options;if(n.enabledEdit&&!n.clickToEdit&&(c=m.getRow(a),!c._editing&&0!=m.trigger("beginEdit",{record:c,rowindex:c.__index}))){for(m.editors[c.__id]={},c._editing=!0,m.reRender({rowdata:c}),b=b||function(a,b){var c=m.getCellObj(a,b),d=$(c).html("");return m.setCellEditing(a,b,!0),d},d=0,e=m.columns.length;e>d;d++)f=m.columns[d],f.name&&f.editor&&f.editor.type&&n.editors[f.editor.type]&&(g=n.editors[f.editor.type],h={record:c,value:c[f.name],column:f,rowindex:c.__index,grid:m},i=b(c,f),j=i.width(),k=i.height(),l=m._createEditor(g,i,h,j,k),m.editors[c.__id][f.__id]={editor:g,input:l,editParm:h,container:i});m.trigger("afterBeginEdit",{record:c,rowindex:c.__index})}},cancelEdit:function(a){var b,c,d,e,f=this;if(void 0==a)for(b in f.editors)f.cancelEdit(b);else{if(c=f.getRow(a),!f.editors[c.__id])return;if(0==f.trigger("cancelEdit",{record:c,rowindex:c.__index}))return;for(d in f.editors[c.__id])e=f.editors[c.__id][d],e.editor.destroy&&e.editor.destroy(e.input,e.editParm);delete f.editors[c.__id],delete c._editing,f.reRender({rowdata:c})}},addEditRow:function(a){this.submitEdit(),a=this.add(a),this.beginEdit(a)},submitEdit:function(a){var b,c,d,e,f,g,h=this;if(this.options,void 0==a)for(b in h.editors)h.submitEdit(b);else{if(c=h.getRow(a),d={},!h.editors[c.__id])return;for(e in h.editors[c.__id])f=h.editors[c.__id][e],g=f.editParm.column,g.name&&(d[g.name]=f.editor.getValue(f.input,f.editParm));if(0==h.trigger("beforeSubmitEdit",{record:c,rowindex:c.__index,newdata:d}))return!1;h.updateRow(c,d),h.trigger("afterSubmitEdit",{record:c,rowindex:c.__index,newdata:d})}},endEdit:function(a){var b,c,d,e,f=this;if(this.options,f.editor.editing)b=f.editor,f.trigger("sysEndEdit",[f.editor.editParm]),f.trigger("endEdit",[f.editor.editParm]),b.editor.destroy&&b.editor.destroy(b.input,b.editParm),f.editor.container.remove(),f.reRender({rowdata:f.editor.editParm.record,column:f.editor.editParm.column}),f.trigger("afterEdit",[f.editor.editParm]),f.editor={editing:!1};else if(void 0!=a){if(c=f.getRow(a),!f.editors[c.__id])return;if(0==f.submitEdit(a))return!1;for(d in f.editors[c.__id])b=f.editors[c.__id][d],b.editor.destroy&&b.editor.destroy(b.input,b.editParm);delete f.editors[c.__id],delete c._editing,f.trigger("afterEdit",{record:c,rowindex:c.__index})}else for(e in f.editors)f.endEdit(e)},setWidth:function(a){return this._setWidth(a)},setHeight:function(a){return this._setHeight(a)},enabledCheckbox:function(){return this.options.checkbox?!0:!1},enabledFrozen:function(){var a,b,c,d=this,e=this.options;if(!e.frozen)return!1;if(a=d.columns||[],d.enabledDetail()&&e.frozenDetail||d.enabledCheckbox()&&e.frozenCheckbox||e.frozenRownumbers&&e.rownumbers)return!0;for(b=0,c=a.length;c>b;b++)if(a[b].frozen)return!0;return this._setFrozen(!1),!1},enabledDetailEdit:function(){return this.enabledDetail()?this.options.detailToEdit?!0:!1:!1},enabledDetail:function(){return this.options.detail&&this.options.detail.onShowDetail?!0:!1},enabledGroup:function(){return this.options.groupColumnName?!0:!1},deleteSelectedRow:function(){var a,b;if(this.selected){for(a in this.selected)b=this.selected[a],b.__id in this.records&&this._deleteData.ligerDefer(this,10,[b]);this.reRender.ligerDefer(this,20)}},removeRange:function(a){var b=this;this.options,$.each(a,function(){b._removeData(this)}),b.reRender()},remove:function(a){var b=this;this.options,b.getRow(a),b._removeData(a),b.reRender()},deleteRange:function(a){var b=this;this.options,$.each(a,function(){b._deleteData(this)}),b.reRender()},deleteRow:function(a){var b,c=this;this.options,b=c.getRow(a),b&&(c._deleteData(b),c.reRender(),c.isDataChanged=!0)},_deleteData:function(a){var b,c,d,e=this,f=this.options,g=e.getRow(a);if(g[f.statusName]="delete",f.tree&&(b=e.getChildren(g,!0)))for(c=0,d=b.length;d>c;c++)b[c][f.statusName]="delete";e.deletedRows=e.deletedRows||[],e.deletedRows.push(g),e._removeSelected(g)},updateCell:function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=this.options;if("string"!=typeof a)"number"==typeof a?(d=l.columns[a],f=l.getRow(c),e=l.getCellObj(f,d)):"object"==typeof a&&a.__id?(d=a,f=l.getRow(c),e=l.getCellObj(f,d)):(e=a,i=e.id.split("|"),j=i[i.length-1],d=l._columns[j],k=$(e).parent(),f=f||l.getRow(k[0])),null!=b&&d.name&&(f[d.name]=b,"add"!=f[m.statusName]&&(f[m.statusName]="update"),l.isDataChanged=!0),l.reRender({rowdata:f,column:d});else for(g=0,h=l.columns.length;h>g;g++)l.columns[g].name==a&&l.updateCell(g,b,c)},addRows:function(a,b,c,d){var e=this;this.options,$(a).each(function(){e.addRow(this,b,c,d)})},_createRowid:function(){return"r"+(1e3+this.recordNumber)},_isRowId:function(a){return a in this.records},_addNewRecord:function(a,b,c){var d,e,f,g=this,h=this.options;return g.recordNumber++,a.__id=g._createRowid(),a.__previd=b,b&&-1!=b?(d=g.records[b],d.__nextid&&-1!=d.__nextid&&(e=g.records[d.__nextid],e&&(e.__previd=a.__id)),d.__nextid=a.__id,a.__index=d.__index+1):a.__index=0,h.tree&&(c&&-1!=c?(f=g.records[c],a.__pid=c,a.__level=f.__level+1):(a.__pid=-1,a.__level=1),a.__hasChildren=a[h.tree.childrenName]?!0:!1),"add"!=a[h.statusName]&&(a[h.statusName]="nochanged"),g.rows[a.__index]=a,g.records[a.__id]=a,a},_getRows:function(a){function b(a){var e,f,g;if(a&&a.length)for(e=0,f=a.length;f>e;e++)g=a[e],d.push(g),g[c.tree.childrenName]&&b(g[c.tree.childrenName])}var c=this.options,d=[];return b(a),d},_updateGridData:function(){function a(e,f){var g,h,i;if(e&&e.length)for(g=0,h=e.length;h>g;g++)i=e[g],c.formatRecord(i),"delete"!=i[d.statusName]&&(c._addNewRecord(i,b,f),b=i.__id,i.__hasChildren&&a(i[d.tree.childrenName],i.__id))}var b,c=this,d=this.options;return c.recordNumber=0,c.rows=[],c.records={},b=-1,a(c.currentData[d.root],-1),c.rows},_moveData:function(a,b,c){var d,e,f,g,h,i=this;this.options,d=i.getRow(a),e=i.getRow(b),h=i._getParentChildren(d),f=$.inArray(d,h),h.splice(f,1),h=i._getParentChildren(e),g=$.inArray(e,h),h.splice(g+(c?1:0),0,d)},move:function(a,b,c){this._moveData(a,b,c),this.reRender()},moveRange:function(a,b,c){for(var d in a)this._moveData(a[d],b,c);this.reRender()},up:function(a){var b,c,d,e,f=this;this.options,b=f.getRow(a),c=f._getParentChildren(b),d=$.inArray(b,c),-1!=d&&0!=d&&(e=f.getSelected(),f.move(b,c[d-1],!1),f.select(e))},down:function(a){var b,c,d,e,f=this;this.options,b=f.getRow(a),c=f._getParentChildren(b),d=$.inArray(b,c),-1!=d&&d!=c.length-1&&(e=f.getSelected(),f.move(b,c[d+1],!0),f.select(e))},addRow:function(a,b,c,d){var e,f,g,h=this,i=this.options;if(a=a||{},h._addData(a,d,b,c),h.reRender(),a[i.statusName]="add",i.tree&&(e=h.getChildren(a,!0)))for(f=0,g=e.length;g>f;f++)e[f][i.statusName]="add";return h.isDataChanged=!0,i.total=i.total?i.total+1:1,i.pageCount=Math.ceil(i.total/i.pageSize),h._buildPager(),h.trigger("SysGridHeightChanged"),h.trigger("afterAddRow",[a]),a},updateRow:function(a,b){var c=this,d=this.options,e=c.getRow(a);return c.isDataChanged=!0,$.extend(e,b||{}),"add"!=e[d.statusName]&&(e[d.statusName]="update"),c.reRender.ligerDefer(c,10,[{rowdata:e}]),e},setCellEditing:function(a,b,c){var d,e,f,g,h,i=this;if(this.options,d=i.getCellObj(a,b),e=c?"addClass":"removeClass",$(d)[e]("l-grid-row-cell-editing"),0!=a.__id){if(f=$(i.getRowObj(a.__id)).prev(),!f.length)return;if(g=i.getRow(f[0]),h=i.getCellObj(g,b),!h)return;$(h)[e]("l-grid-row-cell-editing-topcell")}-1!=b.__previd&&null!=b.__previd&&(h=$(i.getCellObj(a,b)).prev(),$(h)[e]("l-grid-row-cell-editing-leftcell"))},reRender:function(a){var b,c,d,e,f,g,h=this,i=this.options;if(a=a||{},b=a.rowdata,c=a.column,!(c&&(c.isdetail||c.ischeckbox)||b&&"delete"==b[i.statusName]))if(b&&c)d=h.getCellObj(b,c),$(d).html(h._getCellHtml(b,c)),c.issystem||h.setCellEditing(b,c,!1);else if(b)$(h.columns).each(function(){h.reRender({rowdata:b,column:this})});else if(c){for(e in h.records)h.reRender({rowdata:h.records[e],column:c});for(f=0;f<h.totalNumber;f++)g=document.getElementById(h.id+"|total"+f+"|"+c.__id),$("div:first",g).html(h._getTotalCellContent(c,h.groups&&h.groups[f]?h.groups[f]:h.currentData[i.root]))}else h._showData()},getData:function(a,b){var c,d,e=this,f=this.options,g=[];for(c in e.records)d=$.extend(!0,{},e.records[c]),(d[f.statusName]==a||void 0==a)&&g.push(e.formatRecord(d,b));return g},formatRecord:function(a,b){return delete a.__id,delete a.__previd,delete a.__nextid,delete a.__index,this.options.tree&&(delete a.__pid,delete a.__level,delete a.__hasChildren),b&&delete a[this.options.statusName],a},getUpdated:function(){return this.getData("update",!0)},getDeleted:function(){return this.deletedRows},getAdded:function(){return this.getData("add",!0)},getColumn:function(a){var b,c,d=this;return this.options,"string"==typeof a?d._isColumnId(a)?d._columns[a]:d.columns[parseInt(a)]:"number"==typeof a?d.columns[a]:"object"==typeof a&&1==a.nodeType?(b=a.id.split("|"),c=b[b.length-1],d._columns[c]):a},getColumnType:function(a){var b=this;for(this.options,i=0;i<b.columns.length;i++)if(b.columns[i].name==a)return b.columns[i].type?b.columns[i].type:"string";return null},isTotalSummary:function(){var a,b=this;for(this.options,a=0;a<b.columns.length;a++)if(b.columns[a].totalSummary)return!0;return!1},getColumns:function(a){var b,c,d,e=this;this.options,b=[];for(c in e._columns)d=e._columns[c],void 0!=a?d.__level==a&&b.push(d):d.__leaf&&b.push(d);return b},changeSort:function(a,b){var c,d=this,e=this.options;return d.loading?!0:("local"==e.dataAction&&(c=d.getColumnType(a),d.sortedData||(d.sortedData=d.filteredData),e.sortName==a?d.sortedData[e.root].reverse():d.sortedData[e.root].sort(function(b,e){return d._compareData(b,e,a,c)}),d.currentData=e.usePager?d._getCurrentPageData(d.sortedData):d.sortedData,d._showData()),e.sortName=a,e.sortOrder=b,"server"==e.dataAction&&d.loadData(e.where),void 0)},changePage:function(a){var b,c=this,d=this.options;if(c.loading)return!0;if("local"!=d.dataAction&&c.isDataChanged&&!confirm(d.isContinueByDataChanged))return!1;switch(d.pageCount=parseInt($(".pcontrol span",c.toolbar).html()),a){case"first":if(1==d.page)return;d.newPage=1;break;case"prev":if(1==d.page)return;d.page>1&&(d.newPage=parseInt(d.page)-1);break;case"next":if(d.page>=d.pageCount)return;d.newPage=parseInt(d.page)+1;break;case"last":if(d.page>=d.pageCount)return;d.newPage=d.pageCount;break;case"input":b=parseInt($(".pcontrol input",c.toolbar).val()),isNaN(b)&&(b=1),1>b?b=1:b>d.pageCount&&(b=d.pageCount),$(".pcontrol input",c.toolbar).val(b),d.newPage=b}return d.newPage==d.page?!1:(1==d.newPage?($(".l-bar-btnfirst span",c.toolbar).addClass("l-disabled"),$(".l-bar-btnprev span",c.toolbar).addClass("l-disabled")):($(".l-bar-btnfirst span",c.toolbar).removeClass("l-disabled"),$(".l-bar-btnprev span",c.toolbar).removeClass("l-disabled")),d.newPage==d.pageCount?($(".l-bar-btnlast span",c.toolbar).addClass("l-disabled"),$(".l-bar-btnnext span",c.toolbar).addClass("l-disabled")):($(".l-bar-btnlast span",c.toolbar).removeClass("l-disabled"),$(".l-bar-btnnext span",c.toolbar).removeClass("l-disabled")),c.trigger("changePage",[d.newPage]),"server"==d.dataAction?c.loadData(d.where):(c.currentData=c._getCurrentPageData(c.filteredData),c._showData()),void 0)},getSelectedRow:function(){var a,b;for(a in this.selected)if(b=this.selected[a],b.__id in this.records)return b;return null},getSelectedRows:function(){var a,b,c=[];for(a in this.selected)b=this.selected[a],b.__id in this.records&&c.push(b);return c},getSelectedRowObj:function(){var a,b;for(a in this.selected)if(b=this.selected[a],b.__id in this.records)return this.getRowObj(b);return null},getSelectedRowObjs:function(){var a,b,c=[];for(a in this.selected)b=this.selected[a],b.__id in this.records&&c.push(this.getRowObj(b));return c},getCellObj:function(a,b){var c=this.getRow(a);return b=this.getColumn(b),document.getElementById(this._getCellDomId(c,b))},getRowObj:function(a,b){var c=this;return this.options,null==a?null:"string"==typeof a?c._isRowId(a)?document.getElementById(c.id+(b?"|1|":"|2|")+a):document.getElementById(c.id+(b?"|1|":"|2|")+c.rows[parseInt(a)].__id):"number"==typeof a?document.getElementById(c.id+(b?"|1|":"|2|")+c.rows[a].__id):"object"==typeof a&&a.__id?c.getRowObj(a.__id,b):a},getRow:function(a){var b=this;return this.options,null==a?null:"string"==typeof a?b._isRowId(a)?b.records[a]:b.rows[parseInt(a)]:"number"==typeof a?b.rows[parseInt(a)]:"object"!=typeof a||1!=a.nodeType||a.__id?a:b._getRowByDomId(a.id)},_setColumnVisible:function(a,b){var c,d,e,f=this;if(this.options,b){if(a._hide=!0,document.getElementById(a.__domid).style.display="none",-1!=a.__pid){for(d=!0,c=this._columns[a.__pid],e=0;c&&e<c.columns.length;e++)if(!c.columns[e]._hide){d=!1;break}d&&(c._hide=!0,document.getElementById(c.__domid).style.display="none",this._setColumnVisible(c,b))}}else a._hide=!1,document.getElementById(a.__domid).style.display="",-1!=a.__pid&&(c=f._columns[a.__pid],c._hide&&(document.getElementById(c.__domid).style.display="",this._setColumnVisible(c,b)))},toggleCol:function(a,b,c){var d,e,f,g,h,i,j,k,l=this;if(this.options,"number"==typeof a)d=l.columns[a];else if("object"==typeof a&&a.__id)d=a;else if("string"==typeof a){if(!l._isColumnId(a))return $(l.columns).each(function(){this.name==a&&l.toggleCol(this,b,c)}),void 0;d=l._columns[a]}if(d&&(e=d.__leafindex,f=document.getElementById(d.__domid))){f=$(f),g=[];for(h in l.rows)i=l.getCellObj(l.rows[h],d),i&&g.push(i);for(h=0;h<l.totalNumber;h++)j=document.getElementById(l.id+"|total"+h+"|"+d.__id),j&&g.push(j);k=d._width,b&&d._hide?(d.frozen?l.f.gridtablewidth+=parseInt(k)+1:l.gridtablewidth+=parseInt(k)+1,l._setColumnVisible(d,!1),$(g).show()):b||d._hide||(d.frozen?l.f.gridtablewidth-=parseInt(k)+1:l.gridtablewidth-=parseInt(k)+1,l._setColumnVisible(d,!0),$(g).hide()),d.frozen?($("div:first",l.f.gridheader).width(l.f.gridtablewidth),$("div:first",l.f.gridbody).width(l.f.gridtablewidth)):($("div:first",l.gridheader).width(l.gridtablewidth+40),$("div:first",l.gridbody).width(l.gridtablewidth)),l._updateFrozenWidth(),c||$(":checkbox[columnindex="+e+"]",l.popup).each(function(){if(this.checked=b,$.fn.ligerCheckBox){var a=$(this).ligerGetCheckBoxManager();a&&a.updateStyle()}})}},setColumnWidth:function(a,b){var c,d,e,f,g,h,i,j,k,l=this,m=this.options;if(b){if(b=parseInt(b,10),"number"==typeof a)c=l.columns[a];else if("object"==typeof a&&a.__id)c=a;else if("string"==typeof a){if(!l._isColumnId(a))return $(l.columns).each(function(){this.name==a&&l.setColumnWidth(this,b)}),void 0;c=l._columns[a]}if(c&&(d=m.minColumnWidth,c.minWidth&&(d=c.minWidth),b=d>b?d:b,e=b-c._width,0!=l.trigger("beforeChangeColumnWidth",[c,b]))){c._width=b,c.frozen?(l.f.gridtablewidth+=e,$("div:first",l.f.gridheader).width(l.f.gridtablewidth),$("div:first",l.f.gridbody).width(l.f.gridtablewidth)):(l.gridtablewidth+=e,$("div:first",l.gridheader).width(l.gridtablewidth+40),$("div:first",l.gridbody).width(l.gridtablewidth)),$(document.getElementById(c.__domid)).css("width",b),f=[];for(g in l.records)h=l.getCellObj(l.records[g],c),h&&f.push(h),!l.enabledDetailEdit()&&l.editors[g]&&l.editors[g][c.__id]&&(i=l.editors[g][c.__id],i.editor.resize&&i.editor.resize(i.input,b,i.container.height(),i.editParm));for(j=0;j<l.totalNumber;j++)k=document.getElementById(l.id+"|total"+j+"|"+c.__id),k&&f.push(k);$(f).css("width",b).find("> div.l-grid-row-cell-inner:first").css("width",b-8),l._updateFrozenWidth(),l.trigger("afterChangeColumnWidth",[c,b])}}},changeHeaderText:function(a,b){var c,d,e,f=this,g=this.options;if("number"==typeof a)c=f.columns[a];else if("object"==typeof a&&a.__id)c=a;else if("string"==typeof a){if(!f._isColumnId(a))return $(f.columns).each(function(){this.name==a&&f.changeHeaderText(this,b)}),void 0;c=f._columns[a]}c&&(d=c.__leafindex,e=document.getElementById(c.__domid),$(".l-grid-hd-cell-text",e).html(b),g.allowHideColumn&&$(":checkbox[columnindex="+d+"]",f.popup).parent().next().html(b))},changeCol:function(a,b,c){var d,e,f,g,h,i,j,k=this,l=this.options;a&&b&&(d=k.getColumn(a),e=k.getColumn(b),d.frozen=e.frozen,h=-1==d.__pid?l.columns:k._columns[d.__pid].columns,i=-1==e.__pid?l.columns:k._columns[e.__pid].columns,f=$.inArray(d,h),g=$.inArray(e,i),j=h==i,d.__level==e.__level,i.splice(g+(c?1:0),0,d),j?c?h.splice(f,1):h.splice(f+1,1):h.splice(f,1),k._setColumns(l.columns),k.reRender())},collapseDetail:function(a){var b,c,d,e,f,g=this;if(this.options,b=g.getRow(a))for(c=0,d=g.columns.length;d>c;c++)if(g.columns[c].isdetail)return e=g.getRowObj(b),f=g.getCellObj(b,g.columns[c]),$(e).next("tr.l-grid-detailpanel").hide(),$(".l-grid-row-cell-detailbtn:first",f).removeClass("l-open"),g.trigger("SysGridHeightChanged"),void 0},extendDetail:function(a){var b,c,d,e,f,g=this;if(this.options,b=g.getRow(a))for(c=0,d=g.columns;d>c;c++)if(g.columns[c].isdetail)return e=g.getRowObj(b),f=g.getCellObj(b,g.columns[c]),$(e).next("tr.l-grid-detailpanel").show(),$(".l-grid-row-cell-detailbtn:first",f).addClass("l-open"),g.trigger("SysGridHeightChanged"),void 0},getParent:function(a){var b,c=this,d=this.options;return d.tree?(b=c.getRow(a),b?b.__pid in c.records?c.records[b.__pid]:null:null):null},getChildren:function(a,b){function c(a){var d,f,h;if(a[g.tree.childrenName])for(d=0,f=a[g.tree.childrenName].length;f>d;d++)h=a[g.tree.childrenName][d],"delete"!=h.__status&&(e.push(h),b&&c(h))}var d,e,f=this,g=this.options;return g.tree?(d=f.getRow(a))?(e=[],c(d),e):null:null},isLeaf:function(a){var b,c=this;return this.options,(b=c.getRow(a))?b.__hasChildren?!1:!0:void 0},hasChildren:function(a){var b=this.options,c=this.getRow(a);return c?c[b.tree.childrenName]&&c[b.tree.childrenName].length?!0:!1:void 0},existRecord:function(a){for(var b in this.records)if(this.records[b]==a)return!0;return!1},_removeSelected:function(a){var b,c,d,e,f,g=this,h=this.options;if(h.tree&&(b=g.getChildren(a,!0)))for(c=0,d=b.length;d>c;c++)e=$.inArray(b[c],g.selected),-1!=e&&g.selected.splice(e,1);f=$.inArray(a,g.selected),-1!=f&&g.selected.splice(f,1)},_getParentChildren:function(a){var b,c=this,d=this.options,e=c.getRow(a);return b=d.tree&&c.existRecord(e)&&e.__pid in c.records?c.records[e.__pid][d.tree.childrenName]:c.currentData[d.root]},_removeData:function(a){var b,c,d=this;this.options,b=d._getParentChildren(a),c=$.inArray(a,b),-1!=c&&b.splice(c,1),d._removeSelected(a)},_addData:function(a,b,c,d){var e,f=this,g=this.options,h=f.currentData[g.root];c?(g.tree&&(b?h=b[g.tree.childrenName]:c.__pid in f.records&&(h=f.records[c.__pid][g.tree.childrenName])),e=$.inArray(c,h),h.splice(-1==e?-1:e+(d?0:1),0,a)):(g.tree&&b&&(h=b[g.tree.childrenName]),h.push(a))},_appendData:function(a,b,c,d){var e=this,f=this.options;a[f.statusName]="update",e._removeData(a),e._addData(a,b,c,d)},appendRange:function(a,b,c,d){var e,f=this;this.options,e=!1,$.each(a,function(a,g){g.__id&&f.existRecord(g)?(f.isLeaf(b)&&f.upgrade(b),f._appendData(g,b,c,d),e=!0):f.appendRow(g,b,c,d)}),e&&f.reRender()},appendRow:function(a,b,c,d){var e=this;return this.options,$.isArray(a)?(e.appendRange(a,b,c,d),void 0):a.__id&&e.existRecord(a)?(e._appendData(a,b,c,d),e.reRender(),void 0):(b&&e.isLeaf(b)&&e.upgrade(b),e.addRow(a,c,d?!0:!1,b),void 0)},upgrade:function(a){var b,c=this,d=this.options,e=c.getRow(a);e&&d.tree&&(e[d.tree.childrenName]=e[d.tree.childrenName]||[],e.__hasChildren=!0,b=[c.getRowObj(e)],c.enabledFrozen()&&b.push(c.getRowObj(e,!0)),$("> td > div > .l-grid-tree-space:last",b).addClass("l-grid-tree-link l-grid-tree-link-open"))},demotion:function(a){var b,c,d,e,f=this,g=this.options,h=f.getRow(a);if(h&&g.tree){if(b=[f.getRowObj(h)],f.enabledFrozen()&&b.push(f.getRowObj(h,!0)),$("> td > div > .l-grid-tree-space:last",b).removeClass("l-grid-tree-link l-grid-tree-link-open l-grid-tree-link-close"),f.hasChildren(h))for(c=f.getChildren(h),d=0,e=c.length;e>d;d++)f.deleteRow(c[d]);h.__hasChildren=!1}},collapse:function(a){var b,c,d=this;this.options,b=d.getRowObj(a),c=$(".l-grid-tree-link",b),c.hasClass("l-grid-tree-link-close")||d.toggle(a)},expand:function(a){var b,c,d=this;this.options,b=d.getRowObj(a),c=$(".l-grid-tree-link",b),c.hasClass("l-grid-tree-link-open")||d.toggle(a)},toggle:function(a){var b,c,d,e,f,g,h,i,j,k,l;if(a)for(b=this,this.options,c=b.getRow(a),d=[b.getRowObj(c)],b.enabledFrozen()&&d.push(b.getRowObj(c,!0)),c.__level,f=$(".l-grid-tree-link:first",d),g=!0,b.collapsedRows=b.collapsedRows||[],f.hasClass("l-grid-tree-link-close")?(f.removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open"),e=$.inArray(c,b.collapsedRows),-1!=e&&b.collapsedRows.splice(e,1)):(g=!1,f.addClass("l-grid-tree-link-close").removeClass("l-grid-tree-link-open"),e=$.inArray(c,b.collapsedRows),-1==e&&b.collapsedRows.push(c)),h=b.getChildren(c,!0),i=0,j=h.length;j>i;i++)k=h[i],l=$([b.getRowObj(k.__id)]),b.enabledFrozen()&&(l=l.add(b.getRowObj(k.__id,!0))),g?($(".l-grid-tree-link",l).removeClass("l-grid-tree-link-close").addClass("l-grid-tree-link-open"),l.show()):($(".l-grid-tree-link",l).removeClass("l-grid-tree-link-open").addClass("l-grid-tree-link-close"),l.hide())},_bulid:function(){var a=this;a._clearGrid(),a._initBuildHeader(),a._initHeight(),a._initFootbar(),a._buildPager(),a._setEvent()},_setColumns:function(){var a=this;a._initColumns(),a._initBuildGridHeader(),a._initBuildPopup()},_initBuildHeader:function(){var a=this,b=this.options;b.title?($(".l-panel-header-text",a.header).html(b.title),b.headerImg&&a.header.append("<img src='"+b.headerImg+"' />").addClass("l-panel-header-hasicon")):a.header.hide(),b.toolbar?$.fn.ligerToolBar&&(a.toolbarManager=a.topbar.ligerToolBar(b.toolbar)):a.topbar.remove()},_createColumnId:function(a){return null!=a.id?a.id.toString():"c"+(100+this._columnCount)},_isColumnId:function(a){return a in this._columns},_initColumns:function(){function a(a,b){for(var c in b)b[c]in a&&delete a[b[c]]}function b(c,d,e,f){var g,h,i,j,l;if(a(c,["__id","__pid","__previd","__nextid","__domid","__leaf","__leafindex","__level","__colSpan","__rowSpan"]),d>k._columnMaxLevel&&(k._columnMaxLevel=d),k._columnCount++,c.__id=k._createColumnId(c),c.__domid=k.id+"|hcell|"+c.__id,k._columns[c.__id]=c,c.columns&&c.columns.length||(c.__leafindex=k._columnLeafCount++),c.__level=d,c.__pid=e,c.__previd=f,!c.columns||!c.columns.length)return c.__leaf=!0,1;for(g=0,h=-1,i=0,j=c.columns.length;j>i;i++)l=c.columns[i],g+=b(l,d+1,c.__id,h),h=l.__id;return c.__leafcount=g,g}var c,d,e,f,g,h,i,j,k=this,l=this.options;if(k._columns={},k._columnCount=0,k._columnLeafCount=0,k._columnMaxLevel=1,l.columns){for(c=-1,l.rownumbers&&(d=k.enabledGroup()?!1:l.frozen&&l.frozenRownumbers,e={isrownumber:!0,issystem:!0,width:l.rownumbersColWidth,frozen:d},b(e,1,-1,c),c=e.__id),k.enabledDetail()&&(f=k.enabledGroup()?!1:l.frozen&&l.frozenDetail,e={isdetail:!0,issystem:!0,width:l.detailColWidth,frozen:f},b(e,1,-1,c),c=e.__id),k.enabledCheckbox()&&(g=k.enabledGroup()?!1:l.frozen&&l.frozenCheckbox,e={ischeckbox:!0,issystem:!0,width:l.detailColWidth,frozen:g},b(e,1,-1,c),c=e.__id),h=0,i=l.columns.length;i>h;h++)e=l.columns[h],b(e,1,-1,c),c=e.__id;for(j in k._columns)e=k._columns[j],e.__leafcount>1&&(e.__colSpan=e.__leafcount),e.__leaf&&e.__level!=k._columnMaxLevel&&(e.__rowSpan=k._columnMaxLevel-e.__level+1);k.columns=k.getColumns(),$(k.columns).each(function(a,b){b.columnname=b.name,b.columnindex=a,b.type=b.type||"string",b.islast=a==k.columns.length-1,b.isSort=0==b.isSort?!1:!0,b.frozen=b.frozen?!0:!1,b._width=k._getColumnWidth(b),b._hide=b.hide?!0:!1})}},_getColumnWidth:function(a){var b,c,d=this,e=this.options;return a._width?a._width:(a.width?b=a.width:e.columnWidth&&(b=e.columnWidth),b||(c=4,d.enabledCheckbox()&&(c+=e.checkboxColWidth),d.enabledDetail()&&(c+=e.detailColWidth),b=parseInt((d.grid.width()-c)/d.columns.length)),"string"==typeof b&&b.indexOf("%")>0&&(a._width=b=parseInt(.01*parseInt(b)*(d.grid.width()-d.columns.length))),a.minWidth&&b<a.minWidth&&(b=a.minWidth),a.maxWidth&&b>a.maxWidth&&(b=a.maxWidth),a._width=b,b)},_createHeaderCell:function(a){var b,c=this,d=this.options,e=$("<td class='l-grid-hd-cell'><div class='l-grid-hd-cell-inner'><span class='l-grid-hd-cell-text'></span></div></td>");return e.attr("id",a.__domid),a.__leaf||e.addClass("l-grid-hd-cell-mul"),a.columnindex==c.columns.length-1&&e.addClass("l-grid-hd-cell-last"),a.isrownumber&&(e.addClass("l-grid-hd-cell-rownumbers"),e.html("<div class='l-grid-hd-cell-inner'></div>")),a.ischeckbox&&(e.addClass("l-grid-hd-cell-checkbox"),e.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-checkbox'></div></div>")),a.isdetail&&(e.addClass("l-grid-hd-cell-detail"),e.html("<div class='l-grid-hd-cell-inner'><div class='l-grid-hd-cell-text l-grid-hd-cell-btn-detail'></div></div>")),a.heightAlign&&$(".l-grid-hd-cell-inner:first",e).css("textAlign",a.heightAlign),a.__colSpan&&e.attr("colSpan",a.__colSpan),a.__rowSpan?(e.attr("rowSpan",a.__rowSpan),e.height(d.headerRowHeight*a.__rowSpan)):e.height(d.headerRowHeight),a.__leaf&&(e.width(a._width),e.attr("columnindex",a.__leafindex)),a._hide&&e.hide(),a.name&&e.attr({columnname:a.name}),b="",b=a.display&&""!=a.display?a.display:a.headerRender?a.headerRender(a):"&nbsp;",$(".l-grid-hd-cell-text:first",e).html(b),!a.issystem&&a.__leaf&&a.resizable!==!1&&$.fn.ligerResizable&&(c.colResizable[a.__id]=e.ligerResizable({handles:"e",onStartResize:function(a,b){this.proxy.hide(),c.draggingline.css({height:c.body.height(),top:0,left:b.pageX-c.grid.offset().left+parseInt(c.body[0].scrollLeft)}).show()},onResize:function(a,b){c.colresizing=!0,c.draggingline.css({left:b.pageX-c.grid.offset().left+parseInt(c.body[0].scrollLeft)}),$("body").add(e).css("cursor","e-resize")},onStopResize:function(b){return c.colresizing=!1,$("body").add(e).css("cursor","default"),c.draggingline.hide(),c.setColumnWidth(a,a._width+b.diffX),!1}})),e},_initBuildGridHeader:function(){var a,b,c,d,e,f,g,h=this,i=this.options;if(h.gridtablewidth=0,h.f.gridtablewidth=0,h.colResizable){for(a in h.colResizable)h.colResizable[a].destroy();h.colResizable=null}for(h.colResizable={},$("tbody:first",h.gridheader).html(""),$("tbody:first",h.f.gridheader).html(""),b=1;b<=h._columnMaxLevel;b++)c=h.getColumns(b),d=b==h._columnMaxLevel,e=$("<tr class='l-grid-hd-row'></tr>"),f=$("<tr class='l-grid-hd-row'></tr>"),d||e.add(f).addClass("l-grid-hd-mul"),$("tbody:first",h.gridheader).append(e),$("tbody:first",h.f.gridheader).append(f),$(c).each(function(a,b){if((b.frozen?f:e).append(h._createHeaderCell(b)),b.__leaf){var c=b._width;b.frozen?h.f.gridtablewidth+=(parseInt(c)?parseInt(c):0)+1:h.gridtablewidth+=(parseInt(c)?parseInt(c):0)+1}});h._columnMaxLevel>0&&(g=i.headerRowHeight*h._columnMaxLevel,h.gridheader.add(h.f.gridheader).height(g),i.rownumbers&&i.frozenRownumbers&&h.f.gridheader.find("td:first").height(g)),h._updateFrozenWidth(),$("div:first",h.gridheader).width(h.gridtablewidth+40)},_initBuildPopup:function(){var a,b=this,c=this.options;$(":checkbox",b.popup).unbind(),$("tbody tr",b.popup).remove(),$(b.columns).each(function(a,c){var d,e;c.issystem||0!=c.isAllowHide&&(d='checked="checked"',c._hide&&(d=""),e=c.display,$("tbody",b.popup).append('<tr><td class="l-column-left"><input type="checkbox" '+d+' class="l-checkbox" columnindex="'+a+'"/></td><td class="l-column-right">'+e+"</td></tr>"))}),$.fn.ligerCheckBox&&$("input:checkbox",b.popup).ligerCheckBox({onBeforeClick:function(a){return a.checked?$("input:checked",b.popup).length<=c.minColToggle?!1:!0:!0}}),c.allowHideColumn&&($("tr",b.popup).hover(function(){$(this).addClass("l-popup-row-over")},function(){$(this).removeClass("l-popup-row-over")}),a=function(){return $("input:checked",b.popup).length+1<=c.minColToggle?!1:(b.toggleCol(parseInt($(this).attr("columnindex")),this.checked,!0),void 0)},$.fn.ligerCheckBox?$(":checkbox",b.popup).bind("change",a):$(":checkbox",b.popup).bind("click",a))},_initHeight:function(){var a=this,b=this.options;"auto"==b.height&&(a.gridbody.height("auto"),a.f.gridbody.height("auto")),b.width&&a.grid.width(b.width),a._onResize.call(a)},_initFootbar:function(){var a,b,c=this,d=this.options;
d.usePager?(a="",b=-1,$(d.pageSizeOptions).each(function(c,e){var f="";d.pageSize==e&&(b=c),a+="<option value='"+e+"' "+f+" >"+e+"</option>"}),$(".l-bar-selectpagesize",c.toolbar).append("<select name='rp'>"+a+"</select>"),-1!=b&&($(".l-bar-selectpagesize select",c.toolbar)[0].selectedIndex=b),d.switchPageSizeApplyComboBox&&$.fn.ligerComboBox&&$(".l-bar-selectpagesize select",c.toolbar).ligerComboBox({onBeforeSelect:function(){return d.url&&c.isDataChanged&&!confirm(d.isContinueByDataChanged)?!1:!0},width:45})):c.toolbar.hide()},_searchData:function(a,b){var c,d;for(this.options,c=new Array,d=0;d<a.length;d++)b(a[d],d)&&(c[c.length]=a[d]);return c},_clearGrid:function(){var a,b,c=this;this.options;for(a in c.rows)b=$(c.getRowObj(c.rows[a])),c.enabledFrozen()&&(b=b.add(c.getRowObj(c.rows[a],!0))),b.unbind();c.gridbody.html(""),c.f.gridbody.html(""),c.recordNumber=0,c.records={},c.rows=[],c.selected=[],c.totalNumber=0,c.editorcounter=0},_fillGridBody:function(a,b){var c,d,e,f,g,h,i=this,j=this.options,k=['<div class="l-grid-body-inner"><table class="l-grid-body-table" cellpadding=0 cellspacing=0><tbody>'];if(i.enabledGroup()){c=[],d=[],i.groups=d;for(e in a)f=a[e],g=f[j.groupColumnName],h=$.inArray(g,c),-1==h&&(c.push(g),h=c.length-1,d.push([])),d[h].push(f);$(d).each(function(a,e){1==d.length&&k.push('<tr class="l-grid-grouprow l-grid-grouprow-last l-grid-grouprow-first"'),a==d.length-1?k.push('<tr class="l-grid-grouprow l-grid-grouprow-last"'):0==a?k.push('<tr class="l-grid-grouprow l-grid-grouprow-first"'):k.push('<tr class="l-grid-grouprow"'),k.push(' groupindex"='+a+'" >'),k.push('<td colSpan="'+i.columns.length+'" class="l-grid-grouprow-cell">'),k.push('<span class="l-grid-group-togglebtn">&nbsp;&nbsp;&nbsp;&nbsp;</span>'),j.groupRender?k.push(j.groupRender(c[a],e,j.groupColumnDisplay)):k.push(j.groupColumnDisplay+":"+c[a]),k.push("</td>"),k.push("</tr>"),k.push(i._getHtmlFromData(e,b)),i.isTotalSummary()&&k.push(i._getTotalSummaryHtml(e,"l-grid-totalsummary-group",b))})}else k.push(i._getHtmlFromData(a,b));k.push("</tbody></table></div>"),(b?i.f.gridbody:i.gridbody).html(k.join("")),i.enabledGroup()||i._bulidTotalSummary(b),$("> div:first",i.gridbody).width(i.gridtablewidth),i._onResize()},_showData:function(){var a,b,c=this,d=this.options,e=c.currentData[d.root];if(d.usePager&&("server"==d.dataAction&&c.data&&c.data[d.record]?d.total=c.data[d.record]:c.filteredData&&c.filteredData[d.root]?d.total=c.filteredData[d.root].length:c.data&&c.data[d.root]?d.total=c.data[d.root].length:e&&(d.total=e.length),d.page=d.newPage,d.total||(d.total=0),d.page||(d.page=1),d.pageCount=Math.ceil(d.total/d.pageSize),d.pageCount||(d.pageCount=1),c._buildPager()),$(".l-bar-btnloading:first",c.toolbar).removeClass("l-bar-btnloading"),0!=c.trigger("beforeShowData",[c.currentData])&&(c._clearGrid(),c.isDataChanged=!1,e)){if($(".l-bar-btnload:first span",c.toolbar).removeClass("l-disabled"),c._updateGridData(),c.enabledFrozen()&&c._fillGridBody(c.rows,!0),c._fillGridBody(c.rows,!1),c.trigger("SysGridHeightChanged"),d.totalRender&&($(".l-panel-bar-total",c.element).remove(),$(".l-panel-bar",c.element).before('<div class="l-panel-bar-total">'+d.totalRender(c.data,c.filteredData)+"</div>")),d.mouseoverRowCssClass)for(a in c.rows)b=$(c.getRowObj(c.rows[a])),c.enabledFrozen()&&(b=b.add(c.getRowObj(c.rows[a],!0))),b.bind("mouseover.gridrow",function(){c._onRowOver(this,!0)}).bind("mouseout.gridrow",function(){c._onRowOver(this,!1)});c.gridbody.trigger("scroll.grid"),c.trigger("afterShowData",[c.currentData])}},_getRowDomId:function(a,b){return this.id+"|"+(b?"1":"2")+"|"+a.__id},_getCellDomId:function(a,b){return this._getRowDomId(a,b.frozen)+"|"+b.__id},_getHtmlFromData:function(a,b){var c,d,e,f,g,h,i;if(!a)return"";c=this,d=this.options,e=[];for(f in a)g=a[f],h=g.__id,g&&(e.push("<tr"),e.push(' id="'+c._getRowDomId(g,b)+'"'),e.push(' class="l-grid-row'),!b&&c.enabledCheckbox()&&d.isChecked&&d.isChecked(g)?(c.select(g),e.push(" l-selected")):c.isSelected(g)&&e.push(" l-selected"),1==g.__index%2&&d.alternatingRow&&e.push(" l-grid-row-alt"),e.push('" '),d.rowAttrRender&&e.push(d.rowAttrRender(g,h)),d.tree&&c.collapsedRows&&c.collapsedRows.length&&(i=function(){for(var a=c.getParent(g);a;){if(-1!=$.inArray(a,c.collapsedRows))return!0;a=c.getParent(a)}return!1},i()&&e.push(' style="display:none;" ')),e.push(">"),$(c.columns).each(function(a,f){if(b==f.frozen){if(e.push("<td"),e.push(' id="'+c._getCellDomId(g,this)+'"'),this.isrownumber)return e.push(' class="l-grid-row-cell l-grid-row-cell-rownumbers" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),d.fixedCellHeight&&e.push(' style = "height:'+d.rowHeight+'px;" '),e.push(">"+(parseInt(g.__index)+1)+"</div></td>"),void 0;if(this.ischeckbox)return e.push(' class="l-grid-row-cell l-grid-row-cell-checkbox" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),d.fixedCellHeight&&e.push(' style = "height:'+d.rowHeight+'px;" '),e.push('><span class="l-grid-row-cell-btn-checkbox"></span></div></td>'),void 0;if(this.isdetail)return e.push(' class="l-grid-row-cell l-grid-row-cell-detail" style="width:'+this.width+'px"><div class="l-grid-row-cell-inner"'),d.fixedCellHeight&&e.push(' style = "height:'+d.rowHeight+'px;" '),e.push('><span class="l-grid-row-cell-detailbtn"></span></div></td>'),void 0;var i=this._width;e.push(' class="l-grid-row-cell '),c.changedCells[h+"_"+this.__id]&&e.push("l-grid-row-cell-edited "),this.islast&&e.push("l-grid-row-cell-last "),e.push('"'),e.push(' style = "'),e.push("width:"+i+"px; "),f._hide&&e.push("display:none;"),e.push(' ">'),e.push(c._getCellHtml(g,f)),e.push("</td>")}}),e.push("</tr>"));return e.join("")},_getCellHtml:function(a,b){var c,d,e=this,f=this.options;return b.isrownumber?'<div class="l-grid-row-cell-inner">'+(parseInt(a.__index)+1)+"</div>":(c=[],c.push('<div class="l-grid-row-cell-inner"'),c.push(' style = "width:'+parseInt(b._width-8)+"px;"),f.fixedCellHeight&&c.push("height:"+f.rowHeight+"px;min-height:"+f.rowHeight+"px; "),b.align&&c.push("text-align:"+b.align+";"),d=e._getCellContent(a,b),c.push('">'+d+"</div>"),c.join(""))},_getCellContent:function(a,b){var c,d,e,f,g;return a&&b?b.isrownumber?parseInt(a.__index)+1:(a.__id,c=a.__index,d=b.name?a[b.name]:null,e=this,f=this.options,g="",b.render?g=b.render.call(e,a,c,d,b):f.formatters[b.type]?g=f.formatters[b.type].call(e,d,b):null!=d&&(g=d.toString()),f.tree&&(null!=f.tree.columnName&&f.tree.columnName==b.name||null!=f.tree.columnId&&f.tree.columnId==b.id)&&(g=e._getTreeCellHtml(g,a)),g||""):""},_getTreeCellHtml:function(a,b){var c,d=b.__level,e=this,f=this.options,g=-1==$.inArray(b,e.collapsedRows||[]),h=f.tree.isParent(b),i="";for(d=parseInt(d)||1,c=1;d>c;c++)i+="<div class='l-grid-tree-space'></div>";return i+=g&&h?"<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-open'></div>":h?"<div class='l-grid-tree-space l-grid-tree-link l-grid-tree-link-close'></div>":"<div class='l-grid-tree-space'></div>",i+="<span class='l-grid-tree-content'>"+a+"</span>"},_applyEditor:function(a){var b,c,d,e,f,g,h,i,j,k,l=this,m=this.options,n=a,o=n.id.split("|"),p=o[o.length-1],q=l._columns[p],r=$(n).parent(),s=l.getRow(r[0]),t=s.__id,u=s.__index;if(q&&q.editor&&(b=q.name,q.columnindex,q.editor.type&&m.editors[q.editor.type])){if(c=s[b],d={record:s,value:c,column:q,rowindex:u},0==l.trigger("beforeEdit",[d]))return!1;e=m.editors[q.editor.type],f=$(n),g=$(n).offset(),f.html(""),l.setCellEditing(s,q,!0),h=$(n).width(),i=$(n).height(),j=$("<div class='l-grid-editor'></div>").appendTo("body"),$.browser.mozilla?j.css({left:g.left,top:g.top}).show():j.css({left:g.left+1,top:g.top+1}).show(),k=l._createEditor(e,j,d,h,i),l.editor={editing:!0,editor:e,input:k,editParm:d,container:j},l.unbind("sysEndEdit"),l.bind("sysEndEdit",function(){var a=e.getValue(k,d);a!=c&&($(n).addClass("l-grid-row-cell-edited"),l.changedCells[t+"_"+q.__id]=!0,q.editor.onChange&&q.editor.onChange(n,a),d.value=a,l._checkEditAndUpdateCell(d)&&q.editor.onChanged&&q.editor.onChanged(n,a))})}},_checkEditAndUpdateCell:function(a){var b=this;return this.options,0==b.trigger("beforeSubmitEdit",[a])?!1:(b.updateCell(a.column,a.value,a.record),(a.column.render||b.enabledTotal())&&b.reRender({column:a.column}),b.reRender({rowdata:a.record}),!0)},_getCurrentPageData:function(a){var b=this.options,c={};if(c[b.root]=[],!a||!a[b.root]||!a[b.root].length)return c[b.record]=0,c;for(c[b.record]=a[b.root].length,b.newPage||(b.newPage=1),i=(b.newPage-1)*b.pageSize;i<a[b.root].length&&i<b.newPage*b.pageSize;i++)c[b.root].push(a[b.root][i]);return c},_compareData:function(a,b,c,d){var e=this,f=this.options,g=a[c],h=b[c];return null==g&&null!=h?1:null==g&&null==h?0:null!=g&&null==h?-1:f.sorters[d]?f.sorters[d].call(e,g,h):h>g?-1:g>h?1:0},_getTotalCellContent:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=this;if(this.options,c=[],a.totalSummary){for(d=function(a){for(var b=0;b<m.length;b++)if(m[b].toLowerCase()==a.toLowerCase())return!0;return!1},e=0,f=0,g=0,h=parseFloat(b[0][a.name]),i=parseFloat(b[0][a.name]),j=0;j<b.length;j++)f+=1,k=parseFloat(b[j][a.name]),k&&(e+=k,k>h&&(h=k),i>k&&(i=k));g=1*e/b.length,a.totalSummary.render?(l=a.totalSummary.render({sum:e,count:f,avg:g,min:i,max:h},a,n.data),c.push(l)):a.totalSummary.type&&(m=a.totalSummary.type.split(","),d("sum")&&c.push("<div>Sum="+e.toFixed(2)+"</div>"),d("count")&&c.push("<div>Count="+f+"</div>"),d("max")&&c.push("<div>Max="+h.toFixed(2)+"</div>"),d("min")&&c.push("<div>Min="+i.toFixed(2)+"</div>"),d("avg")&&c.push("<div>Avg="+g.toFixed(2)+"</div>"))}return c.join("")},_getTotalSummaryHtml:function(a,b,c){var d,e=this;return this.options,d=[],b?d.push('<tr class="l-grid-totalsummary '+b+'">'):d.push('<tr class="l-grid-totalsummary">'),$(e.columns).each(function(b,f){if(this.frozen==c){if(this.isrownumber)return d.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-rownumbers" style="width:'+this.width+'px"><div>&nbsp;</div></td>'),void 0;if(this.ischeckbox)return d.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-checkbox" style="width:'+this.width+'px"><div>&nbsp;</div></td>'),void 0;if(this.isdetail)return d.push('<td class="l-grid-totalsummary-cell l-grid-totalsummary-cell-detail" style="width:'+this.width+'px"><div>&nbsp;</div></td>'),void 0;d.push('<td class="l-grid-totalsummary-cell'),this.islast&&d.push(" l-grid-totalsummary-cell-last"),d.push('" '),d.push('id="'+e.id+"|total"+e.totalNumber+"|"+f.__id+'" '),d.push('width="'+this._width+'" '),columnname=this.columnname,columnname&&d.push('columnname="'+columnname+'" '),d.push('columnindex="'+b+'" '),d.push('><div class="l-grid-totalsummary-cell-inner"'),f.align&&d.push(' style="text-Align:'+f.align+';"'),d.push(">"),d.push(e._getTotalCellContent(f,a)),d.push("</div></td>")}}),d.push("</tr>"),c||e.totalNumber++,d.join("")},_bulidTotalSummary:function(a){var b,c=this,d=this.options;return c.isTotalSummary()?c.currentData&&0!=c.currentData[d.root].length?(b=$(c._getTotalSummaryHtml(c.currentData[d.root],null,a)),$("tbody:first",a?c.f.gridbody:c.gridbody).append(b),void 0):!1:!1},_buildPager:function(){var a,b,c,d=this,e=this.options;$(".pcontrol input",d.toolbar).val(e.page),e.pageCount||(e.pageCount=1),$(".pcontrol span",d.toolbar).html(e.pageCount),a=parseInt((e.page-1)*e.pageSize)+1,b=parseInt(a)+parseInt(e.pageSize)-1,e.total||(e.total=0),e.total<b&&(b=e.total),e.total||(a=b=0),0>a&&(a=0),0>b&&(b=0),c=e.pageStatMessage,c=c.replace(/{from}/,a),c=c.replace(/{to}/,b),c=c.replace(/{total}/,e.total),c=c.replace(/{pagesize}/,e.pageSize),$(".l-bar-text",d.toolbar).html(c),e.total||$(".l-bar-btnfirst span,.l-bar-btnprev span,.l-bar-btnnext span,.l-bar-btnlast span",d.toolbar).addClass("l-disabled"),1==e.page?($(".l-bar-btnfirst span",d.toolbar).addClass("l-disabled"),$(".l-bar-btnprev span",d.toolbar).addClass("l-disabled")):e.page>e.pageCount&&e.pageCount>0&&($(".l-bar-btnfirst span",d.toolbar).removeClass("l-disabled"),$(".l-bar-btnprev span",d.toolbar).removeClass("l-disabled")),e.page==e.pageCount?($(".l-bar-btnlast span",d.toolbar).addClass("l-disabled"),$(".l-bar-btnnext span",d.toolbar).addClass("l-disabled")):e.page<e.pageCount&&e.pageCount>0&&($(".l-bar-btnlast span",d.toolbar).removeClass("l-disabled"),$(".l-bar-btnnext span",d.toolbar).removeClass("l-disabled"))},_getRowIdByDomId:function(a){var b=a.split("|"),c=b[2];return c},_getRowByDomId:function(a){return this.records[this._getRowIdByDomId(a)]},_getSrcElementByEvent:function(a){var b,c,d,e,f,g=this,h=a.target||a.srcElement,i=$(h).parents().add(h),j=function(a){for(var b=0,c=i.length;c>b;b++)if("string"==typeof a){if($(i[b]).hasClass(a))return i[b]}else if("object"==typeof a&&i[b]==a)return i[b];return null};if(j("l-grid-editor"))return{editing:!0,editor:j("l-grid-editor")};if(-1==i.index(this.element))return{out:!0};if(b=!1,i.hasClass("l-grid-detailpanel")&&g.detailrows)for(c=0,d=g.detailrows.length;d>c;c++)if(-1!=i.index(g.detailrows[c])){b=!0;break}return e={grid:j("l-panel"),indetail:b,frozen:j(g.gridview1[0])?!0:!1,header:j("l-panel-header"),gridheader:j("l-grid-header"),gridbody:j("l-grid-body"),total:j("l-panel-bar-total"),popup:j("l-grid-popup"),toolbar:j("l-panel-bar")},e.gridheader&&(e.hrow=j("l-grid-hd-row"),e.hcell=j("l-grid-hd-cell"),e.hcelltext=j("l-grid-hd-cell-text"),e.checkboxall=j("l-grid-hd-cell-checkbox"),e.hcell&&(f=e.hcell.id.split("|")[2],e.column=g._columns[f])),e.gridbody&&(e.row=j("l-grid-row"),e.cell=j("l-grid-row-cell"),e.checkbox=j("l-grid-row-cell-btn-checkbox"),e.groupbtn=j("l-grid-group-togglebtn"),e.grouprow=j("l-grid-grouprow"),e.detailbtn=j("l-grid-row-cell-detailbtn"),e.detailrow=j("l-grid-detailpanel"),e.totalrow=j("l-grid-totalsummary"),e.totalcell=j("l-grid-totalsummary-cell"),e.rownumberscell=$(e.cell).hasClass("l-grid-row-cell-rownumbers")?e.cell:null,e.detailcell=$(e.cell).hasClass("l-grid-row-cell-detail")?e.cell:null,e.checkboxcell=$(e.cell).hasClass("l-grid-row-cell-checkbox")?e.cell:null,e.treelink=j("l-grid-tree-link"),e.editor=j("l-grid-editor"),e.row&&(e.data=this._getRowByDomId(e.row.id)),e.cell&&(e.editing=$(e.cell).hasClass("l-grid-row-cell-editing")),e.editor&&(e.editing=!0),e.editing&&(e.out=!1)),e.toolbar&&(e.first=j("l-bar-btnfirst"),e.last=j("l-bar-btnlast"),e.next=j("l-bar-btnnext"),e.prev=j("l-bar-btnprev"),e.load=j("l-bar-btnload"),e.button=j("l-bar-button")),e},_setEvent:function(){var a=this,b=this.options;a.grid.bind("mousedown.grid",function(b){a._onMouseDown.call(a,b)}),a.grid.bind("dblclick.grid",function(b){a._onDblClick.call(a,b)}),a.grid.bind("contextmenu.grid",function(b){return a._onContextmenu.call(a,b)}),$(document).bind("mouseup.grid",function(b){a._onMouseUp.call(a,b)}),$(document).bind("click.grid",function(b){a._onClick.call(a,b)}),$(window).bind("resize.grid",function(){a._onResize.call(a)}),$(document).bind("keydown.grid",function(b){b.ctrlKey&&(a.ctrlKey=!0)}),$(document).bind("keyup.grid",function(){delete a.ctrlKey}),a.gridbody.bind("scroll.grid",function(){var b=a.gridbody.scrollLeft(),c=a.gridbody.scrollTop();null!=b&&(a.gridheader[0].scrollLeft=b),null!=c&&(a.f.gridbody[0].scrollTop=c),a.endEdit(),a.trigger("SysGridHeightChanged")}),$("select",a.toolbar).change(function(){return a.isDataChanged&&!confirm(b.isContinueByDataChanged)?!1:(b.newPage=1,b.pageSize=this.value,a.loadData(b.where),void 0)}),$("span.pcontrol :text",a.toolbar).blur(function(){a.changePage("input")}),$("div.l-bar-button",a.toolbar).hover(function(){$(this).addClass("l-bar-button-over")},function(){$(this).removeClass("l-bar-button-over")}),$.fn.ligerDrag&&b.colDraggable&&(a.colDroptip=$("<div class='l-drag-coldroptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body"),a.gridheader.add(a.f.gridheader).ligerDrag({revert:!0,animate:!1,proxyX:0,proxyY:0,proxy:function(b,c){var d,e,f=a._getSrcElementByEvent(c);return f.hcell&&f.column?(d=$(".l-grid-hd-cell-text:first",f.hcell).html(),e=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body"),e.append(d),e):void 0},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),a.children[this.id]=this},onStartDrag:function(b,c){var d,e;return 2==c.button?!1:a.colresizing?!1:(this.set("cursor","default"),d=a._getSrcElementByEvent(c),!d.hcell||!d.column||d.column.issystem||d.hcelltext?!1:-1!=$(d.hcell).css("cursor").indexOf("resize")?!1:(this.draggingColumn=d.column,a.coldragging=!0,e=a.grid.offset(),this.validRange={top:e.top,bottom:e.top+a.gridheader.height(),left:e.left-10,right:e.left+a.grid.width()+10},void 0))},onDrag:function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(this.set("cursor","default"),e=this.draggingColumn,!e)return!1;if(a.colresizing)return!1;if(null==a.colDropIn&&(a.colDropIn=-1),f=d.pageX,g=d.pageY,h=!1,a.grid.offset(),i=this.validRange,f<i.left||f>i.right||g>i.bottom||g<i.top)return a.colDropIn=-1,a.colDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no"),void 0;for(j in a._columns)if(k=a._columns[j],e!=k){if(!k.issystem&&(l=k.__level==e.__level,m=l?h?!0:!1:!1,e.frozen!=k.frozen&&(m=k.frozen?!1:!0),-1==a.colDropIn||a.colDropIn==j)){if(n=document.getElementById(k.__domid),o=$(n).offset(),p={top:o.top,bottom:o.top+$(n).height(),left:o.left-10,right:o.left+10},m&&(q=$(n).width(),p.left+=q,p.right+=q),f>p.left&&f<p.right&&g>p.top&&g<p.bottom){r=b.headerRowHeight,k.__rowSpan&&(r*=k.__rowSpan),a.colDroptip.css({left:p.left+5,top:p.top-9,height:r+18}).show(),a.colDropIn=j,a.colDropDir=m?"right":"left",this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no").addClass("l-drop-yes");break}-1!=a.colDropIn&&(a.colDropIn=-1,a.colDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes").addClass("l-drop-no"))}}else h=!0},onStopDrag:function(){var b=this.draggingColumn;a.coldragging=!1,-1!=a.colDropIn&&(a.changeCol.ligerDefer(a,0,[b,a.colDropIn,"right"==a.colDropDir]),a.colDropIn=-1),a.colDroptip.hide(),this.set("cursor","default")}})),$.fn.ligerDrag&&b.rowDraggable&&(a.rowDroptip=$("<div class='l-drag-rowdroptip' style='display:none'></div>").appendTo("body"),a.gridbody.add(a.f.gridbody).ligerDrag({revert:!0,animate:!1,proxyX:0,proxyY:0,proxy:function(c,d){var e,f,g=a._getSrcElementByEvent(d);return g.row?(e=b.draggingMessage.replace(/{count}/,c.draggingRows?c.draggingRows.length:1),b.rowDraggingRender&&(e=b.rowDraggingRender(c.draggingRows,c,a)),f=$("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+e+"</div>").appendTo("body")):void 0},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),a.children[this.id]=this},onStartDrag:function(b,c){var d,e,f;if(2==c.button)return!1;if(a.colresizing)return!1;if(!a.columns.length)return!1;if(this.set("cursor","default"),d=a._getSrcElementByEvent(c),!d.cell||!d.data||d.checkbox)return!1;if(e=d.cell.id.split("|"),f=a._columns[e[e.length-1]],!(d.rownumberscell||d.detailcell||d.checkboxcell||f==a.columns[0]))return!1;if(a.enabledCheckbox()){if(this.draggingRows=a.getSelecteds(),!this.draggingRows||!this.draggingRows.length)return!1}else this.draggingRows=[d.data];this.draggingRow=d.data,this.set("cursor","move"),a.rowdragging=!0,this.validRange={top:a.gridbody.offset().top,bottom:a.gridbody.offset().top+a.gridbody.height(),left:a.grid.offset().left-10,right:a.grid.offset().left+a.grid.width()+10}},onDrag:function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r=this.draggingRow;if(!r)return!1;if(e=this.draggingRows?this.draggingRows:[r],a.colresizing)return!1;if(null==a.rowDropIn&&(a.rowDropIn=-1),f=d.pageX,g=d.pageY,h=!1,i=this.validRange,f<i.left||f>i.right||g>i.bottom||g<i.top)return a.rowDropIn=-1,a.rowDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no"),void 0;for(j in a.rows)if(k=a.rows[j],l=k.__id,r==k&&(h=!0),-1==$.inArray(k,e)&&(m=h?!0:!1,-1==a.rowDropIn||a.rowDropIn==l)){if(n=a.getRowObj(l),o=$(n).offset(),p={top:o.top-4,bottom:o.top+$(n).height()+4,left:a.grid.offset().left,right:a.grid.offset().left+a.grid.width()},f>p.left&&f<p.right&&g>p.top&&g<p.bottom){q=o.top,m&&(q+=$(n).height()),a.rowDroptip.css({left:p.left,top:q,width:p.right-p.left}).show(),a.rowDropIn=l,a.rowDropDir=m?"bottom":"top",b.tree&&g>p.top+5&&g<p.bottom-5?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),a.rowDroptip.hide(),a.rowDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),a.rowDroptip.show(),a.rowDropInParent=!1);break}-1!=a.rowDropIn&&(a.rowDropIn=-1,a.rowDropInParent=!1,a.rowDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}},onStopDrag:function(){var c,d,e,f,g=this.draggingRows;for(a.rowdragging=!1,c=0;c<g.length;c++)d=g[c].children,d&&(g=$.grep(g,function(a){var b=-1==$.inArray(a,d);return b}));-1!=a.rowDropIn&&(b.tree?(a.rowDropInParent?f=a.getRow(a.rowDropIn):(e=a.getRow(a.rowDropIn),f=a.getParent(e)),a.appendRange(g,f,e,"bottom"!=a.rowDropDir),a.trigger("rowDragDrop",{rows:g,parent:f,near:e,after:"bottom"==a.rowDropDir})):(a.moveRange(g,a.rowDropIn,"bottom"==a.rowDropDir),a.trigger("rowDragDrop",{rows:g,parent:f,near:a.getRow(a.rowDropIn),after:"bottom"==a.rowDropDir})),a.rowDropIn=-1),a.rowDroptip.hide(),this.set("cursor","default")}}))},_onRowOver:function(a,b){var c,d,e,f;l.draggable.dragging||(c=this,d=this.options,e=c.getRow(a),f=b?"addClass":"removeClass",c.enabledFrozen()&&$(c.getRowObj(e,!0))[f](d.mouseoverRowCssClass),$(c.getRowObj(e,!1))[f](d.mouseoverRowCssClass))},_onMouseUp:function(a){var b,c=this;this.options,l.draggable.dragging&&(b=c._getSrcElementByEvent(a),b.hcell&&b.column?c.trigger("dragdrop",[{type:"header",column:b.column,cell:b.hcell},a]):b.row&&c.trigger("dragdrop",[{type:"row",record:b.data,row:b.row},a]))},_onMouseDown:function(){this.options},_onContextmenu:function(a){var b,c,d=this,e=this.options,f=d._getSrcElementByEvent(a);if(f.row){if(e.whenRClickToSelect&&d.select(f.data),d.hasBind("contextmenu"))return d.trigger("contextmenu",[{data:f.data,rowindex:f.data.__index,row:f.row},a])}else if(f.hcell)return e.allowHideColumn?(b=$(f.hcell).attr("columnindex"),void 0==b?!0:(c=a.pageX-d.body.offset().left+parseInt(d.body[0].scrollLeft),b==d.columns.length-1&&(c-=50),d.popup.css({left:c,top:d.gridheader.height()+1}),d.popup.toggle(),!1)):!0},_onDblClick:function(a){var b,c=this;this.options,b=c._getSrcElementByEvent(a),b.row&&c.trigger("dblClickRow",[b.data,b.data.__id,b.row])},_onClick:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;if(a.target||a.srcElement,b=this,c=this.options,d=b._getSrcElementByEvent(a),d.out)return b.editor.editing&&!$.ligerui.win.masking&&b.endEdit(),c.allowHideColumn&&b.popup.hide(),void 0;if(!d.indetail&&!d.editing)if(b.editor.editing&&b.endEdit(),c.allowHideColumn&&(d.popup||b.popup.hide()),d.checkboxall){if(e=$(d.hrow),f=e.hasClass("l-checked"),0==b.trigger("beforeCheckAllRow",[!f,b.element]))return!1;f?e.removeClass("l-checked"):e.addClass("l-checked"),b.selected=[];for(g in b.records)f?b.unselect(b.records[g]):b.select(b.records[g]);b.trigger("checkAllRow",[!f,b.element])}else if(d.hcelltext){if(h=$(d.hcelltext).parent().parent(),!c.enabledSort||!d.column)return;if(0==d.column.isSort)return;if(c.url&&b.isDataChanged&&!confirm(c.isContinueByDataChanged))return;if(i=$(".l-grid-hd-cell-sort:first",h),j=d.column.name,!j)return;i.length>0?i.hasClass("l-grid-hd-cell-sort-asc")?(i.removeClass("l-grid-hd-cell-sort-asc").addClass("l-grid-hd-cell-sort-desc"),h.removeClass("l-grid-hd-cell-asc").addClass("l-grid-hd-cell-desc"),b.changeSort(j,"desc")):i.hasClass("l-grid-hd-cell-sort-desc")&&(i.removeClass("l-grid-hd-cell-sort-desc").addClass("l-grid-hd-cell-sort-asc"),h.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc"),b.changeSort(j,"asc")):(h.removeClass("l-grid-hd-cell-desc").addClass("l-grid-hd-cell-asc"),$(d.hcelltext).after("<span class='l-grid-hd-cell-sort l-grid-hd-cell-sort-asc'>&nbsp;&nbsp;</span>"),b.changeSort(j,"asc")),$(".l-grid-hd-cell-sort",b.gridheader).add($(".l-grid-hd-cell-sort",b.f.gridheader)).not($(".l-grid-hd-cell-sort:first",h)).remove()}else if(d.detailbtn&&c.detail)if(k=d.data,e=$([b.getRowObj(k,!1)]),b.enabledFrozen()&&(e=e.add(b.getRowObj(k,!0))),g=k.__id,$(d.detailbtn).hasClass("l-open"))c.detail.onCollapse&&c.detail.onCollapse(k,$(".l-grid-detailpanel-inner:first",l)[0]),e.next("tr.l-grid-detailpanel").hide(),$(d.detailbtn).removeClass("l-open");else{if(l=e.next("tr.l-grid-detailpanel"),l.length>0)return l.show(),c.detail.onExtend&&c.detail.onExtend(k,$(".l-grid-detailpanel-inner:first",l)[0]),$(d.detailbtn).addClass("l-open"),b.trigger("SysGridHeightChanged"),void 0;for($(d.detailbtn).addClass("l-open"),m=0,n=0;n<b.columns.length;n++)b.columns[n].frozen&&m++;o=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>"),p=$("<tr class='l-grid-detailpanel'><td><div class='l-grid-detailpanel-inner' style='display:none'></div></td></tr>"),o.attr("id",b.id+"|detail|"+g),b.detailrows=b.detailrows||[],b.detailrows.push(o[0]),b.detailrows.push(p[0]),q=$("div:first",o),q.parent().attr("colSpan",b.columns.length-m),e.eq(0).after(o),m>0&&(p.find("td:first").attr("colSpan",m),e.eq(1).after(p)),c.detail.onShowDetail?(c.detail.onShowDetail(k,q[0],function(){b.trigger("SysGridHeightChanged")}),$("div:first",p).add(q).show().height(c.detail.height||c.detailHeight)):c.detail.render&&(q.append(c.detail.render()),q.show()),b.trigger("SysGridHeightChanged")}else if(d.groupbtn){for(r=$(d.grouprow),s=!0,$(d.groupbtn).hasClass("l-grid-group-togglebtn-close")?($(d.groupbtn).removeClass("l-grid-group-togglebtn-close"),r.hasClass("l-grid-grouprow-last")&&$("td:first",r).width("auto")):(s=!1,$(d.groupbtn).addClass("l-grid-group-togglebtn-close"),r.hasClass("l-grid-grouprow-last")&&$("td:first",r).width(b.gridtablewidth)),t=r.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");0!=t.length;)s?(t.show(),t.hasClass("l-grid-detailpanel")&&!t.prev().find("td.l-grid-row-cell-detail:first span.l-grid-row-cell-detailbtn:first").hasClass("l-open")&&t.hide()):t.hide(),t=t.next(".l-grid-row,.l-grid-totalsummary-group,.l-grid-detailpanel");b.trigger("SysGridHeightChanged")}else if(d.treelink)b.toggle(d.data);else if(d.row&&b.enabledCheckbox()){if(u=c.selectRowButtonOnly?!0:!1,c.enabledEdit&&(u=!0),d.checkbox||!u){if(e=$(d.row),f=e.hasClass("l-selected"),0==b.trigger("beforeCheckRow",[!f,d.data,d.data.__id,d.row]))return!1;if(v=f?"unselect":"select",b[v](d.data),c.tree&&c.autoCheckChildren)for(w=b.getChildren(d.data,!0),n=0,x=w.length;x>n;n++)b[v](w[n]);b.trigger("checkRow",[!f,d.data,d.data.__id,d.row])}!d.checkbox&&d.cell&&c.enabledEdit&&c.clickToEdit&&b._applyEditor(d.cell)}else if(d.row&&!b.enabledCheckbox())if(d.cell&&c.enabledEdit&&c.clickToEdit&&b._applyEditor(d.cell),$(d.row).hasClass("l-selected")){if(!c.allowUnSelectRow)return $(d.row).addClass("l-selected-again"),void 0;b.unselect(d.data)}else b.select(d.data);else if(d.toolbar)if(d.first){if(0==b.trigger("toFirst",[b.element]))return!1;b.changePage("first")}else if(d.prev){if(0==b.trigger("toPrev",[b.element]))return!1;b.changePage("prev")}else if(d.next){if(0==b.trigger("toNext",[b.element]))return!1;b.changePage("next")}else if(d.last){if(0==b.trigger("toLast",[b.element]))return!1;b.changePage("last")}else if(d.load){if($("span",d.load).hasClass("l-disabled"))return!1;if(0==b.trigger("reload",[b.element]))return!1;if(c.url&&b.isDataChanged&&!confirm(c.isContinueByDataChanged))return!1;b.loadData(c.where)}},select:function(a){var b,c,d,e,f,g,h=this;if(this.options,b=h.getRow(a),c=b.__id,d=h.getRowObj(c),e=h.getRowObj(c,!0),!h.enabledCheckbox()&&!h.ctrlKey){for(f in h.selected)g=h.selected[f],g.__id in h.records&&($(h.getRowObj(g)).removeClass("l-selected l-selected-again"),h.enabledFrozen()&&$(h.getRowObj(g,!0)).removeClass("l-selected l-selected-again"));h.selected=[]}d&&$(d).addClass("l-selected"),e&&$(e).addClass("l-selected"),h.selected[h.selected.length]=b,h.trigger("selectRow",[b,c,d])},unselect:function(a){var b,c,d,e,f=this;this.options,b=f.getRow(a),c=b.__id,d=f.getRowObj(c),e=f.getRowObj(c,!0),$(d).removeClass("l-selected l-selected-again"),f.enabledFrozen()&&$(e).removeClass("l-selected l-selected-again"),f._removeSelected(b),f.trigger("unSelectRow",[b,c,d])},isSelected:function(a){var b,c,d=this;this.options,b=d.getRow(a);for(c in d.selected)if(d.selected[c]==b)return!0;return!1},_onResize:function(){var a,b,c,d,e,f,g=this,h=this.options;h.height&&"auto"!=h.height&&(a=$(window).height(),b=0,c=null,"string"==typeof h.height&&h.height.indexOf("%")>0?(d=g.grid.parent(),h.InWindow?(c=a,c-=parseInt($("body").css("paddingTop")),c-=parseInt($("body").css("paddingBottom"))):c=d.height(),b=.01*c*parseFloat(h.height),(h.InWindow||"body"==d[0].tagName.toLowerCase())&&(b-=g.grid.offset().top-parseInt($("body").css("paddingTop")))):b=parseInt(h.height),b+=h.heightDiff,g.windowHeight=a,g._setHeight(b)),g.enabledFrozen()&&(e=g.gridview1.width(),f=g.gridview.width(),g.gridview2.css({width:f-e})),g.trigger("SysGridHeightChanged")}}),$.ligerui.controls.Grid.prototype.enabledTotal=$.ligerui.controls.Grid.prototype.isTotalSummary,$.ligerui.controls.Grid.prototype.add=$.ligerui.controls.Grid.prototype.addRow,$.ligerui.controls.Grid.prototype.update=$.ligerui.controls.Grid.prototype.updateRow,$.ligerui.controls.Grid.prototype.append=$.ligerui.controls.Grid.prototype.appendRow,$.ligerui.controls.Grid.prototype.getSelected=$.ligerui.controls.Grid.prototype.getSelectedRow,$.ligerui.controls.Grid.prototype.getSelecteds=$.ligerui.controls.Grid.prototype.getSelectedRows,$.ligerui.controls.Grid.prototype.getCheckedRows=$.ligerui.controls.Grid.prototype.getSelectedRows,$.ligerui.controls.Grid.prototype.getCheckedRowObjs=$.ligerui.controls.Grid.prototype.getSelectedRowObjs,$.ligerui.controls.Grid.prototype.setOptions=$.ligerui.controls.Grid.prototype.set}(jQuery),function(a){a.fn.ligerLayout=function(){return a.ligerui.run.call(this,"ligerLayout",arguments)},a.fn.ligerGetLayoutManager=function(){return a.ligerui.run.call(this,"ligerGetLayoutManager",arguments)},a.ligerDefaults.Layout={topHeight:50,bottomHeight:50,leftWidth:110,centerWidth:300,rightWidth:170,InWindow:!0,heightDiff:0,height:"100%",onHeightChanged:null,isLeftCollapse:!1,isRightCollapse:!1,allowLeftCollapse:!0,allowRightCollapse:!0,allowLeftResize:!0,allowRightResize:!0,allowTopResize:!0,allowBottomResize:!0,space:3,onEndResize:null,minLeftWidth:80,minRightWidth:80},a.ligerMethos.Layout={},a.ligerui.controls.Layout=function(b,c){a.ligerui.controls.Layout.base.constructor.call(this,b,c)},a.ligerui.controls.Layout.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Layout"},__idPrev:function(){return"Layout"},_extendMethods:function(){return a.ligerMethos.Layout},_render:function(){var b,c,d,e,f=this,g=this.options;f.layout=a(this.element),f.layout.addClass("l-layout"),f.width=f.layout.width(),a("> div[position=top]",f.layout).length>0&&(f.top=a("> div[position=top]",f.layout).wrap('<div class="l-layout-top" style="top:0px;"></div>').parent(),f.top.content=a("> div[position=top]",f.top),f.top.content.hasClass("l-layout-content")||f.top.content.addClass("l-layout-content"),f.topHeight=g.topHeight,f.topHeight&&f.top.height(f.topHeight)),a("> div[position=bottom]",f.layout).length>0&&(f.bottom=a("> div[position=bottom]",f.layout).wrap('<div class="l-layout-bottom"></div>').parent(),f.bottom.content=a("> div[position=bottom]",f.bottom),f.bottom.content.hasClass("l-layout-content")||f.bottom.content.addClass("l-layout-content"),f.bottomHeight=g.bottomHeight,f.bottomHeight&&f.bottom.height(f.bottomHeight),b=f.bottom.content.attr("title"),b&&(f.bottom.header=a('<div class="l-layout-header"></div>'),f.bottom.prepend(f.bottom.header),f.bottom.header.html(b),f.bottom.content.attr("title",""))),a("> div[position=left]",f.layout).length>0&&(f.left=a("> div[position=left]",f.layout).wrap('<div class="l-layout-left" style="left:0px;"></div>').parent(),f.left.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>'),f.left.prepend(f.left.header),f.left.header.toggle=a(".l-layout-header-toggle",f.left.header),f.left.content=a("> div[position=left]",f.left),f.left.content.hasClass("l-layout-content")||f.left.content.addClass("l-layout-content"),g.allowLeftCollapse||a(".l-layout-header-toggle",f.left.header).remove(),c=f.left.content.attr("title"),c&&(f.left.content.attr("title",""),a(".l-layout-header-inner",f.left.header).html(c)),f.leftWidth=g.leftWidth,f.leftWidth&&f.left.width(f.leftWidth)),a("> div[position=center]",f.layout).length>0&&(f.center=a("> div[position=center]",f.layout).wrap('<div class="l-layout-center" ></div>').parent(),f.center.content=a("> div[position=center]",f.center),f.center.content.addClass("l-layout-content"),d=f.center.content.attr("title"),d&&(f.center.content.attr("title",""),f.center.header=a('<div class="l-layout-header"></div>'),f.center.prepend(f.center.header),f.center.header.html(d)),f.centerWidth=g.centerWidth,f.centerWidth&&f.center.width(f.centerWidth)),a("> div[position=right]",f.layout).length>0&&(f.right=a("> div[position=right]",f.layout).wrap('<div class="l-layout-right"></div>').parent(),f.right.header=a('<div class="l-layout-header"><div class="l-layout-header-toggle"></div><div class="l-layout-header-inner"></div></div>'),f.right.prepend(f.right.header),f.right.header.toggle=a(".l-layout-header-toggle",f.right.header),g.allowRightCollapse||a(".l-layout-header-toggle",f.right.header).remove(),f.right.content=a("> div[position=right]",f.right),f.right.content.hasClass("l-layout-content")||f.right.content.addClass("l-layout-content"),e=f.right.content.attr("title"),e&&(f.right.content.attr("title",""),a(".l-layout-header-inner",f.right.header).html(e)),f.rightWidth=g.rightWidth,f.rightWidth&&f.right.width(f.rightWidth)),f.layout.lock=a("<div class='l-layout-lock'></div>"),f.layout.append(f.layout.lock),f._addDropHandle(),f.isLeftCollapse=g.isLeftCollapse,f.isRightCollapse=g.isRightCollapse,f.leftCollapse=a('<div class="l-layout-collapse-left" style="display: none; "><div class="l-layout-collapse-left-toggle"></div></div>'),f.rightCollapse=a('<div class="l-layout-collapse-right" style="display: none; "><div class="l-layout-collapse-right-toggle"></div></div>'),f.layout.append(f.leftCollapse).append(f.rightCollapse),f.leftCollapse.toggle=a("> .l-layout-collapse-left-toggle",f.leftCollapse),f.rightCollapse.toggle=a("> .l-layout-collapse-right-toggle",f.rightCollapse),f._setCollapse(),f._bulid(),a(window).resize(function(){f._onResize()
}),f.set(g)},setLeftCollapse:function(a){var b=this;return this.options,b.left?(b.isLeftCollapse=a,b.isLeftCollapse?(b.leftCollapse.show(),b.leftDropHandle&&b.leftDropHandle.hide(),b.left.hide()):(b.leftCollapse.hide(),b.leftDropHandle&&b.leftDropHandle.show(),b.left.show()),b._onResize(),void 0):!1},setRightCollapse:function(a){var b=this;return this.options,b.right?(b.isRightCollapse=a,b._onResize(),b.isRightCollapse?(b.rightCollapse.show(),b.rightDropHandle&&b.rightDropHandle.hide(),b.right.hide()):(b.rightCollapse.hide(),b.rightDropHandle&&b.rightDropHandle.show(),b.right.show()),b._onResize(),void 0):!1},_bulid:function(){var b=this,c=this.options;a("> .l-layout-left .l-layout-header,> .l-layout-right .l-layout-header",b.layout).hover(function(){a(this).addClass("l-layout-header-over")},function(){a(this).removeClass("l-layout-header-over")}),a(".l-layout-header-toggle",b.layout).hover(function(){a(this).addClass("l-layout-header-toggle-over")},function(){a(this).removeClass("l-layout-header-toggle-over")}),a(".l-layout-header-toggle",b.left).click(function(){b.setLeftCollapse(!0)}),a(".l-layout-header-toggle",b.right).click(function(){b.setRightCollapse(!0)}),b.middleTop=0,b.top&&(b.middleTop+=b.top.height(),b.middleTop+=parseInt(b.top.css("borderTopWidth")),b.middleTop+=parseInt(b.top.css("borderBottomWidth")),b.middleTop+=c.space),b.left&&(b.left.css({top:b.middleTop}),b.leftCollapse.css({top:b.middleTop})),b.center&&b.center.css({top:b.middleTop}),b.right&&(b.right.css({top:b.middleTop}),b.rightCollapse.css({top:b.middleTop})),b.left&&b.left.css({left:0}),b._onResize(),b._onResize()},_setCollapse:function(){var b=this;this.options,b.leftCollapse.hover(function(){a(this).addClass("l-layout-collapse-left-over")},function(){a(this).removeClass("l-layout-collapse-left-over")}),b.leftCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-left-toggle-over")},function(){a(this).removeClass("l-layout-collapse-left-toggle-over")}),b.rightCollapse.hover(function(){a(this).addClass("l-layout-collapse-right-over")},function(){a(this).removeClass("l-layout-collapse-right-over")}),b.rightCollapse.toggle.hover(function(){a(this).addClass("l-layout-collapse-right-toggle-over")},function(){a(this).removeClass("l-layout-collapse-right-toggle-over")}),b.leftCollapse.toggle.click(function(){b.setLeftCollapse(!1)}),b.rightCollapse.toggle.click(function(){b.setRightCollapse(!1)}),b.left&&b.isLeftCollapse&&(b.leftCollapse.show(),b.leftDropHandle&&b.leftDropHandle.hide(),b.left.hide()),b.right&&b.isRightCollapse&&(b.rightCollapse.show(),b.rightDropHandle&&b.rightDropHandle.hide(),b.right.hide())},_addDropHandle:function(){var b=this,c=this.options;b.left&&c.allowLeftResize&&(b.leftDropHandle=a("<div class='l-layout-drophandle-left'></div>"),b.layout.append(b.leftDropHandle),b.leftDropHandle&&b.leftDropHandle.show(),b.leftDropHandle.mousedown(function(a){b._start("leftresize",a)})),b.right&&c.allowRightResize&&(b.rightDropHandle=a("<div class='l-layout-drophandle-right'></div>"),b.layout.append(b.rightDropHandle),b.rightDropHandle&&b.rightDropHandle.show(),b.rightDropHandle.mousedown(function(a){b._start("rightresize",a)})),b.top&&c.allowTopResize&&(b.topDropHandle=a("<div class='l-layout-drophandle-top'></div>"),b.layout.append(b.topDropHandle),b.topDropHandle.show(),b.topDropHandle.mousedown(function(a){b._start("topresize",a)})),b.bottom&&c.allowBottomResize&&(b.bottomDropHandle=a("<div class='l-layout-drophandle-bottom'></div>"),b.layout.append(b.bottomDropHandle),b.bottomDropHandle.show(),b.bottomDropHandle.mousedown(function(a){b._start("bottomresize",a)})),b.draggingxline=a("<div class='l-layout-dragging-xline'></div>"),b.draggingyline=a("<div class='l-layout-dragging-yline'></div>"),b.layout.append(b.draggingxline).append(b.draggingyline)},_setDropHandlePosition:function(){var a=this,b=this.options;a.leftDropHandle&&a.leftDropHandle.css({left:a.left.width()+parseInt(a.left.css("left")),height:a.middleHeight,top:a.middleTop}),a.rightDropHandle&&a.rightDropHandle.css({left:parseInt(a.right.css("left"))-b.space,height:a.middleHeight,top:a.middleTop}),a.topDropHandle&&a.topDropHandle.css({top:a.top.height()+parseInt(a.top.css("top")),width:a.top.width()}),a.bottomDropHandle&&a.bottomDropHandle.css({top:parseInt(a.bottom.css("top"))-b.space,width:a.bottom.width()})},_onResize:function(){var b,c,d=this,e=this.options,f=d.layout.height(),g=0,h=a(window).height(),i=null;"string"==typeof e.height&&e.height.indexOf("%")>0?(b=d.layout.parent(),e.InWindow||"body"==b[0].tagName.toLowerCase()?(i=h,i-=parseInt(a("body").css("paddingTop")),i-=parseInt(a("body").css("paddingBottom"))):i=b.height(),g=.01*i*parseFloat(e.height),(e.InWindow||"body"==b[0].tagName.toLowerCase())&&(g-=d.layout.offset().top-parseInt(a("body").css("paddingTop")))):g=parseInt(e.height),g+=e.heightDiff,d.layout.height(g),d.layoutHeight=d.layout.height(),d.middleWidth=d.layout.width(),d.middleHeight=d.layout.height(),d.top&&(d.middleHeight-=d.top.height(),d.middleHeight-=parseInt(d.top.css("borderTopWidth")),d.middleHeight-=parseInt(d.top.css("borderBottomWidth")),d.middleHeight-=e.space),d.bottom&&(d.middleHeight-=d.bottom.height(),d.middleHeight-=parseInt(d.bottom.css("borderTopWidth")),d.middleHeight-=parseInt(d.bottom.css("borderBottomWidth")),d.middleHeight-=e.space),d.middleHeight-=2,d.hasBind("heightChanged")&&d.layoutHeight!=f&&d.trigger("heightChanged",[{layoutHeight:d.layoutHeight,diff:d.layoutHeight-f,middleHeight:d.middleHeight}]),d.center&&(d.centerWidth=d.middleWidth,d.left&&(d.isLeftCollapse?(d.centerWidth-=d.leftCollapse.width(),d.centerWidth-=parseInt(d.leftCollapse.css("borderLeftWidth")),d.centerWidth-=parseInt(d.leftCollapse.css("borderRightWidth")),d.centerWidth-=parseInt(d.leftCollapse.css("left")),d.centerWidth-=e.space):(d.centerWidth-=d.leftWidth,d.centerWidth-=parseInt(d.left.css("borderLeftWidth")),d.centerWidth-=parseInt(d.left.css("borderRightWidth")),d.centerWidth-=parseInt(d.left.css("left")),d.centerWidth-=e.space)),d.right&&(d.isRightCollapse?(d.centerWidth-=d.rightCollapse.width(),d.centerWidth-=parseInt(d.rightCollapse.css("borderLeftWidth")),d.centerWidth-=parseInt(d.rightCollapse.css("borderRightWidth")),d.centerWidth-=parseInt(d.rightCollapse.css("right")),d.centerWidth-=e.space):(d.centerWidth-=d.rightWidth,d.centerWidth-=parseInt(d.right.css("borderLeftWidth")),d.centerWidth-=parseInt(d.right.css("borderRightWidth")),d.centerWidth-=e.space)),d.centerLeft=0,d.left&&(d.isLeftCollapse?(d.centerLeft+=d.leftCollapse.width(),d.centerLeft+=parseInt(d.leftCollapse.css("borderLeftWidth")),d.centerLeft+=parseInt(d.leftCollapse.css("borderRightWidth")),d.centerLeft+=parseInt(d.leftCollapse.css("left")),d.centerLeft+=e.space):(d.centerLeft+=d.left.width(),d.centerLeft+=parseInt(d.left.css("borderLeftWidth")),d.centerLeft+=parseInt(d.left.css("borderRightWidth")),d.centerLeft+=e.space)),d.center.css({left:d.centerLeft}),d.center.width(d.centerWidth),d.center.height(d.middleHeight),c=d.middleHeight,d.center.header&&(c-=d.center.header.height()),d.center.content.height(c)),d.left&&(d.leftCollapse.height(d.middleHeight),d.left.height(d.middleHeight)),d.right&&(d.rightCollapse.height(d.middleHeight),d.right.height(d.middleHeight),d.rightLeft=0,d.left&&(d.isLeftCollapse?(d.rightLeft+=d.leftCollapse.width(),d.rightLeft+=parseInt(d.leftCollapse.css("borderLeftWidth")),d.rightLeft+=parseInt(d.leftCollapse.css("borderRightWidth")),d.rightLeft+=e.space):(d.rightLeft+=d.left.width(),d.rightLeft+=parseInt(d.left.css("borderLeftWidth")),d.rightLeft+=parseInt(d.left.css("borderRightWidth")),d.rightLeft+=parseInt(d.left.css("left")),d.rightLeft+=e.space)),d.center&&(d.rightLeft+=d.center.width(),d.rightLeft+=parseInt(d.center.css("borderLeftWidth")),d.rightLeft+=parseInt(d.center.css("borderRightWidth")),d.rightLeft+=e.space),d.right.css({left:d.rightLeft})),d.bottom&&(d.bottomTop=d.layoutHeight-d.bottom.height()-2,d.bottom.css({top:d.bottomTop})),d._setDropHandlePosition()},_start:function(b,c){var d=this;if(this.options,d.dragtype=b,"leftresize"==b||"rightresize"==b)d.xresize={startX:c.pageX},d.draggingyline.css({left:c.pageX-d.layout.offset().left,height:d.middleHeight,top:d.middleTop}).show(),a("body").css("cursor","col-resize");else{if("topresize"!=b&&"bottomresize"!=b)return;d.yresize={startY:c.pageY},d.draggingxline.css({top:c.pageY-d.layout.offset().top,width:d.layout.width()}).show(),a("body").css("cursor","row-resize")}d.layout.lock.width(d.layout.width()),d.layout.lock.height(d.layout.height()),d.layout.lock.show(),(a.browser.msie||a.browser.safari)&&a("body").bind("selectstart",function(){return!1}),a(document).bind("mouseup",function(){d._stop.apply(d,arguments)}),a(document).bind("mousemove",function(){d._drag.apply(d,arguments)})},_drag:function(b){var c=this;this.options,c.xresize?(c.xresize.diff=b.pageX-c.xresize.startX,c.draggingyline.css({left:b.pageX-c.layout.offset().left}),a("body").css("cursor","col-resize")):c.yresize&&(c.yresize.diff=b.pageY-c.yresize.startY,c.draggingxline.css({top:b.pageY-c.layout.offset().top}),a("body").css("cursor","row-resize"))},_stop:function(b){var c,d=this,e=this.options;if(d.xresize&&void 0!=d.xresize.diff){if(c=d.xresize.diff,"leftresize"==d.dragtype){if(e.minLeftWidth&&d.leftWidth+d.xresize.diff<e.minLeftWidth)return;d.leftWidth+=d.xresize.diff,d.left.width(d.leftWidth),d.center?d.center.width(d.center.width()-d.xresize.diff).css({left:parseInt(d.center.css("left"))+d.xresize.diff}):d.right&&d.right.width(d.left.width()-d.xresize.diff).css({left:parseInt(d.right.css("left"))+d.xresize.diff})}else if("rightresize"==d.dragtype){if(e.minRightWidth&&d.rightWidth-d.xresize.diff<e.minRightWidth)return;d.rightWidth-=d.xresize.diff,d.right.width(d.rightWidth).css({left:parseInt(d.right.css("left"))+d.xresize.diff}),d.center?d.center.width(d.center.width()+d.xresize.diff):d.left&&d.left.width(d.left.width()+d.xresize.diff)}}else d.yresize&&void 0!=d.yresize.diff&&(c=d.yresize.diff,"topresize"==d.dragtype?(d.top.height(d.top.height()+d.yresize.diff),d.middleTop+=d.yresize.diff,d.middleHeight-=d.yresize.diff,d.left&&(d.left.css({top:d.middleTop}).height(d.middleHeight),d.leftCollapse.css({top:d.middleTop}).height(d.middleHeight)),d.center&&d.center.css({top:d.middleTop}).height(d.middleHeight),d.right&&(d.right.css({top:d.middleTop}).height(d.middleHeight),d.rightCollapse.css({top:d.middleTop}).height(d.middleHeight))):"bottomresize"==d.dragtype&&(d.bottom.height(d.bottom.height()-d.yresize.diff),d.middleHeight+=d.yresize.diff,d.bottomTop+=d.yresize.diff,d.bottom.css({top:d.bottomTop}),d.left&&(d.left.height(d.middleHeight),d.leftCollapse.height(d.middleHeight)),d.center&&d.center.height(d.middleHeight),d.right&&(d.right.height(d.middleHeight),d.rightCollapse.height(d.middleHeight))));d.trigger("endResize",[{direction:d.dragtype?d.dragtype.replace(/resize/,""):"",diff:c},b]),d._setDropHandlePosition(),d.draggingxline.hide(),d.draggingyline.hide(),d.xresize=d.yresize=d.dragtype=!1,d.layout.lock.hide(),(a.browser.msie||a.browser.safari)&&a("body").unbind("selectstart"),a(document).unbind("mousemove",d._drag),a(document).unbind("mouseup",d._stop),a("body").css("cursor","")}})}(jQuery),function(a){a.ligerMenu=function(){return a.ligerui.run.call(null,"ligerMenu",arguments)},a.ligerDefaults.Menu={width:120,top:0,left:0,items:null,shadow:!0},a.ligerMethos.Menu={},a.ligerui.controls.Menu=function(b){a.ligerui.controls.Menu.base.constructor.call(this,null,b)},a.ligerui.controls.Menu.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Menu"},__idPrev:function(){return"Menu"},_extendMethods:function(){return a.ligerMethos.Menu},_render:function(){var b=this,c=this.options;b.menuItemCount=0,b.menus={},b.menu=b.createMenu(),b.element=b.menu[0],b.menu.css({top:c.top,left:c.left,width:c.width}),c.items&&a(c.items).each(function(a,c){b.addItem(c)}),a(document).bind("click.menu",function(){var a,c;for(a in b.menus){if(c=b.menus[a],!c)return;c.hide(),c.shadow&&c.shadow.hide()}}),b.set(c)},show:function(a,b){var c=this;this.options,void 0==b&&(b=c.menu),a&&void 0!=a.left&&b.css({left:a.left}),a&&void 0!=a.top&&b.css({top:a.top}),b.show(),c.updateShadow(b)},updateShadow:function(a){var b=this.options;b.shadow&&(a.shadow.css({left:a.css("left"),top:a.css("top"),width:a.outerWidth(),height:a.outerHeight()}),a.is(":visible")?a.shadow.show():a.shadow.hide())},hide:function(a){var b=this;this.options,void 0==a&&(a=b.menu),b.hideAllSubMenu(a),a.hide(),b.updateShadow(a)},toggle:function(){var a=this;this.options,a.menu.toggle(),a.updateShadow(a.menu)},removeItem:function(b){var c=this;this.options,a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).remove()},setEnabled:function(b){var c=this;this.options,a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).removeClass("l-menu-item-disable")},setDisabled:function(b){var c=this;this.options,a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).addClass("l-menu-item-disable")},isEnable:function(b){var c=this;return this.options,!a("> .l-menu-item[menuitemid="+b+"]",c.menu.items).hasClass("l-menu-item-disable")},getItemCount:function(){var b=this;return this.options,a("> .l-menu-item",b.menu.items).length},addItem:function(b,c){var d,e,f,g,h=this,i=this.options;if(b){if(void 0==c&&(c=h.menu),b.line)return c.items.append('<div class="l-menu-item-line"></div>'),void 0;d=a('<div class="l-menu-item"><div class="l-menu-item-text"></div> </div>'),e=a("> .l-menu-item",c.items).length,c.items.append(d),d.attr("ligeruimenutemid",++h.menuItemCount),b.id&&d.attr("menuitemid",b.id),b.img&&(d.prepend("<img src='"+b.img+"' />"),d.addClass("l-toolbar-item-hasicon")),b.text&&a(">.l-menu-item-text:first",d).html(b.text),b.icon&&d.prepend('<div class="l-menu-item-icon l-icon-'+b.icon+'"></div>'),(b.disable||b.disabled)&&d.addClass("l-menu-item-disable"),b.children&&(d.append('<div class="l-menu-item-arrow"></div>'),f=h.createMenu(d.attr("ligeruimenutemid")),h.menus[d.attr("ligeruimenutemid")]=f,f.width(i.width),f.hover(null,function(){f.showedSubMenu||h.hide(f)}),a(b.children).each(function(){h.addItem(this,f)})),b.click&&d.click(function(){a(this).hasClass("l-menu-item-disable")||b.click(b,e)}),b.dblclick&&d.dblclick(function(){a(this).hasClass("l-menu-item-disable")||b.dblclick(b,e)}),g=a("> .l-menu-over:first",c),d.hover(function(){var d,e,f;if(!a(this).hasClass("l-menu-item-disable")&&(d=a(this).offset().top,e=d-c.offset().top,g.css({top:e}),h.hideAllSubMenu(c),b.children)){if(f=a(this).attr("ligeruimenutemid"),!f)return;h.menus[f]&&(h.show({top:d,left:a(this).offset().left+a(this).width()-5},h.menus[f]),c.showedSubMenu=!0)}},function(){var c;a(this).hasClass("l-menu-item-disable")||(c=a(this).attr("ligeruimenutemid"),b.children&&(c=a(this).attr("ligeruimenutemid"),!c))})}},hideAllSubMenu:function(b){var c=this;this.options,void 0==b&&(b=c.menu),a("> .l-menu-item",b.items).each(function(){if(a("> .l-menu-item-arrow",this).length>0){var b=a(this).attr("ligeruimenutemid");if(!b)return;c.menus[b]&&c.hide(c.menus[b])}}),b.showedSubMenu=!1},createMenu:function(b){var c=this,d=this.options,e=a('<div class="l-menu" style="display:none"><div class="l-menu-yline"></div><div class="l-menu-over"><div class="l-menu-over-l"></div> <div class="l-menu-over-r"></div></div><div class="l-menu-inner"></div></div>');return b&&e.attr("ligeruiparentmenuitemid",b),e.items=a("> .l-menu-inner:first",e),e.appendTo("body"),d.shadow&&(e.shadow=a('<div class="l-menu-shadow"></div>').insertAfter(e),c.updateShadow(e)),e.hover(null,function(){e.showedSubMenu||a("> .l-menu-over:first",e).css({top:-24})}),b?c.menus[b]=e:c.menus[0]=e,e}}),a.ligerui.controls.Menu.prototype.setEnable=a.ligerui.controls.Menu.prototype.setEnabled,a.ligerui.controls.Menu.prototype.setDisable=a.ligerui.controls.Menu.prototype.setDisabled}(jQuery),function(a){a.fn.ligerMenuBar=function(){return a.ligerui.run.call(this,"ligerMenuBar",arguments)},a.fn.ligerGetMenuBarManager=function(){return a.ligerui.run.call(this,"ligerGetMenuBarManager",arguments)},a.ligerDefaults.MenuBar={},a.ligerMethos.MenuBar={},a.ligerui.controls.MenuBar=function(b,c){a.ligerui.controls.MenuBar.base.constructor.call(this,b,c)},a.ligerui.controls.MenuBar.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"MenuBar"},__idPrev:function(){return"MenuBar"},_extendMethods:function(){return a.ligerMethos.MenuBar},_render:function(){var b=this,c=this.options;b.menubar=a(this.element),b.menubar.hasClass("l-menubar")||b.menubar.addClass("l-menubar"),c&&c.items&&a(c.items).each(function(a,c){b.addItem(c)}),a(document).click(function(){a(".l-panel-btn-selected",b.menubar).removeClass("l-panel-btn-selected")}),b.set(c)},addItem:function(b){var c,d,e=this;this.options,c=a('<div class="l-menubar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div><div class="l-menubar-item-down"></div></div>'),e.menubar.append(c),b.id&&c.attr("menubarid",b.id),b.text&&a("span:first",c).html(b.text),b.disable&&c.addClass("l-menubar-item-disable"),b.click&&c.click(function(){b.click(b)}),b.menu?(d=a.ligerMenu(b.menu),c.hover(function(){var b,c;e.actionMenu&&e.actionMenu.hide(),b=a(this).offset().left,c=a(this).offset().top+a(this).height(),d.show({top:c,left:b}),e.actionMenu=d,a(this).addClass("l-panel-btn-over l-panel-btn-selected").siblings(".l-menubar-item").removeClass("l-panel-btn-selected")},function(){a(this).removeClass("l-panel-btn-over")})):(c.hover(function(){a(this).addClass("l-panel-btn-over")},function(){a(this).removeClass("l-panel-btn-over")}),a(".l-menubar-item-down",c).remove())}})}(jQuery),function(a){a.ligerMessageBox=function(){return a.ligerui.run.call(null,"ligerMessageBox",arguments,{isStatic:!0})},a.ligerDefaults.MessageBox={isDrag:!0},a.ligerMethos.MessageBox={},a.ligerui.controls.MessageBox=function(b){a.ligerui.controls.MessageBox.base.constructor.call(this,null,b)},a.ligerui.controls.MessageBox.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"MessageBox"},__idPrev:function(){return"MessageBox"},_extendMethods:function(){return a.ligerMethos.MessageBox},_render:function(){var b,c,d,e,f,g=this,h=this.options,i="";i+='<div class="l-messagebox">',i+='        <div class="l-messagebox-lt"></div><div class="l-messagebox-rt"></div>',i+='        <div class="l-messagebox-l"></div><div class="l-messagebox-r"></div> ',i+='        <div class="l-messagebox-image"></div>',i+='        <div class="l-messagebox-title">',i+='            <div class="l-messagebox-title-inner"></div>',i+='            <div class="l-messagebox-close"></div>',i+="        </div>",i+='        <div class="l-messagebox-content">',i+="        </div>",i+='        <div class="l-messagebox-buttons"><div class="l-messagebox-buttons-inner">',i+="        </div></div>",i+="    </div>",g.messageBox=a(i),a("body").append(g.messageBox),g.messageBox.close=function(){g._removeWindowMask(),g.messageBox.remove()},h.width&&g.messageBox.width(h.width),h.title&&a(".l-messagebox-title-inner",g.messageBox).html(h.title),h.content&&a(".l-messagebox-content",g.messageBox).html(h.content),h.buttons&&(a(h.buttons).each(function(b,c){var d=a('<div class="l-messagebox-btn"><div class="l-messagebox-btn-l"></div><div class="l-messagebox-btn-r"></div><div class="l-messagebox-btn-inner"></div></div>');a(".l-messagebox-btn-inner",d).html(c.text),a(".l-messagebox-buttons-inner",g.messageBox).append(d),c.width&&d.width(c.width),c.onclick&&d.click(function(){c.onclick(c,b,g.messageBox)})}),a(".l-messagebox-buttons-inner",g.messageBox).append("<div class='l-clear'></div>")),b=g.messageBox.width(),c=0,a(".l-messagebox-buttons-inner .l-messagebox-btn",g.messageBox).each(function(){c+=a(this).width()}),a(".l-messagebox-buttons-inner",g.messageBox).css({marginLeft:parseInt(.5*(b-c))}),g._applyWindowMask(),g._applyDrag(),g._setImage(),d=0,e=0,f=h.width||g.messageBox.width(),null!=h.left?d=h.left:h.left=d=.5*(a(window).width()-f),null!=h.top?e=h.top:h.top=e=.5*(a(window).height()-g.messageBox.height())+a(window).scrollTop()-10,0>d&&(h.left=d=0),0>e&&(h.top=e=0),g.messageBox.css({left:d,top:e}),a(".l-messagebox-btn",g.messageBox).hover(function(){a(this).addClass("l-messagebox-btn-over")},function(){a(this).removeClass("l-messagebox-btn-over")}),a(".l-messagebox-close",g.messageBox).hover(function(){a(this).addClass("l-messagebox-close-over")},function(){a(this).removeClass("l-messagebox-close-over")}).click(function(){g.messageBox.close()}),g.set(h)},close:function(){this.options,this.g._removeWindowMask(),this.messageBox.remove()},_applyWindowMask:function(){this.options,a(".l-window-mask").remove(),a("<div class='l-window-mask' style='display: block;'></div>").appendTo(a("body"))},_removeWindowMask:function(){this.options,a(".l-window-mask").remove()},_applyDrag:function(){var b=this,c=this.options;c.isDrag&&a.fn.ligerDrag&&b.messageBox.ligerDrag({handler:".l-messagebox-title-inner",animate:!1})},_setImage:function(){var b=this,c=this.options;c.type&&("success"==c.type||"donne"==c.type?(a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-donne").show(),a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})):"error"==c.type?(a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-error").show(),a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})):"warn"==c.type?(a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-warn").show(),a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:30})):"question"==c.type&&(a(".l-messagebox-image",b.messageBox).addClass("l-messagebox-image-question").show(),a(".l-messagebox-content",b.messageBox).css({paddingLeft:64,paddingBottom:40})))}}),a.ligerMessageBox.show=function(b){return a.ligerMessageBox(b)},a.ligerMessageBox.alert=function(b,c,d,e){b=b||"",c=c||b;var f=function(a,b,c){c.close(),e&&e(a,b,c)};return p={title:b,content:c,buttons:[{text:"确定",onclick:f}]},d&&(p.type=d),a.ligerMessageBox(p)},a.ligerMessageBox.confirm=function(b,c,d){var e=function(a,b,c){c.close(),d&&d(0==b)};return p={type:"question",title:b,content:c,buttons:[{text:"是",onclick:e},{text:"否",onclick:e}]},a.ligerMessageBox(p)},a.ligerMessageBox.success=function(b,c,d){return a.ligerMessageBox.alert(b,c,"success",d)},a.ligerMessageBox.error=function(b,c,d){return a.ligerMessageBox.alert(b,c,"error",d)},a.ligerMessageBox.warn=function(b,c,d){return a.ligerMessageBox.alert(b,c,"warn",d)},a.ligerMessageBox.question=function(b,c){return a.ligerMessageBox.alert(b,c,"question")}}(jQuery),function(a){a.fn.ligerRadio=function(){return a.ligerui.run.call(this,"ligerRadio",arguments)},a.fn.ligerGetRadioManager=function(){return a.ligerui.run.call(this,"ligerGetRadioManager",arguments)},a.ligerDefaults.Radio={disabled:!1},a.ligerMethos.Radio={},a.ligerui.controls.Radio=function(b,c){a.ligerui.controls.Radio.base.constructor.call(this,b,c)},a.ligerui.controls.Radio.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Radio"},__idPrev:function(){return"Radio"},_extendMethods:function(){return a.ligerMethos.Radio},_render:function(){var b=this,c=this.options;b.input=a(this.element),b.link=a('<a href="javascript:void(0)" class="l-radio"></a>'),b.wrapper=b.input.addClass("l-hidden").wrap('<div class="l-radio-wrapper"></div>').parent(),b.wrapper.prepend(b.link),b.input.change(function(){return this.checked?b.link.addClass("l-radio-checked"):b.link.removeClass("l-radio-checked"),!0}),b.link.click(function(){b._doclick()}),b.wrapper.hover(function(){c.disabled||a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),this.element.checked&&b.link.addClass("l-radio-checked"),this.element.id&&a("label[for="+this.element.id+"]").click(function(){b._doclick()}),b.set(c)},setValue:function(a){var b=this;this.options,a?(b.input[0].checked=!0,b.link.addClass("l-radio-checked")):(b.input[0].checked=!1,b.link.removeClass("l-radio-checked"))},getValue:function(){return this.input[0].checked},setEnabled:function(){this.input.attr("disabled",!1),this.wrapper.removeClass("l-disabled"),this.options.disabled=!1},setDisabled:function(){this.input.attr("disabled",!0),this.wrapper.addClass("l-disabled"),this.options.disabled=!0},updateStyle:function(){this.input.attr("disabled")&&(this.wrapper.addClass("l-disabled"),this.options.disabled=!0),this.input[0].checked?this.link.addClass("l-checkbox-checked"):this.link.removeClass("l-checkbox-checked")},_doclick:function(){var b,c=this;return this.options,c.input.attr("disabled")?!1:(c.input.trigger("click").trigger("change"),b=c.input[0].form?c.input[0].form:document,a("input:radio[name="+c.input[0].name+"]",b).not(c.input).trigger("change"),!1)}})}(jQuery),function(a){a.fn.ligerResizable=function(){return a.ligerui.run.call(this,"ligerResizable",arguments,{idAttrName:"ligeruiresizableid",hasElement:!1,propertyToElemnt:"target"})},a.fn.ligerGetResizableManager=function(){return a.ligerui.run.call(this,"ligerGetResizableManager",arguments,{idAttrName:"ligeruiresizableid",hasElement:!1,propertyToElemnt:"target"})},a.ligerDefaults.Resizable={handles:"n, e, s, w, ne, se, sw, nw",maxWidth:2e3,maxHeight:2e3,minWidth:20,minHeight:20,scope:3,animate:!1,onStartResize:function(){},onResize:function(){},onStopResize:function(){},onEndResize:null},a.ligerui.controls.Resizable=function(b){a.ligerui.controls.Resizable.base.constructor.call(this,null,b)},a.ligerui.controls.Resizable.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Resizable"},__idPrev:function(){return"Resizable"},_render:function(){var b=this,c=this.options;b.target=a(c.target),b.set(c),b.target.mousemove(function(d){if(!c.disabled&&(b.dir=b._getDir(d),b.dir?b.target.css("cursor",b.dir+"-resize"):b.target.css("cursor").indexOf("-resize")>0&&b.target.css("cursor","default"),c.target.ligeruidragid)){var e=a.ligerui.get(c.target.ligeruidragid);e&&b.dir?e.set("disabled",!0):e&&e.set("disabled",!1)}}).mousedown(function(a){c.disabled||b.dir&&b._start(a)})},_rendered:function(){this.options.target.ligeruiresizableid=this.id},_getDir:function(b){var c=this,d=this.options,e="",f=c.target.offset(),g=c.target.width(),h=c.target.height(),i=d.scope,j=b.pageX||b.screenX,k=b.pageY||b.screenY;return k>=f.top&&k<f.top+i?e+="n":k<=f.top+h&&k>f.top+h-i&&(e+="s"),j>=f.left&&j<f.left+i?e+="w":j<=f.left+g&&j>f.left+g-i&&(e+="e"),"all"==d.handles||""==e?e:-1!=a.inArray(e,c.handles)?e:""},_setHandles:function(a){a&&(this.handles=a.replace(/(\s*)/g,"").split(","))},_createProxy:function(){var b=this;b.proxy=a('<div class="l-resizable"></div>'),b.proxy.width(b.target.width()).height(b.target.height()),b.proxy.attr("resizableid",b.id).appendTo("body")},_removeProxy:function(){var a=this;a.proxy&&(a.proxy.remove(),a.proxy=null)},_start:function(b){var c=this;this.options,c._createProxy(),c.proxy.css({left:c.target.offset().left,top:c.target.offset().top,position:"absolute"}),c.current={dir:c.dir,left:c.target.offset().left,top:c.target.offset().top,startX:b.pageX||b.screenX,startY:b.pageY||b.clientY,width:c.target.width(),height:c.target.height()},a(document).bind("selectstart.resizable",function(){return!1}),a(document).bind("mouseup.resizable",function(){c._stop.apply(c,arguments)}),a(document).bind("mousemove.resizable",function(){c._drag.apply(c,arguments)}),c.proxy.show(),c.trigger("startResize",[c.current,b])},changeBy:{t:["n","ne","nw"],l:["w","sw","nw"],w:["w","sw","nw","e","ne","se"],h:["n","ne","nw","s","se","sw"]},_drag:function(a){var b,c,d=this;this.options,d.current&&d.proxy&&(d.proxy.css("cursor",""==d.current.dir?"default":d.current.dir+"-resize"),b=a.pageX||a.screenX,c=a.pageY||a.screenY,d.current.diffX=b-d.current.startX,d.current.diffY=c-d.current.startY,d._applyResize(d.proxy),d.trigger("resize",[d.current,a]))},_stop:function(b){var c=this;this.options,c.hasBind("stopResize")?0!=c.trigger("stopResize",[c.current,b])&&c._applyResize():c._applyResize(),c._removeProxy(),c.trigger("endResize",[c.current,b]),a(document).unbind("selectstart.resizable"),a(document).unbind("mousemove.resizable"),a(document).unbind("mouseup.resizable")},_applyResize:function(b){var c=this,d=this.options,e={left:c.current.left,top:c.current.top,width:c.current.width,height:c.current.height},f=!1;b||(b=c.target,f=!0,e.top=isNaN(parseInt(c.target.css("top")))?0:parseInt(c.target.css("top")),e.left=isNaN(parseInt(c.target.css("left")))?0:parseInt(c.target.css("left"))),a.inArray(c.current.dir,c.changeBy.l)>-1?(e.left+=c.current.diffX,c.current.diffLeft=c.current.diffX):f&&delete e.left,a.inArray(c.current.dir,c.changeBy.t)>-1?(e.top+=c.current.diffY,c.current.diffTop=c.current.diffY):f&&delete e.top,a.inArray(c.current.dir,c.changeBy.w)>-1?(e.width+=(-1==c.current.dir.indexOf("w")?1:-1)*c.current.diffX,c.current.newWidth=e.width):f&&delete e.width,a.inArray(c.current.dir,c.changeBy.h)>-1?(e.height+=(-1==c.current.dir.indexOf("n")?1:-1)*c.current.diffY,c.current.newHeight=e.height):f&&delete e.height,f&&d.animate?b.animate(e):b.css(e)}})}(jQuery),function(a){a.fn.ligerSpinner=function(){return a.ligerui.run.call(this,"ligerSpinner",arguments)},a.fn.ligerGetSpinnerManager=function(){return a.ligerui.run.call(this,"ligerGetSpinnerManager",arguments)},a.ligerDefaults.Spinner={type:"float",isNegative:!0,decimalplace:2,step:.1,interval:50,onChangeValue:!1,minValue:null,maxValue:null,disabled:!1},a.ligerMethos.Spinner={},a.ligerui.controls.Spinner=function(b,c){a.ligerui.controls.Spinner.base.constructor.call(this,b,c)},a.ligerui.controls.Spinner.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"Spinner"},__idPrev:function(){return"Spinner"},_extendMethods:function(){return a.ligerMethos.Spinner},_init:function(){a.ligerui.controls.Spinner.base._init.call(this);var b=this.options;"float"==b.type?(b.step=.1,b.interval=50):"int"==b.type?(b.step=1,b.interval=100):"time"==b.type&&(b.step=1,b.interval=100)},_render:function(){var b=this,c=this.options;b.interval=null,b.inputText=null,b.value=null,b.textFieldID="","input"==this.element.tagName.toLowerCase()&&this.element.type&&"text"==this.element.type?(b.inputText=a(this.element),this.element.id&&(b.textFieldID=this.element.id)):(b.inputText=a('<input type="text"/>'),b.inputText.appendTo(a(this.element))),""==b.textFieldID&&c.textFieldID&&(b.textFieldID=c.textFieldID),b.link=a('<div class="l-trigger"><div class="l-spinner-up"><div class="l-spinner-icon"></div></div><div class="l-spinner-split"></div><div class="l-spinner-down"><div class="l-spinner-icon"></div></div></div>'),b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent(),b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),b.wrapper.append(b.link).after(b.selectBox).after(b.valueField),b.link.up=a(".l-spinner-up",b.link),b.link.down=a(".l-spinner-down",b.link),b.inputText.addClass("l-text-field"),c.disabled&&b.wrapper.addClass("l-text-disabled"),b._isVerify(b.inputText.val())||(b.value=b._getDefaultValue(),b.inputText.val(b.value)),b.link.up.hover(function(){c.disabled||a(this).addClass("l-spinner-up-over")},function(){clearInterval(b.interval),a(document).unbind("selectstart.spinner"),a(this).removeClass("l-spinner-up-over")}).mousedown(function(){c.disabled||(b._uping.call(b),b.interval=setInterval(function(){b._uping.call(b)},c.interval),a(document).bind("selectstart.spinner",function(){return!1}))}).mouseup(function(){clearInterval(b.interval),b.inputText.trigger("change").focus(),a(document).unbind("selectstart.spinner")}),b.link.down.hover(function(){c.disabled||a(this).addClass("l-spinner-down-over")},function(){clearInterval(b.interval),a(document).unbind("selectstart.spinner"),a(this).removeClass("l-spinner-down-over")}).mousedown(function(){c.disabled||(b.interval=setInterval(function(){b._downing.call(b)},c.interval),a(document).bind("selectstart.spinner",function(){return!1}))}).mouseup(function(){clearInterval(b.interval),b.inputText.trigger("change").focus(),a(document).unbind("selectstart.spinner")
}),b.inputText.change(function(){var a=b.inputText.val();b.value=b._getVerifyValue(a),b.trigger("changeValue",[b.value]),b.inputText.val(b.value)}).blur(function(){b.wrapper.removeClass("l-text-focus")}).focus(function(){b.wrapper.addClass("l-text-focus")}),b.wrapper.hover(function(){c.disabled||b.wrapper.addClass("l-text-over")},function(){b.wrapper.removeClass("l-text-over")}),b.set(c)},_setWidth:function(a){var b=this;a>20&&(b.wrapper.css({width:a}),b.inputText.css({width:a-20}))},_setHeight:function(a){var b=this;a>10&&(b.wrapper.height(a),b.inputText.height(a-2),b.link.height(a-4))},_setDisabled:function(a){a?this.wrapper.addClass("l-text-disabled"):this.wrapper.removeClass("l-text-disabled")},setValue:function(a){this.inputText.val(a)},getValue:function(){return this.inputText.val()},_round:function(a,b){this.options;for(var c=1;b>0;c*=10,b--);for(;0>b;c/=10,b++);return Math.round(a*c)/c},_isInt:function(a){var b=this.options,c=b.isNegative?/^-?\d+$/:/^\d+$/;return c.test(a)?parseFloat(a)!=a?!1:!0:!1},_isFloat:function(a){var b=this.options,c=b.isNegative?/^-?\d+(\.\d+)?$/:/^\d+(\.\d+)?$/;return c.test(a)?parseFloat(a)!=a?!1:!0:!1},_isTime:function(a){this.options;var b=a.match(/^(\d{1,2}):(\d{1,2})$/);return null==b?!1:b[1]>24||b[2]>60?!1:!0},_isVerify:function(a){var b,c=this,d=this.options;return"float"==d.type?c._isFloat(a)?(b=parseFloat(a),void 0!=d.minValue&&d.minValue>b?!1:void 0!=d.maxValue&&d.maxValue<b?!1:!0):!1:"int"==d.type?c._isInt(a)?(b=parseInt(a),void 0!=d.minValue&&d.minValue>b?!1:void 0!=d.maxValue&&d.maxValue<b?!1:!0):!1:"time"==d.type?c._isTime(a):!1},_getVerifyValue:function(a){var b=this,c=this.options,d=null;return"float"==c.type?d=b._round(a,c.decimalplace):"int"==c.type?d=parseInt(a):"time"==c.type&&(d=a),b._isVerify(d)?d:b.value},_isOverValue:function(a){var b=this.options;return null!=b.minValue&&b.minValue>a?!0:null!=b.maxValue&&b.maxValue<a?!0:!1},_getDefaultValue:function(){var a=this.options;return"float"==a.type||"int"==a.type?0:"time"==a.type?"00:00":void 0},_addValue:function(a){var b,c=this;this.options,b=c.inputText.val(),b=parseFloat(b)+a,c._isOverValue(b)||(c.inputText.val(b),c.inputText.trigger("change"))},_addTime:function(a){var b,c,d=this;this.options,b=d.inputText.val(),c=b.match(/^(\d{1,2}):(\d{1,2})$/),newminute=parseInt(c[2])+a,10>newminute&&(newminute="0"+newminute),b=c[1]+":"+newminute,d._isOverValue(b)||(d.inputText.val(b),d.inputText.trigger("change"))},_uping:function(){var a=this,b=this.options;"float"==b.type||"int"==b.type?a._addValue(b.step):"time"==b.type&&a._addTime(b.step)},_downing:function(){var a=this,b=this.options;"float"==b.type||"int"==b.type?a._addValue(-1*b.step):"time"==b.type&&a._addTime(-1*b.step)},_isDateTime:function(a){var b,c;return this.options,b=a.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/),null==b?!1:(c=new Date(b[1],b[3]-1,b[4]),"NaN"==c?!1:c.getFullYear()==b[1]&&c.getMonth()+1==b[3]&&c.getDate()==b[4])},_isLongDateTime:function(a){var b,c,d;return this.options,b=/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2}) (\d{1,2}):(\d{1,2})$/,c=a.match(b),null==c?!1:(d=new Date(c[1],c[3]-1,c[4],c[5],c[6]),"NaN"==d?!1:d.getFullYear()==c[1]&&d.getMonth()+1==c[3]&&d.getDate()==c[4]&&d.getHours()==c[5]&&d.getMinutes()==c[6])}})}(jQuery),function(a){a.fn.ligerTab=function(){return a.ligerui.run.call(this,"ligerTab",arguments)},a.fn.ligerGetTabManager=function(){return a.ligerui.run.call(this,"ligerGetTabManager",arguments)},a.ligerDefaults.Tab={height:null,heightDiff:0,changeHeightOnResize:!1,contextmenu:!0,dblClickToClose:!1,dragToMove:!1,onBeforeOverrideTabItem:null,onAfterOverrideTabItem:null,onBeforeRemoveTabItem:null,onAfterRemoveTabItem:null,onBeforeAddTabItem:null,onAfterAddTabItem:null,onBeforeSelectTabItem:null,onAfterSelectTabItem:null},a.ligerDefaults.TabString={closeMessage:"关闭当前页",closeOtherMessage:"关闭其他",closeAllMessage:"关闭所有",reloadMessage:"刷新"},a.ligerMethos.Tab={},a.ligerui.controls.Tab=function(b,c){a.ligerui.controls.Tab.base.constructor.call(this,b,c)},a.ligerui.controls.Tab.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Tab"},__idPrev:function(){return"Tab"},_extendMethods:function(){return a.ligerMethos.Tab},_render:function(){var b,c,d=this,e=this.options;e.height&&(d.makeFullHeight=!0),d.tab=a(this.element),d.tab.addClass("l-tab"),e.contextmenu&&a.ligerMenu&&(d.tab.menu=a.ligerMenu({width:100,items:[{text:e.closeMessage,id:"close",click:function(){d._menuItemClick.apply(d,arguments)}},{text:e.closeOtherMessage,id:"closeother",click:function(){d._menuItemClick.apply(d,arguments)}},{text:e.closeAllMessage,id:"closeall",click:function(){d._menuItemClick.apply(d,arguments)}},{text:e.reloadMessage,id:"reload",click:function(){d._menuItemClick.apply(d,arguments)}}]})),d.tab.content=a('<div class="l-tab-content"></div>'),a("> div",d.tab).appendTo(d.tab.content),d.tab.content.appendTo(d.tab),d.tab.links=a('<div class="l-tab-links"><ul style="left: 0px; "></ul></div>'),d.tab.links.prependTo(d.tab),d.tab.links.ul=a("ul",d.tab.links),b=a("> div[lselected=true]",d.tab.content),c=b.length>0,d.selectedTabId=b.attr("tabid"),a("> div",d.tab.content).each(function(b){var e,f,g,h,i=a('<li class=""><a></a><div class="l-tab-links-item-left"></div><div class="l-tab-links-item-right"></div></li>'),j=a(this);j.attr("title")&&(a("> a",i).html(j.attr("title")),j.attr("title","")),e=j.attr("tabid"),void 0==e&&(e=d.getNewTabid(),j.attr("tabid",e),j.attr("lselected")&&(d.selectedTabId=e)),i.attr("tabid",e),c||0!=b||(d.selectedTabId=e),f=j.attr("showClose"),f&&i.append("<div class='l-tab-links-item-close'></div>"),a("> ul",d.tab.links).append(i),j.hasClass("l-tab-content-item")||j.addClass("l-tab-content-item"),j.find("iframe").length>0&&(g=a("iframe:first",j),"complete"!=g[0].readyState&&(0==j.find(".l-tab-loading:first").length&&j.prepend("<div class='l-tab-loading' style='display:block;'></div>"),h=a(".l-tab-loading:first",j),g.bind("load.tab",function(){h.hide()})))}),d.selectTabItem(d.selectedTabId),e.height&&("string"==typeof e.height&&e.height.indexOf("%")>0?(d.onResize(),e.changeHeightOnResize&&a(window).resize(function(){d.onResize.call(d)})):d.setHeight(e.height)),d.makeFullHeight&&d.setContentHeight(),a("li",d.tab.links).each(function(){d._addTabItemEvent(a(this))}),d.tab.bind("dblclick.tab",function(b){var c,f,g,h;e.dblClickToClose&&(d.dblclicking=!0,c=b.target||b.srcElement,f=c.tagName.toLowerCase(),"a"==f&&(g=a(c).parent().attr("tabid"),h=a(c).parent().find("div.l-tab-links-item-close").length?!0:!1,h&&d.removeTabItem(g)),d.dblclicking=!1)}),d.set(e)},_applyDrag:function(b){var c,d=this;return this.options,d.droptip=d.droptip||a("<div class='l-tab-drag-droptip' style='display:none'><div class='l-drop-move-up'></div><div class='l-drop-move-down'></div></div>").appendTo("body"),c=a(b).ligerDrag({revert:!0,animate:!1,proxy:function(){var b=a(this).find("a").html();return d.dragproxy=a("<div class='l-tab-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div></div>").appendTo("body"),d.dragproxy.append(b),d.dragproxy},onRendered:function(){this.set("cursor","pointer")},onStartDrag:function(c,d){if(!a(b).hasClass("l-selected"))return!1;if(2==d.button)return!1;var e=d.srcElement||d.target;return a(e).hasClass("l-tab-links-item-close")?!1:void 0},onDrag:function(b,c){var e,f;null==d.dropIn&&(d.dropIn=-1),e=d.tab.links.ul.find(">li"),f=e.index(b.target),e.each(function(b){var e,g,h,i,j;f!=b&&(e=b>f,(-1==d.dropIn||d.dropIn==b)&&(g=a(this).offset(),h={top:g.top,bottom:g.top+a(this).height(),left:g.left-10,right:g.left+10},e&&(h.left+=a(this).width(),h.right+=a(this).width()),i=c.pageX||c.screenX,j=c.pageY||c.screenY,i>h.left&&i<h.right&&j>h.top&&j<h.bottom?(d.droptip.css({left:h.left+5,top:h.top-9}).show(),d.dropIn=b,d.dragproxy.find(".l-drop-icon").removeClass("l-drop-no").addClass("l-drop-yes")):(d.dropIn=-1,d.droptip.hide(),d.dragproxy.find(".l-drop-icon").removeClass("l-drop-yes").addClass("l-drop-no"))))})},onStopDrag:function(b){var c,e;d.dropIn>-1&&(c=d.tab.links.ul.find(">li:eq("+d.dropIn+")").attr("tabid"),e=a(b.target).attr("tabid"),setTimeout(function(){d.moveTabItem(e,c)},0),d.dropIn=-1,d.dragproxy.remove()),d.droptip.hide(),this.set("cursor","default")}})},_setDragToMove:function(b){if(a.fn.ligerDrag){var c=this;if(this.options,b){if(c.drags)return;c.drags=c.drags||[],c.tab.links.ul.find(">li").each(function(){c.drags.push(c._applyDrag(this))})}}},moveTabItem:function(a,b){var c=this,d=c.tab.links.ul.find(">li[tabid="+a+"]"),e=c.tab.links.ul.find(">li[tabid="+b+"]"),f=c.tab.links.ul.find(">li").index(d),g=c.tab.links.ul.find(">li").index(e);g>f?e.after(d):e.before(d)},setTabButton:function(){var b,c,d=this;return this.options,b=0,a("li",d.tab.links.ul).each(function(){b+=a(this).width()+2}),c=d.tab.width(),b>c?(d.tab.links.append('<div class="l-tab-links-left"></div><div class="l-tab-links-right"></div>'),d.setTabButtonEven(),!0):(d.tab.links.ul.animate({left:0}),a(".l-tab-links-left,.l-tab-links-right",d.tab.links).remove(),!1)},setTabButtonEven:function(){var b=this;this.options,a(".l-tab-links-left",b.tab.links).hover(function(){a(this).addClass("l-tab-links-left-over")},function(){a(this).removeClass("l-tab-links-left-over")}).click(function(){b.moveToPrevTabItem()}),a(".l-tab-links-right",b.tab.links).hover(function(){a(this).addClass("l-tab-links-right-over")},function(){a(this).removeClass("l-tab-links-right-over")}).click(function(){b.moveToNextTabItem()})},moveToPrevTabItem:function(){var b,c,d,e,f=this;for(this.options,b=a(".l-tab-links-left",f.tab.links).width(),c=new Array,a("li",f.tab.links).each(function(d){var e=-1*b;d>0&&(e=parseInt(c[d-1])+a(this).prev().width()+2),c.push(e)}),d=-1*parseInt(f.tab.links.ul.css("left")),e=0;e<c.length-1;e++)if(c[e]<d&&c[e+1]>=d)return f.tab.links.ul.animate({left:-1*parseInt(c[e])}),void 0},moveToNextTabItem:function(){var b,c,d,e,f,g,h,i,j,k=this;for(this.options,b=a(".l-tab-links-right",k.tab).width(),c=0,d=a("li",k.tab.links.ul),d.each(function(){c+=a(this).width()+2}),e=k.tab.width(),f=new Array,g=d.length-1;g>=0;g--)h=c-e+b+2,g!=d.length-1&&(h=parseInt(f[d.length-2-g])-a(d[g+1]).width()-2),f.push(h);for(i=-1*parseInt(k.tab.links.ul.css("left")),j=1;j<f.length;j++)if(f[j]<=i&&f[j-1]>i)return k.tab.links.ul.animate({left:-1*parseInt(f[j-1])}),void 0},getTabItemCount:function(){var b=this;return this.options,a("li",b.tab.links.ul).length},getSelectedTabItemID:function(){var b=this;return this.options,a("li.l-selected",b.tab.links.ul).attr("tabid")},removeSelectedTabItem:function(){var a=this;this.options,a.removeTabItem(a.getSelectedTabItemID())},overrideSelectedTabItem:function(a){var b=this;this.options,b.overrideTabItem(b.getSelectedTabItemID(),a)},overrideTabItem:function(b,c){var d,e,f,g,h,i,j,k,l=this;return this.options,0==l.trigger("beforeOverrideTabItem",[b])?!1:(d=c.tabid,void 0==d&&(d=l.getNewTabid()),e=c.url,f=c.content,c.target,g=c.text,h=c.showClose,i=c.height,l.isTabItemExist(d)||(j=a("li[tabid="+b+"]",l.tab.links.ul),k=a(".l-tab-content-item[tabid="+b+"]",l.tab.content),j&&k&&(j.attr("tabid",d),k.attr("tabid",d),0==a("iframe",k).length&&e?k.html("<iframe frameborder='0'></iframe>"):f&&k.html(f),a("iframe",k).attr("name",d),void 0==h&&(h=!0),0==h?a(".l-tab-links-item-close",j).remove():0==a(".l-tab-links-item-close",j).length&&j.append("<div class='l-tab-links-item-close'></div>"),void 0==g&&(g=d),i&&k.height(i),a("a",j).text(g),a("iframe",k).attr("src",e),l.trigger("afterOverrideTabItem",[b]))),void 0)},selectTabItem:function(b){var c=this;return this.options,0==c.trigger("beforeSelectTabItem",[b])?!1:(c.selectedTabId=b,a("> .l-tab-content-item[tabid="+b+"]",c.tab.content).show().siblings().hide(),a("li[tabid="+b+"]",c.tab.links.ul).addClass("l-selected").siblings().removeClass("l-selected"),c.trigger("afterSelectTabItem",[b]),void 0)},moveToLastTabItem:function(){var b,c,d,e=this;this.options,b=0,a("li",e.tab.links.ul).each(function(){b+=a(this).width()+2}),c=e.tab.width(),b>c&&(d=a(".l-tab-links-right",e.tab.links).width(),e.tab.links.ul.animate({left:-1*(b-c+d+2)}))},isTabItemExist:function(b){var c=this;return this.options,a("li[tabid="+b+"]",c.tab.links.ul).length>0},addTabItem:function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o=this,p=this.options;return 0==o.trigger("beforeAddTabItem",[c])?!1:(c=b.tabid,void 0==c&&(c=o.getNewTabid()),d=b.url,e=b.content,f=b.text,g=b.showClose,h=b.height,o.isTabItemExist(c)?(i=a(".l-tab-content-item[tabid="+c+"]"),j=a(".l-tab-loading:first",i),k=a("iframe:first",i),l=a(k).attr("src"),l!=d&&(j.show(),k.attr("src",d).unbind("load.tab").bind("load.tab",function(){j.hide()})),o.selectTabItem(c),void 0):(m=a("<li><a></a><div class='l-tab-links-item-left'></div><div class='l-tab-links-item-right'></div><div class='l-tab-links-item-close'></div></li>"),i=a("<div class='l-tab-content-item'><div class='l-tab-loading' style='display:block;'></div><iframe frameborder='0'></iframe></div>"),j=a("div:first",i),k=a("iframe:first",i),o.makeFullHeight&&(n=o.tab.height()-o.tab.links.height(),i.height(n)),m.attr("tabid",c),i.attr("tabid",c),d?k.attr("name",c).attr("id",c).attr("src",d).bind("load.tab",function(){j.hide(),b.callback&&b.callback()}):(k.remove(),j.remove()),e?i.html(e):b.target&&i.append(b.target),void 0==g&&(g=!0),0==g&&a(".l-tab-links-item-close",m).remove(),void 0==f&&(f=c),h&&i.height(h),a("a",m).text(f),o.tab.links.ul.append(m),o.tab.content.append(i),o.selectTabItem(c),o.setTabButton()&&o.moveToLastTabItem(),o._addTabItemEvent(m),p.dragToMove&&a.fn.ligerDrag&&(o.drags=o.drags||[],m.each(function(){o.drags.push(o._applyDrag(this))})),o.trigger("afterAddTabItem",[c]),void 0))},_addTabItemEvent:function(b){var c=this;this.options,b.click(function(){var b=a(this).attr("tabid");c.selectTabItem(b)}),c.tab.menu&&c._addTabItemContextMenuEven(b),a(".l-tab-links-item-close",b).hover(function(){a(this).addClass("l-tab-links-item-close-over")},function(){a(this).removeClass("l-tab-links-item-close-over")}).click(function(){var b=a(this).parent().attr("tabid");c.removeTabItem(b)})},removeTabItem:function(b){var c,d=this;return this.options,0==d.trigger("beforeRemoveTabItem",[b])?!1:(c=a("li[tabid="+b+"]",d.tab.links.ul).hasClass("l-selected"),c&&(a(".l-tab-content-item[tabid="+b+"]",d.tab.content).prev().show(),a("li[tabid="+b+"]",d.tab.links.ul).prev().addClass("l-selected").siblings().removeClass("l-selected")),a(".l-tab-content-item[tabid="+b+"]",d.tab.content).remove(),a("li[tabid="+b+"]",d.tab.links.ul).remove(),d.setTabButton(),d.trigger("afterRemoveTabItem",[b]),void 0)},addHeight:function(a){var b,c=this;this.options,b=c.tab.height()+a,c.setHeight(b)},setHeight:function(a){var b=this;this.options,b.tab.height(a),b.setContentHeight()},setContentHeight:function(){var b,c=this;this.options,b=c.tab.height()-c.tab.links.height(),c.tab.content.height(b),a("> .l-tab-content-item",c.tab.content).height(b)},getNewTabid:function(){var a=this;return this.options,a.getnewidcount=a.getnewidcount||0,"tabitem"+ ++a.getnewidcount},getTabidList:function(b,c){var d,e=this;return this.options,d=[],a("> li",e.tab.links.ul).each(function(){a(this).attr("tabid")&&a(this).attr("tabid")!=b&&(!c||a(".l-tab-links-item-close",this).length>0)&&d.push(a(this).attr("tabid"))}),d},removeOther:function(b){var c,d=this;this.options,c=d.getTabidList(b,!0),a(c).each(function(){d.removeTabItem(this)})},reload:function(b){var c,d,e,f;this.options,c=a(".l-tab-content-item[tabid="+b+"]"),d=a(".l-tab-loading:first",c),e=a("iframe:first",c),f=a(e).attr("src"),d.show(),e.attr("src",f).unbind("load.tab").bind("load.tab",function(){d.hide()})},removeAll:function(){var b,c=this;this.options,b=c.getTabidList(null,!0),a(b).each(function(){c.removeTabItem(this)})},onResize:function(){var b,c=this,d=this.options;return d.height&&"string"==typeof d.height&&-1!=d.height.indexOf("%")?("body"==c.tab.parent()[0].tagName.toLowerCase()?(b=a(window).height(),b-=parseInt(c.tab.parent().css("paddingTop")),b-=parseInt(c.tab.parent().css("paddingBottom")),c.height=d.heightDiff+.01*b*parseFloat(c.height)):c.height=d.heightDiff+.01*c.tab.parent().height()*parseFloat(d.height),c.tab.height(c.height),c.setContentHeight(),void 0):!1},_menuItemClick:function(a){var b=this;if(this.options,a.id&&b.actionTabid)switch(a.id){case"close":b.removeTabItem(b.actionTabid),b.actionTabid=null;break;case"closeother":b.removeOther(b.actionTabid);break;case"closeall":b.removeAll(),b.actionTabid=null;break;case"reload":b.selectTabItem(b.actionTabid),b.reload(b.actionTabid)}},_addTabItemContextMenuEven:function(b){var c=this;this.options,b.bind("contextmenu",function(d){return c.tab.menu?(c.actionTabid=b.attr("tabid"),c.tab.menu.show({top:d.pageY,left:d.pageX}),0==a(".l-tab-links-item-close",this).length?c.tab.menu.setDisabled("close"):c.tab.menu.setEnabled("close"),!1):void 0})}})}(jQuery),function(a){a.fn.ligerTextBox=function(){return a.ligerui.run.call(this,"ligerTextBox",arguments)},a.fn.ligerGetTextBoxManager=function(){return a.ligerui.run.call(this,"ligerGetTextBoxManager",arguments)},a.ligerDefaults.TextBox={onChangeValue:null,width:null,disabled:!1,value:null,nullText:null,digits:!1,number:!1},a.ligerui.controls.TextBox=function(b,c){a.ligerui.controls.TextBox.base.constructor.call(this,b,c)},a.ligerui.controls.TextBox.ligerExtend(a.ligerui.controls.Input,{__getType:function(){return"TextBox"},__idPrev:function(){return"TextBox"},_init:function(){a.ligerui.controls.TextBox.base._init.call(this);var b=this,c=this.options;c.width||(c.width=a(b.element).width()),a(this.element).attr("readonly")&&(c.disabled=!0)},_render:function(){var b=this,c=this.options;b.inputText=a(this.element),b.wrapper=b.inputText.wrap('<div class="l-text"></div>').parent(),b.wrapper.append('<div class="l-text-l"></div><div class="l-text-r"></div>'),b.inputText.hasClass("l-text-field")||b.inputText.addClass("l-text-field"),this._setEvent(),b.set(c),b.checkValue()},_getValue:function(){return this.inputText.val()},_setNullText:function(){this.checkNotNull()},checkValue:function(){var a=this,b=this.options,c=a.inputText.val();return b.number&&!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(c)||b.digits&&!/^\d+$/.test(c)?(a.inputText.val(a.value||0),void 0):(a.value=c,void 0)},checkNotNull:function(){var a=this,b=this.options;b.nullText&&!b.disabled&&(a.inputText.val()||a.inputText.addClass("l-text-field-null").val(b.nullText))},_setEvent:function(){var b=this,c=this.options;b.inputText.bind("blur.textBox",function(){b.trigger("blur"),b.checkNotNull(),b.checkValue(),b.wrapper.removeClass("l-text-focus")}).bind("focus.textBox",function(){b.trigger("focus"),c.nullText&&a(this).hasClass("l-text-field-null")&&a(this).removeClass("l-text-field-null").val(""),b.wrapper.addClass("l-text-focus")}).change(function(){b.trigger("changeValue",[this.value])}),b.wrapper.hover(function(){b.trigger("mouseOver"),b.wrapper.addClass("l-text-over")},function(){b.trigger("mouseOut"),b.wrapper.removeClass("l-text-over")})},_setDisabled:function(a){a?(this.inputText.attr("readonly","readonly"),this.wrapper.addClass("l-text-disabled")):(this.inputText.removeAttr("readonly"),this.wrapper.removeClass("l-text-disabled"))},_setWidth:function(a){a>20&&(this.wrapper.css({width:a}),this.inputText.css({width:a-4}))},_setHeight:function(a){a>10&&(this.wrapper.height(a),this.inputText.height(a-2))},_setValue:function(a){null!=a&&this.inputText.val(a)},_setLabel:function(b){var c,d=this,e=this.options;d.labelwrapper?d.labelwrapper.find(".l-text-label").html(b+":&nbsp"):(d.labelwrapper=d.wrapper.wrap('<div class="l-labeltext"></div>').parent(),c=a('<div class="l-text-label" style="float:left;">'+b+":&nbsp</div>"),d.labelwrapper.prepend(c),d.wrapper.css("float","left"),e.labelWidth?d._setLabelWidth(e.labelWidth):e.labelWidth=c.width(),c.height(d.wrapper.height()),e.labelAlign&&d._setLabelAlign(e.labelAlign),d.labelwrapper.append('<br style="clear:both;" />'),d.labelwrapper.width(e.labelWidth+e.width+2))},_setLabelWidth:function(a){var b=this;this.options,b.labelwrapper&&b.labelwrapper.find(".l-text-label").width(a)},_setLabelAlign:function(a){var b=this;this.options,b.labelwrapper&&b.labelwrapper.find(".l-text-label").css("text-align",a)},updateStyle:function(){var a=this,b=this.options;a.inputText.attr("disabled")||a.inputText.attr("readonly")?(a.wrapper.addClass("l-text-disabled"),a.options.disabled=!0):(a.wrapper.removeClass("l-text-disabled"),a.options.disabled=!1),a.inputText.hasClass("l-text-field-null")&&a.inputText.val()!=b.nullText&&a.inputText.removeClass("l-text-field-null"),a.checkValue()}})}(jQuery),function(a){a.ligerTip=function(){return a.ligerui.run.call(null,"ligerTip",arguments)},a.fn.ligerTip=function(b){return this.each(function(){var c=a.extend({},a.ligerDefaults.ElementTip,b||{});if(c.target=c.target||this,c.auto||void 0==b)c.content||(c.content=this.title,c.removeTitle&&a(this).removeAttr("title")),c.content=c.content||this.title,a(this).bind("mouseover.tip",function(){c.x=a(this).offset().left+a(this).width()+(c.distanceX||0),c.y=a(this).offset().top+(c.distanceY||0),a.ligerTip(c)}).bind("mouseout.tip",function(){var b=a.ligerui.managers[this.ligeruitipid];b&&b.remove()});else{if(c.target.ligeruitipid)return;c.x=a(this).offset().left+a(this).width()+(c.distanceX||0),c.y=a(this).offset().top+(c.distanceY||0),c.x=c.x||0,c.y=c.y||0,a.ligerTip(c)}}),a.ligerui.get(this,"ligeruitipid")},a.fn.ligerHideTip=function(b){return this.each(function(){var c,d,e,f=b||{};if(void 0==f.isLabel&&(f.isLabel="label"==this.tagName.toLowerCase()&&null!=a(this).attr("for")),c=this,f.isLabel){if(d=a("#"+a(this).attr("for")),0==d.length)return;c=d[0]}e=a.ligerui.managers[c.ligeruitipid],e&&e.remove()}).unbind("mouseover.tip").unbind("mouseout.tip")},a.fn.ligerGetTipManager=function(){return a.ligerui.get(this)},a.ligerDefaults=a.ligerDefaults||{},a.ligerDefaults.HideTip={},a.ligerDefaults.Tip={content:null,callback:null,width:150,height:null,x:0,y:0,appendIdTo:null,target:null,auto:null,removeTitle:!0},a.ligerDefaults.ElementTip={distanceX:1,distanceY:-3,auto:null,removeTitle:!0},a.ligerMethos.Tip={},a.ligerui.controls.Tip=function(b){a.ligerui.controls.Tip.base.constructor.call(this,null,b)},a.ligerui.controls.Tip.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"Tip"},__idPrev:function(){return"Tip"},_extendMethods:function(){return a.ligerMethos.Tip},_render:function(){var b=this,c=this.options,d=a('<div class="l-verify-tip"><div class="l-verify-tip-corner"></div><div class="l-verify-tip-content"></div></div>');b.tip=d,b.tip.attr("id",b.id),c.content&&(a("> .l-verify-tip-content:first",d).html(c.content),d.appendTo("body"),d.css({left:c.x,top:c.y}).show(),c.width&&a("> .l-verify-tip-content:first",d).width(c.width-8),c.height&&a("> .l-verify-tip-content:first",d).width(c.height),eee=c.appendIdTo,c.appendIdTo&&c.appendIdTo.attr("ligerTipId",b.id),c.target&&(a(c.target).attr("ligerTipId",b.id),c.target.ligeruitipid=b.id),c.callback&&c.callback(d),b.set(c))},_setContent:function(b){a("> .l-verify-tip-content:first",this.tip).html(b)},remove:function(){this.options.appendIdTo&&this.options.appendIdTo.removeAttr("ligerTipId"),this.options.target&&(a(this.options.target).removeAttr("ligerTipId"),this.options.target.ligeruitipid=null),this.tip.remove()}})}(jQuery),function(a){a.fn.ligerToolBar=function(){return a.ligerui.run.call(this,"ligerToolBar",arguments)},a.fn.ligerGetToolBarManager=function(){return a.ligerui.run.call(this,"ligerGetToolBarManager",arguments)},a.ligerDefaults.ToolBar={},a.ligerMethos.ToolBar={},a.ligerui.controls.ToolBar=function(b,c){a.ligerui.controls.ToolBar.base.constructor.call(this,b,c)},a.ligerui.controls.ToolBar.ligerExtend(a.ligerui.core.UIComponent,{__getType:function(){return"ToolBar"},__idPrev:function(){return"ToolBar"},_extendMethods:function(){return a.ligerMethos.ToolBar},_render:function(){var b=this,c=this.options;b.toolBar=a(this.element),b.toolBar.addClass("l-toolbar"),b.set(c)},_setItems:function(b){var c=this;a(b).each(function(a,b){c.addItem(b)})},addItem:function(b){var c,d=this;return this.options,b.line?(d.toolBar.append('<div class="l-bar-separator"></div>'),void 0):(c=a('<div class="l-toolbar-item l-panel-btn"><span></span><div class="l-panel-btn-l"></div><div class="l-panel-btn-r"></div></div>'),d.toolBar.append(c),b.id&&c.attr("toolbarid",b.id),b.img?(c.append("<img src='"+b.img+"' />"),c.addClass("l-toolbar-item-hasicon")):b.icon&&(c.append("<div class='l-icon l-icon-"+b.icon+"'></div>"),c.addClass("l-toolbar-item-hasicon")),b.text&&a("span:first",c).html(b.text),b.disable&&c.addClass("l-toolbar-item-disable"),b.click&&c.click(function(){b.click(b)}),c.hover(function(){a(this).addClass("l-panel-btn-over")},function(){a(this).removeClass("l-panel-btn-over")}),void 0)}})}(jQuery),function(a){a.fn.ligerTree=function(){return a.ligerui.run.call(this,"ligerTree",arguments)},a.fn.ligerGetTreeManager=function(){return a.ligerui.run.call(this,"ligerGetTreeManager",arguments)},a.ligerDefaults.Tree={url:null,data:null,checkbox:!0,autoCheckboxEven:!0,parentIcon:"folder",childIcon:"leaf",textFieldName:"text",attribute:["id","url"],treeLine:!0,nodeWidth:90,statusName:"__status",isLeaf:null,single:!1,onBeforeExpand:function(){},onContextmenu:function(){},onExpand:function(){},onBeforeCollapse:function(){},onCollapse:function(){},onBeforeSelect:function(){},onSelect:function(){},onBeforeCancelSelect:function(){},onCancelselect:function(){},onCheck:function(){},onSuccess:function(){},onError:function(){},onClick:function(){},idFieldName:"id",parentIDFieldName:null,topParentIDValue:0,onBeforeAppend:function(){},onAppend:function(){},onAfterAppend:function(){},slide:!0,iconFieldName:"icon",nodeDraggable:!1,nodeDraggingRender:null,btnClickToToggleOnly:!0},a.ligerui.controls.Tree=function(b,c){a.ligerui.controls.Tree.base.constructor.call(this,b,c)},a.ligerui.controls.Tree.ligerExtend(a.ligerui.core.UIComponent,{_init:function(){a.ligerui.controls.Tree.base._init.call(this);var b=this.options;b.single&&(b.autoCheckboxEven=!1)},_render:function(){var b=this,c=this.options;b.set(c,!0),b.tree=a(b.element),b.tree.addClass("l-tree"),b.sysAttribute=["isexpand","ischecked","href","style"],b.loading=a("<div class='l-tree-loading'></div>"),b.tree.after(b.loading),b.data=[],b.maxOutlineLevel=1,b.treedataindex=0,b._applyTree(),b._setTreeEven(),b.set(c,!1)},_setTreeLine:function(a){a?this.tree.removeClass("l-tree-noline"):this.tree.addClass("l-tree-noline")},_setUrl:function(a){a&&this.loadData(null,a)},_setData:function(a){a&&this.append(null,a)},setData:function(a){this.set("data",a)},getData:function(){return this.data},hasChildren:function(a){return this.options.isLeaf?this.options.isLeaf(a):a.children?!0:!1},getParent:function(b,c){var d,e,f=this;return b=f.getNodeDom(b),(d=f.getParentTreeItem(b,c))?(e=a(d).attr("treedataindex"),f._getDataNodeByTreeDataIndex(e)):null},getParentTreeItem:function(b,c){var d,e,f,g,h=this;if(b=h.getNodeDom(b),d=a(b),d.parent().hasClass("l-tree"))return null;if(void 0==c)return 0==d.parent().parent("li").length?null:d.parent().parent("li")[0];for(e=parseInt(d.attr("outlinelevel")),f=d,g=e-1;g>=c;g--)f=f.parent().parent("li");return f[0]},getChecked:function(){var b,c=this;return this.options,this.options.checkbox?(b=[],a(".l-checkbox-checked",c.tree).parent().parent("li").each(function(){var d=parseInt(a(this).attr("treedataindex"));b.push({target:this,data:c._getDataNodeByTreeDataIndex(c.data,d)})}),b):null},getSelected:function(){var b,c,d=this;return this.options,b={},b.target=a(".l-selected",d.tree).parent("li")[0],b.target?(c=parseInt(a(b.target).attr("treedataindex")),b.data=d._getDataNodeByTreeDataIndex(d.data,c),b):null},upgrade:function(b){var c=this;this.options,a(".l-note",b).each(function(){a(this).removeClass("l-note").addClass("l-expandable-open")}),a(".l-note-last",b).each(function(){a(this).removeClass("l-note-last").addClass("l-expandable-open")}),a("."+c._getChildNodeClassName(),b).each(function(){a(this).removeClass(c._getChildNodeClassName()).addClass(c._getParentNodeClassName(!0))})},demotion:function(b){var c,d=this;this.options,(b||"li"==b[0].tagName.toLowerCase())&&(c=a(b).hasClass("l-last"),a(".l-expandable-open",b).each(function(){a(this).removeClass("l-expandable-open").addClass(c?"l-note-last":"l-note")}),a(".l-expandable-close",b).each(function(){a(this).removeClass("l-expandable-close").addClass(c?"l-note-last":"l-note")}),a("."+d._getParentNodeClassName(!0),b).each(function(){a(this).removeClass(d._getParentNodeClassName(!0)).addClass(d._getChildNodeClassName())}))},collapseAll:function(){var b=this;this.options,a(".l-expandable-open",b.tree).click()},expandAll:function(){var b=this;this.options,a(".l-expandable-close",b.tree).click()},loadData:function(b,c,d){var e,f=this;this.options,f.loading.show(),e=d?"post":"get",d=d||[],a.ajax({type:e,url:c,data:d,dataType:"json",success:function(a){a&&(f.loading.hide(),f.append(b,a),f.trigger("success",[a]))},error:function(a,b,c){try{f.loading.hide(),f.trigger("error",[a,b,c])}catch(d){}}})},clear:function(){var b=this;this.options,a("> li",b.tree).each(function(){b.remove(this)})},getNodeDom:function(b){var c=this;return this.options,null==b?b:"string"==typeof b||"number"==typeof b?a("li[treedataindex="+b+"]",c.tree).get(0):"object"==typeof b&&"treedataindex"in b?c.getNodeDom(b.treedataindex):b},remove:function(b){var c,d,e,f=this,g=this.options;b=f.getNodeDom(b),c=parseInt(a(b).attr("treedataindex")),d=f._getDataNodeByTreeDataIndex(f.data,c),d&&f._setTreeDataStatus([d],"delete"),e=f.getParentTreeItem(b),g.checkbox&&f._setParentCheckboxStatus(a(b)),a(b).remove(),f._updateStyle(e?a("ul:first",e):f.tree)},_updateStyle:function(b){var c,d,e=this;this.options,c=a(" > li",b),d=c.length,d&&c.each(function(b){0!=b||a(this).hasClass("l-first")||a(this).addClass("l-first"),b!=d-1||a(this).hasClass("l-last")||a(this).addClass("l-last"),0==b&&b==d-1&&a(this).addClass("l-onlychild"),a("> div .l-note,> div .l-note-last",this).removeClass("l-note l-note-last").addClass(b==d-1?"l-note-last":"l-note"),e._setTreeItem(this,{isLast:b==d-1})})},update:function(b,c){var d,e,f=this,g=this.options;b=f.getNodeDom(b),d=parseInt(a(b).attr("treedataindex")),nodedata=f._getDataNodeByTreeDataIndex(f.data,d);for(e in c)nodedata[e]=c[e],e==g.textFieldName&&a("> .l-body > span",b).text(c[e])},append:function(b,c,d,e){var f,g,h,i,j,k,l,m=this,n=this.options;if(b=m.getNodeDom(b),0==m.trigger("beforeAppend",[b,c]))return!1;if(!c||!c.length)return!1;if(n.idFieldName&&n.parentIDFieldName&&(c=m.arrayToTree(c,n.idFieldName,n.parentIDFieldName)),m._addTreeDataIndexToData(c),m._setTreeDataStatus(c,"add"),null!=d&&(d=m.getNodeDom(d)),m.trigger("append",[b,c]),m._appendData(b,c),null==b)return f=m._getTreeHTMLByData(c,1,[],!0),f[f.length-1]=f[0]="",null!=d?(a(d)[e?"after":"before"](f.join("")),m._updateStyle(b?a("ul:first",b):m.tree)):(a("> li:last",m.tree).length>0&&m._setTreeItem(a("> li:last",m.tree)[0],{isLast:!1}),m.tree.append(f.join(""))),a(".l-body",m.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),m._upadteTreeWidth(),m.trigger("afterAppend",[b,c]),void 0;for(g=a(b),h=parseInt(g.attr("outlinelevel")),i=a("> ul",g).length>0,i||(g.append("<ul class='l-children'></ul>"),m.upgrade(b)),j=[],k=1;h-1>=k;k++)l=a(m.getParentTreeItem(b,k)),j.push(l.hasClass("l-last"));j.push(g.hasClass("l-last")),f=m._getTreeHTMLByData(c,h+1,j,!0),f[f.length-1]=f[0]="",null!=d?(a(d)[e?"after":"before"](f.join("")),m._updateStyle(b?a("ul:first",b):m.tree)):(a("> .l-children > li:last",g).length>0&&m._setTreeItem(a("> .l-children > li:last",g)[0],{isLast:!1}),a(">.l-children",b).append(f.join(""))),m._upadteTreeWidth(),a(">.l-children .l-body",b).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")}),m.trigger("afterAppend",[b,c])},cancelSelect:function(b){var c=this,d=this.options,e=c.getNodeDom(b),f=a(e),g=parseInt(f.attr("treedataindex")),h=c._getDataNodeByTreeDataIndex(c.data,g),i=a(">div:first",f);
d.checkbox?a(".l-checkbox",i).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"):i.removeClass("l-selected"),c.trigger("cancelSelect",[{data:h,target:f[0]}])},selectNode:function(b){var c,d,e,f,g=this,h=this.options,i=null;if("function"==typeof b)i=b;else{if("object"==typeof b)return c=a(b),d=parseInt(c.attr("treedataindex")),e=g._getDataNodeByTreeDataIndex(g.data,d),f=a(">div:first",c),h.checkbox?a(".l-checkbox",f).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"):f.addClass("l-selected"),g.trigger("select",[{data:e,target:c[0]}]),void 0;i=function(a){return a[h.idFieldName]?a[h.idFieldName].toString()==b.toString():!1}}a("li",g.tree).each(function(){var b=a(this),c=parseInt(b.attr("treedataindex")),d=g._getDataNodeByTreeDataIndex(g.data,c);i(d,c)?g.selectNode(this):g.cancelSelect(this)})},getTextByID:function(a){var b=this,c=this.options,d=b.getDataByID(a);return d?d[c.textFieldName]:null},getDataByID:function(b){var c=this,d=this.options,e=null;return a("li",c.tree).each(function(){var f,g,h;e||(f=a(this),g=parseInt(f.attr("treedataindex")),h=c._getDataNodeByTreeDataIndex(c.data,g),h[d.idFieldName].toString()==b.toString()&&(e=h))}),e},arrayToTree:function(a,b,c){var d,e,f,g,h,i,j;if(!a||!a.length)return[];for(d=[],e={},f=a.length,g=0;f>g;g++)h=a[g],e[h[b]]=h;for(g=0;f>g;g++)i=a[g],j=e[i[c]],j?(j.children=j.children||[],j.children.push(i)):d.push(i);return d},_getDataNodeByTreeDataIndex:function(a,b){var c,d,e=this;for(this.options,c=0;c<a.length;c++){if(a[c].treedataindex==b)return a[c];if(a[c].children&&(d=e._getDataNodeByTreeDataIndex(a[c].children,b)))return d}return null},_setTreeDataStatus:function(b,c){var d=this,e=this.options;a(b).each(function(){this[e.statusName]=c,this.children&&d._setTreeDataStatus(this.children,c)})},_addTreeDataIndexToData:function(b){var c=this;this.options,a(b).each(function(){void 0==this.treedataindex&&(this.treedataindex=c.treedataindex++,this.children&&c._addTreeDataIndexToData(this.children))})},_addToNodes:function(b){var c=this;this.options,c.nodes=c.nodes||[],-1==a.inArray(b,c.nodes)&&c.nodes.push(b),b.children&&a(b.children).each(function(a,b){c._addToNodes(b)})},_appendData:function(b,c){var d,e,f=this;this.options,d=parseInt(a(b).attr("treedataindex")),e=f._getDataNodeByTreeDataIndex(f.data,d),void 0==f.treedataindex&&(f.treedataindex=0),e&&void 0==e.children&&(e.children=[]),a(c).each(function(a,b){e?e.children[e.children.length]=b:f.data[f.data.length]=b,f._addToNodes(b)})},_setTreeItem:function(b,c){var d,e,f=this;this.options,c&&(b=f.getNodeDom(b),d=a(b),e=parseInt(d.attr("outlinelevel")),void 0!=c.isLast&&(1==c.isLast?(d.removeClass("l-last").addClass("l-last"),a("> div .l-note",d).removeClass("l-note").addClass("l-note-last"),a(".l-children li",d).find(".l-box:eq("+(e-1)+")").removeClass("l-line")):0==c.isLast&&(d.removeClass("l-last"),a("> div .l-note-last",d).removeClass("l-note-last").addClass("l-note"),a(".l-children li",d).find(".l-box:eq("+(e-1)+")").removeClass("l-line").addClass("l-line"))))},_upadteTreeWidth:function(){var a=this,b=this.options,c=22*a.maxOutlineLevel;b.checkbox&&(c+=22),(b.parentIcon||b.childIcon)&&(c+=22),c+=b.nodeWidth,a.tree.width("100%")},_getChildNodeClassName:function(){var a=this.options;return"l-tree-icon-"+a.childIcon},_getParentNodeClassName:function(a){var b=this.options,c="l-tree-icon-"+b.parentIcon;return a&&(c+="-open"),c},_getTreeHTMLByData:function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o=this,p=this.options;for(o.maxOutlineLevel<c&&(o.maxOutlineLevel=c),d=d||[],c=c||1,f=[],e?f.push("<ul class='l-children'>"):f.push('<ul class="l-children" style="display:none">'),g=0;g<b.length;g++){for(h=0==g,i=g==b.length-1,j=!0,k=b[g],(0==k.isexpand||"false"==k.isexpand)&&(j=!1),f.push("<li "),void 0!=k.treedataindex&&f.push('treedataindex="'+k.treedataindex+'" '),j&&f.push("isexpand="+k.isexpand+" "),f.push("outlinelevel="+c+" "),l=0;l<o.sysAttribute.length;l++)a(this).attr(o.sysAttribute[l])&&(b[dataindex][o.sysAttribute[l]]=a(this).attr(o.sysAttribute[l]));for(l=0;l<p.attribute.length;l++)k[p.attribute[l]]&&f.push(p.attribute[l]+'="'+k[p.attribute[l]]+'" ');for(f.push('class="'),h&&f.push("l-first "),i&&f.push("l-last "),h&&i&&f.push("l-onlychild "),f.push('"'),f.push(">"),f.push('<div class="l-body">'),m=0;c-2>=m;m++)d[m]?f.push('<div class="l-box"></div>'):f.push('<div class="l-box l-line"></div>');if(o.hasChildren(k)?(j?f.push('<div class="l-box l-expandable-open"></div>'):f.push('<div class="l-box l-expandable-close"></div>'),p.checkbox&&(k.ischecked?f.push('<div class="l-box l-checkbox l-checkbox-checked"></div>'):f.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')),p.parentIcon&&(f.push('<div class="l-box l-tree-icon '),f.push(o._getParentNodeClassName(p.parentIcon?!0:!1)+" "),p.iconFieldName&&k[p.iconFieldName]&&f.push("l-tree-icon-none"),f.push('">'),p.iconFieldName&&k[p.iconFieldName]&&f.push('<img src="'+k[p.iconFieldName]+'" />'),f.push("</div>"))):(i?f.push('<div class="l-box l-note-last"></div>'):f.push('<div class="l-box l-note"></div>'),p.checkbox&&(k.ischecked?f.push('<div class="l-box l-checkbox l-checkbox-checked"></div>'):f.push('<div class="l-box l-checkbox l-checkbox-unchecked"></div>')),p.childIcon&&(f.push('<div class="l-box l-tree-icon '),f.push(o._getChildNodeClassName()+" "),p.iconFieldName&&k[p.iconFieldName]&&f.push("l-tree-icon-none"),f.push('">'),p.iconFieldName&&k[p.iconFieldName]&&f.push('<img src="'+k[p.iconFieldName]+'" />'),f.push("</div>"))),f.push("<span>"+k[p.textFieldName]+"</span></div>"),o.hasChildren(k)){for(n=[],m=0;m<d.length;m++)n.push(d[m]);n.push(i),f.push(o._getTreeHTMLByData(k.children,c+1,n,j).join(""))}f.push("</li>")}return f.push("</ul>"),f},_getDataByTreeHTML:function(b){var c=this,d=this.options,e=[];return a("> li",b).each(function(){var b,f=e.length;for(e[f]={treedataindex:c.treedataindex++},e[f][d.textFieldName]=a("> span,> a",this).html(),b=0;b<c.sysAttribute.length;b++)a(this).attr(c.sysAttribute[b])&&(e[f][c.sysAttribute[b]]=a(this).attr(c.sysAttribute[b]));for(b=0;b<d.attribute.length;b++)a(this).attr(d.attribute[b])&&(e[f][d.attribute[b]]=a(this).attr(d.attribute[b]));a("> ul",this).length>0&&(e[f].children=c._getDataByTreeHTML(a("> ul",this)))}),e},_applyTree:function(){var b,c=this;this.options,c.data=c._getDataByTreeHTML(c.tree),b=c._getTreeHTMLByData(c.data,1,[],!0),b[b.length-1]=b[0]="",c.tree.html(b.join("")),c._upadteTreeWidth(),a(".l-body",c.tree).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})},_applyTreeEven:function(b){this.options,a("> .l-body",b).hover(function(){a(this).addClass("l-over")},function(){a(this).removeClass("l-over")})},_getSrcElementByEvent:function(b){var c,d,e=this,f=b.target||b.srcElement,g=f.tagName.toLowerCase(),h=a(f).parents().add(f),i=function(b){for(var c=h.length-1;c>=0;c--)if(a(h[c]).hasClass(b))return h[c];return null};return-1==h.index(this.element)?{out:!0}:(c={tree:i("l-tree"),node:i("l-body"),checkbox:i("l-checkbox"),icon:i("l-tree-icon"),text:"span"==g},c.node&&(d=parseInt(a(c.node).parent().attr("treedataindex")),c.data=e._getDataNodeByTreeDataIndex(e.data,d)),c)},_setTreeEven:function(){var b=this,c=this.options;b.hasBind("contextmenu")&&b.tree.bind("contextmenu",function(c){var d,e,f=c.target||c.srcElement,g=null;return"a"==f.tagName.toLowerCase()||"span"==f.tagName.toLowerCase()||a(f).hasClass("l-box")?g=a(f).parent().parent():a(f).hasClass("l-body")?g=a(f).parent():"li"==f.tagName.toLowerCase()&&(g=a(f)),g?(d=parseInt(g.attr("treedataindex")),e=b._getDataNodeByTreeDataIndex(b.data,d),b.trigger("contextmenu",[{data:e,target:g[0]},c])):void 0}),b.tree.click(function(d){var e,f,g,h,i,j=d.target||d.srcElement,k=null;if(k="a"==j.tagName.toLowerCase()||"span"==j.tagName.toLowerCase()||a(j).hasClass("l-box")?a(j).parent().parent():a(j).hasClass("l-body")?a(j).parent():a(j)){if(e=parseInt(k.attr("treedataindex")),f=b._getDataNodeByTreeDataIndex(b.data,e),g=a("div.l-body:first",k).find("div.l-expandable-open:first,div.l-expandable-close:first"),h=a(j).hasClass("l-expandable-open")||a(j).hasClass("l-expandable-close"),!a(j).hasClass("l-checkbox")&&!h)if(a(">div:first",k).hasClass("l-selected")){if(0==b.trigger("beforeCancelSelect",[{data:f,target:k[0]}]))return!1;a(">div:first",k).removeClass("l-selected"),b.trigger("cancelSelect",[{data:f,target:k[0]}])}else{if(0==b.trigger("beforeSelect",[{data:f,target:k[0]}]))return!1;a(".l-body",b.tree).removeClass("l-selected"),a(">div:first",k).addClass("l-selected"),b.trigger("select",[{data:f,target:k[0]}])}if(a(j).hasClass("l-checkbox"))c.autoCheckboxEven?(a(j).hasClass("l-checkbox-unchecked")?(a(j).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),a(".l-children .l-checkbox",k).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),b.trigger("check",[{data:f,target:k[0]},!0])):a(j).hasClass("l-checkbox-checked")?(a(j).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),a(".l-children .l-checkbox",k).removeClass("l-checkbox-incomplete l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:f,target:k[0]},!1])):a(j).hasClass("l-checkbox-incomplete")&&(a(j).removeClass("l-checkbox-incomplete").addClass("l-checkbox-checked"),a(".l-children .l-checkbox",k).removeClass("l-checkbox-incomplete l-checkbox-unchecked").addClass("l-checkbox-checked"),b.trigger("check",[{data:f,target:k[0]},!0])),b._setParentCheckboxStatus(k)):a(j).hasClass("l-checkbox-unchecked")?(a(j).removeClass("l-checkbox-unchecked").addClass("l-checkbox-checked"),c.single&&a(".l-checkbox",b.tree).not(j).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:f,target:k[0]},!0])):a(j).hasClass("l-checkbox-checked")&&(a(j).removeClass("l-checkbox-checked").addClass("l-checkbox-unchecked"),b.trigger("check",[{data:f,target:k[0]},!1]));else if(!g.hasClass("l-expandable-open")||c.btnClickToToggleOnly&&!h){if(g.hasClass("l-expandable-close")&&(!c.btnClickToToggleOnly||h)){if(0==b.trigger("beforeExpand",[{data:f,target:k[0]}]))return!1;g.removeClass("l-expandable-close").addClass("l-expandable-open"),i=function(){b.trigger("expand",[{data:f,target:k[0]}])},c.slide?a("> .l-children",k).slideToggle("fast",i):(a("> .l-children",k).toggle(),i()),a("> div ."+b._getParentNodeClassName(),k).removeClass(b._getParentNodeClassName()).addClass(b._getParentNodeClassName(!0))}}else{if(0==b.trigger("beforeCollapse",[{data:f,target:k[0]}]))return!1;g.removeClass("l-expandable-open").addClass("l-expandable-close"),c.slide?a("> .l-children",k).slideToggle("fast"):a("> .l-children",k).toggle(),a("> div ."+b._getParentNodeClassName(!0),k).removeClass(b._getParentNodeClassName(!0)).addClass(b._getParentNodeClassName()),b.trigger("collapse",[{data:f,target:k[0]}])}b.trigger("click",[{data:f,target:k[0]}])}}),a.fn.ligerDrag&&c.nodeDraggable&&(b.nodeDroptip=a("<div class='l-drag-nodedroptip' style='display:none'></div>").appendTo("body"),b.tree.ligerDrag({revert:!0,animate:!1,proxyX:20,proxyY:20,proxy:function(d,e){var f,g,h,i,j,k=b._getSrcElementByEvent(e);if(k.node){if(f="dragging",c.nodeDraggingRender)f=c.nodeDraggingRender(d.draggingNodes,d,b);else{f="",g=!1;for(h in d.draggingNodes)i=d.draggingNodes[h],g&&(f+=","),f+=i.text,g=!0}return j=a("<div class='l-drag-proxy' style='display:none'><div class='l-drop-icon l-drop-no'></div>"+f+"</div>").appendTo("body")}},onRevert:function(){return!1},onRendered:function(){this.set("cursor","default"),b.children[this.id]=this},onStartDrag:function(a,d){var e,f,g;if(2==d.button)return!1;if(this.set("cursor","default"),e=b._getSrcElementByEvent(d),e.checkbox)return!1;if(c.checkbox){f=b.getChecked(),this.draggingNodes=[];for(g in f)this.draggingNodes.push(f[g].data);if(!this.draggingNodes||!this.draggingNodes.length)return!1}else this.draggingNodes=[e.data];this.draggingNode=e.data,this.set("cursor","move"),b.nodedragging=!0,this.validRange={top:b.tree.offset().top,bottom:b.tree.offset().top+b.tree.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()}},onDrag:function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=this.draggingNode;if(!s)return!1;if(e=this.draggingNodes?this.draggingNodes:[s],null==b.nodeDropIn&&(b.nodeDropIn=-1),f=d.pageX,g=d.pageY,h=!1,i=this.validRange,f<i.left||f>i.right||g>i.bottom||g<i.top)return b.nodeDropIn=-1,b.nodeDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes l-drop-add").addClass("l-drop-no"),void 0;for(j=0,k=b.nodes.length;k>j;j++)if(l=b.nodes[j],m=l.treedataindex,s.treedataindex==m&&(h=!0),-1==a.inArray(l,e)&&(n=h?!0:!1,-1==b.nodeDropIn||b.nodeDropIn==m)){if(o=a("li[treedataindex="+m+"] div:first",b.tree),p=o.offset(),q={top:p.top,bottom:p.top+o.height(),left:b.tree.offset().left,right:b.tree.offset().left+b.tree.width()},f>q.left&&f<q.right&&g>q.top&&g<q.bottom){r=p.top,n&&(r+=o.height()),b.nodeDroptip.css({left:q.left,top:r,width:q.right-q.left}).show(),b.nodeDropIn=m,b.nodeDropDir=n?"bottom":"top",g>q.top+7&&g<q.bottom-7?(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-yes").addClass("l-drop-add"),b.nodeDroptip.hide(),b.nodeDropInParent=!0):(this.proxy.find(".l-drop-icon:first").removeClass("l-drop-no l-drop-add").addClass("l-drop-yes"),b.nodeDroptip.show(),b.nodeDropInParent=!1);break}-1!=b.nodeDropIn&&(b.nodeDropIn=-1,b.nodeDropInParent=!1,b.nodeDroptip.hide(),this.proxy.find(".l-drop-icon:first").removeClass("l-drop-yes  l-drop-add").addClass("l-drop-no"))}},onStopDrag:function(){var c,d,e,f=this.draggingNodes;if(b.nodedragging=!1,-1!=b.nodeDropIn){for(c=0;c<f.length;c++)d=f[c].children,d&&(f=a.grep(f,function(b){var c=-1==a.inArray(b,d);return c}));for(c in f)e=f[c],b.nodeDropInParent?(b.remove(e),b.append(b.nodeDropIn,[e])):(b.remove(e),b.append(b.getParent(b.nodeDropIn),[e],b.nodeDropIn,"bottom"==b.nodeDropDir));b.nodeDropIn=-1}b.nodeDroptip.hide(),this.set("cursor","default")}}))},_setParentCheckboxStatus:function(b){var c,d,e=this;this.options,c=0==a(".l-checkbox-unchecked",b.parent()).length,d=0==a(".l-checkbox-checked",b.parent()).length,c?b.parent().prev().find(".l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-incomplete").addClass("l-checkbox-checked"):d?b.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-checked l-checkbox-incomplete").addClass("l-checkbox-unchecked"):b.parent().prev().find("> .l-checkbox").removeClass("l-checkbox-unchecked l-checkbox-checked").addClass("l-checkbox-incomplete"),b.parent().parent("li").length>0&&e._setParentCheckboxStatus(b.parent().parent("li"))}})}(jQuery),function(a){var b=a.ligerui;b.windowCount=0,a.ligerWindow=function(){return b.run.call(null,"ligerWindow",arguments,{isStatic:!0})},a.ligerWindow.show=function(b){return a.ligerWindow(b)},a.ligerDefaults.Window={showClose:!0,showMax:!0,showToggle:!0,showMin:!0,title:"window",load:!1,onLoaded:null,modal:!1},a.ligerMethos.Window={},b.controls.Window=function(a){b.controls.Window.base.constructor.call(this,null,a)},b.controls.Window.ligerExtend(b.core.Win,{__getType:function(){return"Window"},__idPrev:function(){return"Window"},_extendMethods:function(){return a.ligerMethos.Window},_render:function(){var c,d,e,f,g,h=this,i=this.options;h.window=a('<div class="l-window"><div class="l-window-header"><div class="l-window-header-buttons"><div class="l-window-toggle"></div><div class="l-window-max"></div><div class="l-window-close"></div><div class="l-clear"></div></div><div class="l-window-header-inner"></div></div><div class="l-window-content"></div></div>'),h.element=h.window[0],h.window.content=a(".l-window-content",h.window),h.window.header=a(".l-window-header",h.window),h.window.buttons=a(".l-window-header-buttons:first",h.window),i.url?i.load?(h.window.content.load(i.url,function(){h.trigger("loaded")}),h.window.content.addClass("l-window-content-scroll")):(c=a("<iframe frameborder='0' src='"+i.url+"'></iframe>"),d="ligeruiwindow"+b.windowCount++,i.name&&(d=i.name),c.attr("name",d).attr("id",d),i.framename=d,c.appendTo(h.window.content),h.iframe=c):i.content?(e=a("<div>"+i.content+"</div>"),e.appendTo(h.window.content)):i.target&&(h.window.content.append(i.target),i.target.show()),this.mask(),h.active(),a("body").append(h.window),h.set({width:i.width,height:i.height}),f=0,g=0,null!=i.left?f=i.left:i.left=f=.5*(a(window).width()-h.window.width()),null!=i.top?g=i.top:i.top=g=.5*(a(window).height()-h.window.height())+a(window).scrollTop()-10,0>f&&(i.left=f=0),0>g&&(i.top=g=0),h.set(i),i.framename&&a(">iframe",h.window.content).attr("name",i.framename),i.showToggle||a(".l-window-toggle",h.window).remove(),i.showMax||a(".l-window-max",h.window).remove(),i.showClose||a(".l-window-close",h.window).remove(),h._saveStatus(),a.fn.ligerDrag&&(h.draggable=h.window.drag=h.window.ligerDrag({handler:".l-window-header-inner",onStartDrag:function(){h.active()},onStopDrag:function(){h._saveStatus()},animate:!1})),a.fn.ligerResizable&&(h.resizeable=h.window.resizable=h.window.ligerResizable({onStartResize:function(){h.active(),a(".l-window-max",h.window).removeClass("l-window-regain")},onStopResize:function(a){var b=0,c=0;return isNaN(parseInt(h.window.css("top")))||(b=parseInt(h.window.css("top"))),isNaN(parseInt(h.window.css("left")))||(c=parseInt(h.window.css("left"))),a.diffTop&&h.window.css({top:b+a.diffTop}),a.diffLeft&&h.window.css({left:c+a.diffLeft}),a.newWidth&&h.window.width(a.newWidth),a.newHeight&&h.window.content.height(a.newHeight-28),h._saveStatus(),!1}}),h.window.append("<div class='l-btn-nw-drop'></div>")),a(".l-window-toggle",h.window).click(function(){a(this).hasClass("l-window-toggle-close")?(h.collapsed=!1,a(this).removeClass("l-window-toggle-close")):(h.collapsed=!0,a(this).addClass("l-window-toggle-close")),h.window.content.slideToggle()}).hover(function(){h.window.drag&&h.window.drag.set("disabled",!0)},function(){h.window.drag&&h.window.drag.set("disabled",!1)}),a(".l-window-close",h.window).click(function(){return 0==h.trigger("close")?!1:(h.window.hide(),b.win.removeTask(h),void 0)}).hover(function(){h.window.drag&&h.window.drag.set("disabled",!0)},function(){h.window.drag&&h.window.drag.set("disabled",!1)}),a(".l-window-max",h.window).click(function(){if(a(this).hasClass("l-window-regain")){if(0==h.trigger("regain"))return!1;h.window.width(h._width).css({left:h._left,top:h._top}),h.window.content.height(h._height-28),a(this).removeClass("l-window-regain")}else{if(0==h.trigger("max"))return!1;h.window.width(a(window).width()-2).css({left:0,top:0}),h.window.content.height(a(window).height()-28).show(),a(this).addClass("l-window-regain")}})},_saveStatus:function(){var a,b,c=this;c._width=c.window.width(),c._height=c.window.height(),a=0,b=0,isNaN(parseInt(c.window.css("top")))||(a=parseInt(c.window.css("top"))),isNaN(parseInt(c.window.css("left")))||(b=parseInt(c.window.css("left"))),c._top=a,c._left=b},min:function(){this.window.hide(),this.minimize=!0,this.actived=!1},_setShowMin:function(c){var d=this;this.options,c?d.winmin||(d.winmin=a('<div class="l-window-min"></div>').prependTo(d.window.buttons).click(function(){d.min()}),b.win.addTask(d)):d.winmin&&(d.winmin.remove(),d.winmin=null)},_setLeft:function(a){null!=a&&this.window.css({left:a})},_setTop:function(a){null!=a&&this.window.css({top:a})},_setWidth:function(a){a>0&&this.window.width(a)},_setHeight:function(a){a>28&&this.window.content.height(a-28)},_setTitle:function(b){b&&a(".l-window-header-inner",this.window.header).html(b)},_setUrl:function(a){var b=this,c=this.options;c.url=a,c.load?b.window.content.html("").load(c.url,function(){return 0==b.trigger("loaded")?!1:void 0}):b.jiframe&&b.jiframe.attr("src",c.url)},hide:function(){this.options,this.unmask(),this.window.hide()},show:function(){this.options,this.mask(),this.window.show()},remove:function(){this.options,this.unmask(),this.window.remove()},active:function(){var c,d,e,f,g=this;this.options,g.minimize&&(c=g._width,d=g._height,e=g._left,f=g._top,g.maximum&&(c=a(window).width(),d=a(window).height(),e=f=0,b.win.taskbar&&(d-=b.win.taskbar.outerHeight(),b.win.top&&(f+=b.win.taskbar.outerHeight()))),g.set({width:c,height:d,left:e,top:f})),g.actived=!0,g.minimize=!1,b.win.setFront(g),g.show(),b.win.setFront(this)},setUrl:function(a){return _setUrl(a)}})}(jQuery);